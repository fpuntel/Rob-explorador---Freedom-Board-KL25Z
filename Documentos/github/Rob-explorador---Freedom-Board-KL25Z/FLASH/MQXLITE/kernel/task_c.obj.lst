   1              		.cpu cortex-m0
   2              		.fpu softvfp
   3              		.eabi_attribute 20, 1
   4              		.eabi_attribute 21, 1
   5              		.eabi_attribute 23, 3
   6              		.eabi_attribute 24, 1
   7              		.eabi_attribute 25, 1
   8              		.eabi_attribute 26, 1
   9              		.eabi_attribute 30, 6
  10              		.eabi_attribute 34, 0
  11              		.eabi_attribute 18, 4
  12              		.code	16
  13              		.file	"task.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.comm	_tad_task_at_flag,4,4
  18              		.section	.text._task_abort_internal,"ax",%progbits
  19              		.align	2
  20              		.global	_task_abort_internal
  21              		.code	16
  22              		.thumb_func
  24              	_task_abort_internal:
  25              	.LFB0:
  26              		.file 1 "../MQXLITE/kernel/task.c"
   1:../MQXLITE/kernel/task.c **** /*HEADER*********************************************************************
   2:../MQXLITE/kernel/task.c ****  *
   3:../MQXLITE/kernel/task.c ****  * Copyright (c) 2008 Freescale Semiconductor;
   4:../MQXLITE/kernel/task.c ****  * All Rights Reserved
   5:../MQXLITE/kernel/task.c ****  *
   6:../MQXLITE/kernel/task.c ****  * Copyright (c) 2004-2008 Embedded Access Inc.;
   7:../MQXLITE/kernel/task.c ****  * All Rights Reserved
   8:../MQXLITE/kernel/task.c ****  *
   9:../MQXLITE/kernel/task.c ****  * Copyright (c) 1989-2008 ARC International;
  10:../MQXLITE/kernel/task.c ****  * All Rights Reserved
  11:../MQXLITE/kernel/task.c ****  *
  12:../MQXLITE/kernel/task.c ****  *****************************************************************************
  13:../MQXLITE/kernel/task.c ****  *
  14:../MQXLITE/kernel/task.c ****  * THIS SOFTWARE IS PROVIDED BY FREESCALE "AS IS" AND ANY EXPRESSED OR
  15:../MQXLITE/kernel/task.c ****  * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
  16:../MQXLITE/kernel/task.c ****  * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
  17:../MQXLITE/kernel/task.c ****  * IN NO EVENT SHALL FREESCALE OR ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
  18:../MQXLITE/kernel/task.c ****  * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
  19:../MQXLITE/kernel/task.c ****  * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
  20:../MQXLITE/kernel/task.c ****  * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
  21:../MQXLITE/kernel/task.c ****  * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
  22:../MQXLITE/kernel/task.c ****  * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING
  23:../MQXLITE/kernel/task.c ****  * IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF
  24:../MQXLITE/kernel/task.c ****  * THE POSSIBILITY OF SUCH DAMAGE.
  25:../MQXLITE/kernel/task.c ****  *
  26:../MQXLITE/kernel/task.c ****  *****************************************************************************
  27:../MQXLITE/kernel/task.c ****  *
  28:../MQXLITE/kernel/task.c ****  * $FileName: task.c$
  29:../MQXLITE/kernel/task.c ****  * $Version : 3.8.0.2$
  30:../MQXLITE/kernel/task.c ****  * $Date    : Feb-27-2012$
  31:../MQXLITE/kernel/task.c ****  *
  32:../MQXLITE/kernel/task.c ****  * Comments:
  33:../MQXLITE/kernel/task.c ****  *
  34:../MQXLITE/kernel/task.c ****  *   This file contains functions of the Task Management component.
  35:../MQXLITE/kernel/task.c ****  *
  36:../MQXLITE/kernel/task.c ****  *END************************************************************************/
  37:../MQXLITE/kernel/task.c **** 
  38:../MQXLITE/kernel/task.c **** #include <string.h>
  39:../MQXLITE/kernel/task.c **** #include "mqx_inc.h"
  40:../MQXLITE/kernel/task.c **** 
  41:../MQXLITE/kernel/task.c **** /*!
  42:../MQXLITE/kernel/task.c ****  * \private
  43:../MQXLITE/kernel/task.c ****  *
  44:../MQXLITE/kernel/task.c ****  * This variable has no use to MQX.
  45:../MQXLITE/kernel/task.c ****  * Its been created for Task Aware Debug module.
  46:../MQXLITE/kernel/task.c ****  */
  47:../MQXLITE/kernel/task.c **** volatile uint_32 _tad_task_at_flag;
  48:../MQXLITE/kernel/task.c **** 
  49:../MQXLITE/kernel/task.c **** /*!
  50:../MQXLITE/kernel/task.c ****  * \private
  51:../MQXLITE/kernel/task.c ****  *
  52:../MQXLITE/kernel/task.c ****  * \brief Makes a task run its task exit handler and then destroys itself.
  53:../MQXLITE/kernel/task.c ****  *
  54:../MQXLITE/kernel/task.c ****  * \param[in] task_id The task id of the task to abort.
  55:../MQXLITE/kernel/task.c ****  * \param[in] user User mode functionality.
  56:../MQXLITE/kernel/task.c ****  *
  57:../MQXLITE/kernel/task.c ****  * \return MQX_OK
  58:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID
  59:../MQXLITE/kernel/task.c ****  *
  60:../MQXLITE/kernel/task.c ****  * \see _task_abort
  61:../MQXLITE/kernel/task.c ****  */
  62:../MQXLITE/kernel/task.c **** _mqx_uint _task_abort_internal
  63:../MQXLITE/kernel/task.c **** (
  64:../MQXLITE/kernel/task.c ****     _task_id    task_id,
  65:../MQXLITE/kernel/task.c ****     boolean     user
  66:../MQXLITE/kernel/task.c **** )
  67:../MQXLITE/kernel/task.c **** {
  27              		.loc 1 67 0
  28              		.cfi_startproc
  29 0000 80B5     		push	{r7, lr}
  30              	.LCFI0:
  31              		.cfi_def_cfa_offset 8
  32              		.cfi_offset 7, -8
  33              		.cfi_offset 14, -4
  34 0002 8CB0     		sub	sp, sp, #48
  35              	.LCFI1:
  36              		.cfi_def_cfa_offset 56
  37 0004 00AF     		add	r7, sp, #0
  38              	.LCFI2:
  39              		.cfi_def_cfa_register 7
  40 0006 7860     		str	r0, [r7, #4]
  41 0008 3960     		str	r1, [r7]
  68:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR kernel_data;
  69:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR          td_ptr;
  70:../MQXLITE/kernel/task.c ****     pointer                stack_ptr;
  71:../MQXLITE/kernel/task.c ****     _processor_number processor;
  72:../MQXLITE/kernel/task.c **** 
  73:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
  42              		.loc 1 73 0
  43 000a 5C4B     		ldr	r3, .L13
  44 000c 1B68     		ldr	r3, [r3]
  45 000e FB62     		str	r3, [r7, #44]
  74:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_abort, task_id);
  75:../MQXLITE/kernel/task.c **** 
  76:../MQXLITE/kernel/task.c ****     if (task_id != MQX_NULL_TASK_ID)
  46              		.loc 1 76 0
  47 0010 7B68     		ldr	r3, [r7, #4]
  48 0012 002B     		cmp	r3, #0
  49 0014 10D0     		beq	.L2
  77:../MQXLITE/kernel/task.c ****     {
  78:../MQXLITE/kernel/task.c ****         processor = PROC_NUMBER_FROM_TASKID(task_id);
  50              		.loc 1 78 0
  51 0016 7B68     		ldr	r3, [r7, #4]
  52 0018 1A0C     		lsr	r2, r3, #16
  53 001a 3B1C     		mov	r3, r7
  54 001c 2A33     		add	r3, r3, #42
  55 001e 1A80     		strh	r2, [r3]
  79:../MQXLITE/kernel/task.c ****         if (processor != (_processor_number) kernel_data->INIT.PROCESSOR_NUMBER)
  56              		.loc 1 79 0
  57 0020 FA6A     		ldr	r2, [r7, #44]
  58 0022 A823     		mov	r3, #168
  59 0024 5B00     		lsl	r3, r3, #1
  60 0026 D358     		ldr	r3, [r2, r3]
  61 0028 9BB2     		uxth	r3, r3
  62 002a 3A1C     		mov	r2, r7
  63 002c 2A32     		add	r2, r2, #42
  64 002e 1288     		ldrh	r2, [r2]
  65 0030 9A42     		cmp	r2, r3
  66 0032 01D0     		beq	.L2
  80:../MQXLITE/kernel/task.c ****         {
  81:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
  82:../MQXLITE/kernel/task.c ****             if ( kernel_data->IPC != NULL )
  83:../MQXLITE/kernel/task.c ****             {
  84:../MQXLITE/kernel/task.c ****                 _KLOGX2(KLOG_task_abort, MQX_OK);
  85:../MQXLITE/kernel/task.c ****                 return( (*kernel_data->IPC)(FALSE, processor,
  86:../MQXLITE/kernel/task.c ****                                                 KERNEL_MESSAGES, IPC_TASK_ABORT, 1, (_mqx_uint)task
  87:../MQXLITE/kernel/task.c ****             }
  88:../MQXLITE/kernel/task.c ****             else
  89:../MQXLITE/kernel/task.c ****             {
  90:../MQXLITE/kernel/task.c **** #endif
  91:../MQXLITE/kernel/task.c ****             _KLOGX2(KLOG_task_abort, MQX_INVALID_TASK_ID);
  92:../MQXLITE/kernel/task.c ****             return (MQX_INVALID_TASK_ID);
  67              		.loc 1 92 0
  68 0034 1223     		mov	r3, #18
  69 0036 9CE0     		b	.L3
  70              	.L2:
  93:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
  94:../MQXLITE/kernel/task.c ****         } /* Endif */
  95:../MQXLITE/kernel/task.c **** #endif
  96:../MQXLITE/kernel/task.c ****         }/* Endif */
  97:../MQXLITE/kernel/task.c ****     }/* Endif */
  98:../MQXLITE/kernel/task.c **** 
  99:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR) _task_get_td(task_id);
  71              		.loc 1 99 0
  72 0038 7B68     		ldr	r3, [r7, #4]
  73 003a 181C     		mov	r0, r3
  74 003c FFF7FEFF 		bl	_task_get_td
  75 0040 031C     		mov	r3, r0
  76 0042 7B62     		str	r3, [r7, #36]
 100:../MQXLITE/kernel/task.c **** 
 101:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 102:../MQXLITE/kernel/task.c ****     /* check template for correct user task parameters */
 103:../MQXLITE/kernel/task.c ****     if (user)
 104:../MQXLITE/kernel/task.c ****     {
 105:../MQXLITE/kernel/task.c ****         if (!(td_ptr->FLAGS & MQX_USER_TASK))
 106:../MQXLITE/kernel/task.c ****         {
 107:../MQXLITE/kernel/task.c ****             return MQX_INVALID_TASK_ID;
 108:../MQXLITE/kernel/task.c ****         }
 109:../MQXLITE/kernel/task.c ****     }
 110:../MQXLITE/kernel/task.c **** #endif
 111:../MQXLITE/kernel/task.c **** 
 112:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 113:../MQXLITE/kernel/task.c ****     if ((td_ptr == NULL) || (td_ptr == SYSTEM_TD_PTR(kernel_data)))
  77              		.loc 1 113 0
  78 0044 7B6A     		ldr	r3, [r7, #36]
  79 0046 002B     		cmp	r3, #0
  80 0048 05D0     		beq	.L4
  81              		.loc 1 113 0 is_stmt 0 discriminator 1
  82 004a FB6A     		ldr	r3, [r7, #44]
  83 004c 1A1C     		mov	r2, r3
  84 004e 4832     		add	r2, r2, #72
  85 0050 7B6A     		ldr	r3, [r7, #36]
  86 0052 9A42     		cmp	r2, r3
  87 0054 01D1     		bne	.L5
  88              	.L4:
 114:../MQXLITE/kernel/task.c ****     {
 115:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_abort, MQX_INVALID_TASK_ID);
 116:../MQXLITE/kernel/task.c ****         return (MQX_INVALID_TASK_ID);
  89              		.loc 1 116 0 is_stmt 1
  90 0056 1223     		mov	r3, #18
  91 0058 8BE0     		b	.L3
  92              	.L5:
 117:../MQXLITE/kernel/task.c ****     } /* Endif */
 118:../MQXLITE/kernel/task.c **** #endif
 119:../MQXLITE/kernel/task.c **** 
 120:../MQXLITE/kernel/task.c ****     if (td_ptr == kernel_data->ACTIVE_PTR)
  93              		.loc 1 120 0
  94 005a FB6A     		ldr	r3, [r7, #44]
  95 005c DA69     		ldr	r2, [r3, #28]
  96 005e 7B6A     		ldr	r3, [r7, #36]
  97 0060 9A42     		cmp	r2, r3
  98 0062 0FD1     		bne	.L6
 121:../MQXLITE/kernel/task.c ****     {
 122:../MQXLITE/kernel/task.c ****         if (kernel_data->IN_ISR)
  99              		.loc 1 122 0
 100 0064 FB6A     		ldr	r3, [r7, #44]
 101 0066 1B8B     		ldrh	r3, [r3, #24]
 102 0068 002B     		cmp	r3, #0
 103 006a 08D0     		beq	.L7
 123:../MQXLITE/kernel/task.c ****         {
 124:../MQXLITE/kernel/task.c ****             stack_ptr = (pointer) td_ptr->STACK_PTR;
 104              		.loc 1 124 0
 105 006c 7B6A     		ldr	r3, [r7, #36]
 106 006e 5B69     		ldr	r3, [r3, #20]
 107 0070 3B62     		str	r3, [r7, #32]
 125:../MQXLITE/kernel/task.c ****             _PSP_SET_PC_OF_INTERRUPTED_TASK(stack_ptr,
 108              		.loc 1 125 0
 109 0072 FFF7FEFF 		bl	__get_PSP
 110 0076 031C     		mov	r3, r0
 111 0078 414A     		ldr	r2, .L13+4
 112 007a 9A61     		str	r2, [r3, #24]
 113 007c 78E0     		b	.L8
 114              	.L7:
 126:../MQXLITE/kernel/task.c ****                             _task_exit_function_internal);
 127:../MQXLITE/kernel/task.c ****         }
 128:../MQXLITE/kernel/task.c ****         else
 129:../MQXLITE/kernel/task.c ****         {
 130:../MQXLITE/kernel/task.c ****             _task_exit_function_internal();
 115              		.loc 1 130 0
 116 007e FFF7FEFF 		bl	_task_exit_function_internal
 117 0082 75E0     		b	.L8
 118              	.L6:
 131:../MQXLITE/kernel/task.c ****         }/* Endif */
 132:../MQXLITE/kernel/task.c ****     }
 133:../MQXLITE/kernel/task.c ****     else
 134:../MQXLITE/kernel/task.c ****     {
 135:../MQXLITE/kernel/task.c **** 
 136:../MQXLITE/kernel/task.c ****         _int_disable();
 119              		.loc 1 136 0
 120 0084 FFF7FEFF 		bl	_int_disable
 137:../MQXLITE/kernel/task.c ****         /* Task is not running */
 138:../MQXLITE/kernel/task.c ****         stack_ptr = (pointer) td_ptr->STACK_PTR;
 121              		.loc 1 138 0
 122 0088 7B6A     		ldr	r3, [r7, #36]
 123 008a 5B69     		ldr	r3, [r3, #20]
 124 008c 3B62     		str	r3, [r7, #32]
 139:../MQXLITE/kernel/task.c ****         _PSP_SET_PC_OF_BLOCKED_TASK(stack_ptr,
 125              		.loc 1 139 0
 126 008e 3C4A     		ldr	r2, .L13+4
 127 0090 3B6A     		ldr	r3, [r7, #32]
 128 0092 9A63     		str	r2, [r3, #56]
 140:../MQXLITE/kernel/task.c ****                         _task_exit_function_internal);
 141:../MQXLITE/kernel/task.c ****         if (td_ptr->STATE & IS_ON_TIMEOUT_Q)
 129              		.loc 1 141 0
 130 0094 7B6A     		ldr	r3, [r7, #36]
 131 0096 9A68     		ldr	r2, [r3, #8]
 132 0098 8023     		mov	r3, #128
 133 009a 5B00     		lsl	r3, r3, #1
 134 009c 1340     		and	r3, r2
 135 009e 25D0     		beq	.L9
 142:../MQXLITE/kernel/task.c ****         {
 143:../MQXLITE/kernel/task.c ****             /* Remove from time queue (uses NEXT, PREV field) */
 144:../MQXLITE/kernel/task.c ****             _TIME_DEQUEUE(td_ptr, kernel_data);
 136              		.loc 1 144 0
 137 00a0 7B6A     		ldr	r3, [r7, #36]
 138 00a2 9A68     		ldr	r2, [r3, #8]
 139 00a4 8023     		mov	r3, #128
 140 00a6 5B00     		lsl	r3, r3, #1
 141 00a8 1340     		and	r3, r2
 142 00aa 53D0     		beq	.L10
 143              	.LBB2:
 144              		.loc 1 144 0 is_stmt 0 discriminator 1
 145 00ac 7B6A     		ldr	r3, [r7, #36]
 146 00ae 5B68     		ldr	r3, [r3, #4]
 147 00b0 FB61     		str	r3, [r7, #28]
 148 00b2 7B6A     		ldr	r3, [r7, #36]
 149 00b4 1B68     		ldr	r3, [r3]
 150 00b6 BB61     		str	r3, [r7, #24]
 151 00b8 FB69     		ldr	r3, [r7, #28]
 152 00ba BA69     		ldr	r2, [r7, #24]
 153 00bc 1A60     		str	r2, [r3]
 154 00be BB69     		ldr	r3, [r7, #24]
 155 00c0 FA69     		ldr	r2, [r7, #28]
 156 00c2 5A60     		str	r2, [r3, #4]
 157              	.LBE2:
 158 00c4 FB6A     		ldr	r3, [r7, #44]
 159 00c6 2933     		add	r3, r3, #41
 160 00c8 FF33     		add	r3, r3, #255
 161 00ca 1A89     		ldrh	r2, [r3, #8]
 162 00cc 013A     		sub	r2, r2, #1
 163 00ce 92B2     		uxth	r2, r2
 164 00d0 1A81     		strh	r2, [r3, #8]
 165 00d2 7B6A     		ldr	r3, [r7, #36]
 166 00d4 9A68     		ldr	r2, [r3, #8]
 167 00d6 2B4B     		ldr	r3, .L13+8
 168 00d8 1A40     		and	r2, r3
 169 00da 7B6A     		ldr	r3, [r7, #36]
 170 00dc 9A60     		str	r2, [r3, #8]
 171 00de 7B6A     		ldr	r3, [r7, #36]
 172 00e0 9B68     		ldr	r3, [r3, #8]
 173 00e2 0322     		mov	r2, #3
 174 00e4 1A43     		orr	r2, r3
 175 00e6 7B6A     		ldr	r3, [r7, #36]
 176 00e8 9A60     		str	r2, [r3, #8]
 177 00ea 33E0     		b	.L10
 178              	.L9:
 145:../MQXLITE/kernel/task.c ****         }
 146:../MQXLITE/kernel/task.c ****         else if (td_ptr->STATE & TD_IS_ON_QUEUE)
 179              		.loc 1 146 0 is_stmt 1
 180 00ec 7B6A     		ldr	r3, [r7, #36]
 181 00ee 9A68     		ldr	r2, [r3, #8]
 182 00f0 8023     		mov	r3, #128
 183 00f2 9B00     		lsl	r3, r3, #2
 184 00f4 1340     		and	r3, r2
 185 00f6 12D0     		beq	.L11
 186              	.LBB3:
 147:../MQXLITE/kernel/task.c ****         {
 148:../MQXLITE/kernel/task.c ****             _QUEUE_REMOVE(td_ptr->INFO, td_ptr);
 187              		.loc 1 148 0
 188 00f8 7B6A     		ldr	r3, [r7, #36]
 189 00fa 5B68     		ldr	r3, [r3, #4]
 190 00fc 7B61     		str	r3, [r7, #20]
 191 00fe 7B6A     		ldr	r3, [r7, #36]
 192 0100 1B68     		ldr	r3, [r3]
 193 0102 3B61     		str	r3, [r7, #16]
 194 0104 7B69     		ldr	r3, [r7, #20]
 195 0106 3A69     		ldr	r2, [r7, #16]
 196 0108 1A60     		str	r2, [r3]
 197 010a 3B69     		ldr	r3, [r7, #16]
 198 010c 7A69     		ldr	r2, [r7, #20]
 199 010e 5A60     		str	r2, [r3, #4]
 200              	.LBE3:
 201 0110 7B6A     		ldr	r3, [r7, #36]
 202 0112 DB6A     		ldr	r3, [r3, #44]
 203 0114 1A89     		ldrh	r2, [r3, #8]
 204 0116 013A     		sub	r2, r2, #1
 205 0118 92B2     		uxth	r2, r2
 206 011a 1A81     		strh	r2, [r3, #8]
 207 011c 1AE0     		b	.L10
 208              	.L11:
 149:../MQXLITE/kernel/task.c ****         }
 150:../MQXLITE/kernel/task.c ****         else if ((td_ptr->STATE & BLOCKED_ON_AUX_QUEUE) == BLOCKED_ON_AUX_QUEUE)
 209              		.loc 1 150 0
 210 011e 7B6A     		ldr	r3, [r7, #36]
 211 0120 9A68     		ldr	r2, [r3, #8]
 212 0122 194B     		ldr	r3, .L13+12
 213 0124 1A40     		and	r2, r3
 214 0126 184B     		ldr	r3, .L13+12
 215 0128 9A42     		cmp	r2, r3
 216 012a 13D1     		bne	.L10
 217              	.LBB4:
 151:../MQXLITE/kernel/task.c ****         {
 152:../MQXLITE/kernel/task.c ****             /* We need to remove it here because _task_ready() below will
 153:../MQXLITE/kernel/task.c ****              change its state to READY */
 154:../MQXLITE/kernel/task.c ****             _QUEUE_REMOVE(td_ptr->INFO, &td_ptr->AUX_QUEUE);
 218              		.loc 1 154 0
 219 012c 7B6A     		ldr	r3, [r7, #36]
 220 012e 3033     		add	r3, r3, #48
 221 0130 5B68     		ldr	r3, [r3, #4]
 222 0132 FB60     		str	r3, [r7, #12]
 223 0134 7B6A     		ldr	r3, [r7, #36]
 224 0136 3033     		add	r3, r3, #48
 225 0138 1B68     		ldr	r3, [r3]
 226 013a BB60     		str	r3, [r7, #8]
 227 013c FB68     		ldr	r3, [r7, #12]
 228 013e BA68     		ldr	r2, [r7, #8]
 229 0140 1A60     		str	r2, [r3]
 230 0142 BB68     		ldr	r3, [r7, #8]
 231 0144 FA68     		ldr	r2, [r7, #12]
 232 0146 5A60     		str	r2, [r3, #4]
 233              	.LBE4:
 234 0148 7B6A     		ldr	r3, [r7, #36]
 235 014a DB6A     		ldr	r3, [r3, #44]
 236 014c 1A89     		ldrh	r2, [r3, #8]
 237 014e 013A     		sub	r2, r2, #1
 238 0150 92B2     		uxth	r2, r2
 239 0152 1A81     		strh	r2, [r3, #8]
 240              	.L10:
 155:../MQXLITE/kernel/task.c ****         } /* Endif */
 156:../MQXLITE/kernel/task.c ****         if (td_ptr->STATE & IS_BLOCKED)
 241              		.loc 1 156 0
 242 0154 7B6A     		ldr	r3, [r7, #36]
 243 0156 9B68     		ldr	r3, [r3, #8]
 244 0158 1A1C     		mov	r2, r3
 245 015a 0123     		mov	r3, #1
 246 015c 1340     		and	r3, r2
 247 015e DBB2     		uxtb	r3, r3
 248 0160 002B     		cmp	r3, #0
 249 0162 03D0     		beq	.L12
 157:../MQXLITE/kernel/task.c ****         {
 158:../MQXLITE/kernel/task.c ****             _task_ready(td_ptr);
 250              		.loc 1 158 0
 251 0164 7B6A     		ldr	r3, [r7, #36]
 252 0166 181C     		mov	r0, r3
 253 0168 FFF7FEFF 		bl	_task_ready
 254              	.L12:
 159:../MQXLITE/kernel/task.c ****         } /* Endif */
 160:../MQXLITE/kernel/task.c ****         _int_enable();
 255              		.loc 1 160 0
 256 016c FFF7FEFF 		bl	_int_enable
 257              	.L8:
 161:../MQXLITE/kernel/task.c ****     }/* Endif */
 162:../MQXLITE/kernel/task.c **** 
 163:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_abort, MQX_OK);
 164:../MQXLITE/kernel/task.c ****     return (MQX_OK);
 258              		.loc 1 164 0
 259 0170 0023     		mov	r3, #0
 260              	.L3:
 165:../MQXLITE/kernel/task.c **** }
 261              		.loc 1 165 0
 262 0172 181C     		mov	r0, r3
 263 0174 BD46     		mov	sp, r7
 264 0176 0CB0     		add	sp, sp, #48
 265              		@ sp needed for prologue
 266 0178 80BD     		pop	{r7, pc}
 267              	.L14:
 268 017a C046     		.align	2
 269              	.L13:
 270 017c 00000000 		.word	_mqx_kernel_data
 271 0180 00000000 		.word	_task_exit_function_internal
 272 0184 FFFEFFFF 		.word	-257
 273 0188 01040000 		.word	1025
 274              		.cfi_endproc
 275              	.LFE0:
 277              		.section	.text._task_abort,"ax",%progbits
 278              		.align	2
 279              		.global	_task_abort
 280              		.code	16
 281              		.thumb_func
 283              	_task_abort:
 284              	.LFB1:
 166:../MQXLITE/kernel/task.c **** 
 167:../MQXLITE/kernel/task.c **** /*!
 168:../MQXLITE/kernel/task.c ****  * \brief Makes a task run its task exit handler and then destroys itself.
 169:../MQXLITE/kernel/task.c ****  *
 170:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of the following:
 171:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task to be destroyed.
 172:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Abort the calling task.)
 173:../MQXLITE/kernel/task.c ****  *
 174:../MQXLITE/kernel/task.c ****  * \return MQX_OK
 175:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID (Task_id does not represent a valid task.)
 176:../MQXLITE/kernel/task.c ****  *
 177:../MQXLITE/kernel/task.c ****  * \see _task_destroy
 178:../MQXLITE/kernel/task.c ****  * \see _task_get_exit_handler
 179:../MQXLITE/kernel/task.c ****  * \see _task_set_exit_handler
 180:../MQXLITE/kernel/task.c ****  */
 181:../MQXLITE/kernel/task.c **** _mqx_uint _task_abort
 182:../MQXLITE/kernel/task.c **** (
 183:../MQXLITE/kernel/task.c ****     _task_id    task_id
 184:../MQXLITE/kernel/task.c **** )
 185:../MQXLITE/kernel/task.c **** {
 285              		.loc 1 185 0
 286              		.cfi_startproc
 287 0000 80B5     		push	{r7, lr}
 288              	.LCFI3:
 289              		.cfi_def_cfa_offset 8
 290              		.cfi_offset 7, -8
 291              		.cfi_offset 14, -4
 292 0002 82B0     		sub	sp, sp, #8
 293              	.LCFI4:
 294              		.cfi_def_cfa_offset 16
 295 0004 00AF     		add	r7, sp, #0
 296              	.LCFI5:
 297              		.cfi_def_cfa_register 7
 298 0006 7860     		str	r0, [r7, #4]
 186:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE && MQX_ENABLE_USER_STDAPI
 187:../MQXLITE/kernel/task.c ****     if (MQX_RUN_IN_USER_MODE)
 188:../MQXLITE/kernel/task.c ****     {
 189:../MQXLITE/kernel/task.c ****         return _usr_task_abort(task_id);
 190:../MQXLITE/kernel/task.c ****     }
 191:../MQXLITE/kernel/task.c **** #endif
 192:../MQXLITE/kernel/task.c **** 
 193:../MQXLITE/kernel/task.c ****     return _task_abort_internal(task_id, FALSE);
 299              		.loc 1 193 0
 300 0008 7B68     		ldr	r3, [r7, #4]
 301 000a 181C     		mov	r0, r3
 302 000c 0021     		mov	r1, #0
 303 000e FFF7FEFF 		bl	_task_abort_internal
 304 0012 031C     		mov	r3, r0
 194:../MQXLITE/kernel/task.c **** }
 305              		.loc 1 194 0
 306 0014 181C     		mov	r0, r3
 307 0016 BD46     		mov	sp, r7
 308 0018 02B0     		add	sp, sp, #8
 309              		@ sp needed for prologue
 310 001a 80BD     		pop	{r7, pc}
 311              		.cfi_endproc
 312              	.LFE1:
 314              		.section	.text._task_create_at,"ax",%progbits
 315              		.align	2
 316              		.global	_task_create_at
 317              		.code	16
 318              		.thumb_func
 320              	_task_create_at:
 321              	.LFB2:
 195:../MQXLITE/kernel/task.c **** 
 196:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 197:../MQXLITE/kernel/task.c **** 
 198:../MQXLITE/kernel/task.c **** /*!
 199:../MQXLITE/kernel/task.c ****  * \brief Makes a task run its task exit handler and then destroys itself.
 200:../MQXLITE/kernel/task.c ****  *
 201:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_abort() API call but it can be
 202:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
 203:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
 204:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
 205:../MQXLITE/kernel/task.c ****  *
 206:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of the following:
 207:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task to be destroyed.
 208:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Abort the calling task.)
 209:../MQXLITE/kernel/task.c ****  *
 210:../MQXLITE/kernel/task.c ****  * \return MQX_OK
 211:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID
 212:../MQXLITE/kernel/task.c ****  *
 213:../MQXLITE/kernel/task.c ****  * \see _task_abort
 214:../MQXLITE/kernel/task.c ****  * \see _usr_task_destroy
 215:../MQXLITE/kernel/task.c ****  */
 216:../MQXLITE/kernel/task.c **** _mqx_uint _usr_task_abort
 217:../MQXLITE/kernel/task.c **** (
 218:../MQXLITE/kernel/task.c ****     _task_id    task_id
 219:../MQXLITE/kernel/task.c **** )
 220:../MQXLITE/kernel/task.c **** {
 221:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params = {(uint_32)task_id, 0, 0, 0, 0};
 222:../MQXLITE/kernel/task.c ****     return _mqx_api_call(MQX_API_TASK_ABORT, &params);
 223:../MQXLITE/kernel/task.c **** }
 224:../MQXLITE/kernel/task.c **** 
 225:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
 226:../MQXLITE/kernel/task.c **** 
 227:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
 228:../MQXLITE/kernel/task.c **** /*!
 229:../MQXLITE/kernel/task.c ****  * \private
 230:../MQXLITE/kernel/task.c ****  *
 231:../MQXLITE/kernel/task.c ****  * \brief Creates the task and make it ready.
 232:../MQXLITE/kernel/task.c ****  *
 233:../MQXLITE/kernel/task.c ****  * \param[in] processor_number One of the following:
 234:../MQXLITE/kernel/task.c ****  * \n - Processor number of the processor where the task is to be created.
 235:../MQXLITE/kernel/task.c ****  * \n - 0 (Create on the local processor.)
 236:../MQXLITE/kernel/task.c ****  * \param[in] template_index One of the following:
 237:../MQXLITE/kernel/task.c ****  * \n - Index of the task template in the processor's task template list to use
 238:../MQXLITE/kernel/task.c ****  * for the child task.
 239:../MQXLITE/kernel/task.c ****  * \n - 0 (Use the task template that create_parameter defines.)
 240:../MQXLITE/kernel/task.c ****  * \param[in] parameter Pointer:
 241:../MQXLITE/kernel/task.c ****  * \n - Template_index is not 0 (Pointer to the parameter that MQX passes to the
 242:../MQXLITE/kernel/task.c ****  * child task.)
 243:../MQXLITE/kernel/task.c ****  * \n - Template_index is 0 (Pointer to the task template.)
 244:../MQXLITE/kernel/task.c ****  * \param[in] user User mode functionality.
 245:../MQXLITE/kernel/task.c ****  *
 246:../MQXLITE/kernel/task.c ****  * \return Task ID of the child task (Success.)
 247:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID
 248:../MQXLITE/kernel/task.c ****  *
 249:../MQXLITE/kernel/task.c ****  * \warning If the child is on another processor, blocks the creator until the
 250:../MQXLITE/kernel/task.c ****  * child is created.
 251:../MQXLITE/kernel/task.c ****  * \warning On failure, _task_set_error() is called to set the the following task
 252:../MQXLITE/kernel/task.c ****  * error codes:
 253:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_PROCESSOR_NUMBER (Processor_number is not one of the allowed
 254:../MQXLITE/kernel/task.c ****  * processor numbers.)
 255:../MQXLITE/kernel/task.c ****  * \n - MQX_NO_TASK_TEMPLATE (Template_index is not in the task template list.)
 256:../MQXLITE/kernel/task.c ****  * \n - MQX_OUT_OF_MEMORY (MQX cannot allocate memory for the task data structures.)
 257:../MQXLITE/kernel/task.c ****  * \warning For _task_create(): If the child is on the same processor, preempts
 258:../MQXLITE/kernel/task.c ****  * the creator if the
 259:../MQXLITE/kernel/task.c ****  * child is a higher priority.
 260:../MQXLITE/kernel/task.c ****  *
 261:../MQXLITE/kernel/task.c ****  * \see _task_create
 262:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
 263:../MQXLITE/kernel/task.c ****  * \see _task_create_at
 264:../MQXLITE/kernel/task.c ****  * \see _usr_task_create
 265:../MQXLITE/kernel/task.c ****  */
 266:../MQXLITE/kernel/task.c **** _task_id _task_create_internal
 267:../MQXLITE/kernel/task.c **** (
 268:../MQXLITE/kernel/task.c ****     _processor_number   processor_number,
 269:../MQXLITE/kernel/task.c ****     _mqx_uint           template_index,
 270:../MQXLITE/kernel/task.c ****     uint_32             parameter,
 271:../MQXLITE/kernel/task.c ****     boolean             user
 272:../MQXLITE/kernel/task.c **** )
 273:../MQXLITE/kernel/task.c **** {
 274:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
 275:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            td_ptr;
 276:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 277:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR task_template_ptr;
 278:../MQXLITE/kernel/task.c ****     boolean                  blocking;
 279:../MQXLITE/kernel/task.c **** #endif
 280:../MQXLITE/kernel/task.c ****     _task_id                 result = MQX_NULL_TASK_ID;
 281:../MQXLITE/kernel/task.c **** 
 282:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 283:../MQXLITE/kernel/task.c ****     _KLOGE4(KLOG_task_create, processor_number, template_index, parameter);
 284:../MQXLITE/kernel/task.c **** 
 285:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 286:../MQXLITE/kernel/task.c ****     if (template_index & SYSTEM_TASK_FLAG)
 287:../MQXLITE/kernel/task.c ****     {
 288:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TEMPLATE_INDEX);
 289:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create, MQX_NULL_TASK_ID, MQX_INVALID_TEMPLATE_INDEX);
 290:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 291:../MQXLITE/kernel/task.c ****     }
 292:../MQXLITE/kernel/task.c **** #endif
 293:../MQXLITE/kernel/task.c **** 
 294:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 295:../MQXLITE/kernel/task.c ****     if (user)
 296:../MQXLITE/kernel/task.c ****     {
 297:../MQXLITE/kernel/task.c ****         if (kernel_data->INIT.MAX_USER_TASK_COUNT && kernel_data->USR_TASK_RUN_COUNT >= kernel_data
 298:../MQXLITE/kernel/task.c ****         {
 299:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_TOO_MANY_USER_TASKS);
 300:../MQXLITE/kernel/task.c ****             _KLOGX3(KLOG_task_create, MQX_NULL_TASK_ID, MQX_TOO_MANY_USER_TASKS);
 301:../MQXLITE/kernel/task.c ****             return MQX_NULL_TASK_ID;
 302:../MQXLITE/kernel/task.c ****         }
 303:../MQXLITE/kernel/task.c **** 
 304:../MQXLITE/kernel/task.c ****         kernel_data->USR_TASK_RUN_COUNT++;
 305:../MQXLITE/kernel/task.c ****     }
 306:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
 307:../MQXLITE/kernel/task.c ****     if (processor_number == 0)
 308:../MQXLITE/kernel/task.c ****     {
 309:../MQXLITE/kernel/task.c ****         processor_number = (_processor_number) kernel_data->INIT.PROCESSOR_NUMBER;
 310:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 311:../MQXLITE/kernel/task.c ****     }
 312:../MQXLITE/kernel/task.c ****     else if (processor_number > MQX_MAX_PROCESSOR_NUMBER)
 313:../MQXLITE/kernel/task.c ****     {
 314:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 315:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create, MQX_NULL_TASK_ID, MQX_INVALID_PROCESSOR_NUMBER);
 316:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 317:../MQXLITE/kernel/task.c **** #endif
 318:../MQXLITE/kernel/task.c ****     }
 319:../MQXLITE/kernel/task.c ****     else if (processor_number != kernel_data->INIT.PROCESSOR_NUMBER)
 320:../MQXLITE/kernel/task.c ****     {
 321:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 322:../MQXLITE/kernel/task.c ****         if (user)
 323:../MQXLITE/kernel/task.c ****         {
 324:../MQXLITE/kernel/task.c ****             /* usermode don't support multiprocessor functionality */
 325:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 326:../MQXLITE/kernel/task.c ****             _KLOGX3(KLOG_task_create, MQX_NULL_TASK_ID, MQX_INVALID_PROCESSOR_NUMBER);
 327:../MQXLITE/kernel/task.c ****             return MQX_NULL_TASK_ID;
 328:../MQXLITE/kernel/task.c ****         }
 329:../MQXLITE/kernel/task.c **** #endif
 330:../MQXLITE/kernel/task.c **** 
 331:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 332:../MQXLITE/kernel/task.c ****         if ( kernel_data->IPC != NULL )
 333:../MQXLITE/kernel/task.c ****         {
 334:../MQXLITE/kernel/task.c **** #if MQX_TASK_CREATION_BLOCKS
 335:../MQXLITE/kernel/task.c ****             blocking = TRUE;
 336:../MQXLITE/kernel/task.c **** #else
 337:../MQXLITE/kernel/task.c ****             blocking = FALSE;
 338:../MQXLITE/kernel/task.c **** #endif
 339:../MQXLITE/kernel/task.c ****             if (template_index == 0)
 340:../MQXLITE/kernel/task.c ****             {
 341:../MQXLITE/kernel/task.c ****                 /* Task template is pointed to by the parameter */
 342:../MQXLITE/kernel/task.c ****                 task_template_ptr = (TASK_TEMPLATE_STRUCT_PTR)parameter;
 343:../MQXLITE/kernel/task.c ****                 (*kernel_data->IPC)(blocking, processor_number,
 344:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES,
 345:../MQXLITE/kernel/task.c ****                                 IPC_TASK_CREATE_WITH_TEMPLATE,
 346:../MQXLITE/kernel/task.c ****                                 8L,
 347:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_TEMPLATE_INDEX,
 348:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_ADDRESS,
 349:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_STACKSIZE,
 350:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_PRIORITY,
 351:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_NAME,
 352:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_ATTRIBUTES,
 353:../MQXLITE/kernel/task.c ****                                 task_template_ptr->CREATION_PARAMETER,
 354:../MQXLITE/kernel/task.c ****                                 task_template_ptr->DEFAULT_TIME_SLICE);
 355:../MQXLITE/kernel/task.c ****             }
 356:../MQXLITE/kernel/task.c ****             else
 357:../MQXLITE/kernel/task.c ****             {
 358:../MQXLITE/kernel/task.c ****                 (*kernel_data->IPC)(blocking, processor_number,
 359:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES, IPC_TASK_CREATE, 3,
 360:../MQXLITE/kernel/task.c ****                                 processor_number, template_index, parameter);
 361:../MQXLITE/kernel/task.c ****             } /* Endif */
 362:../MQXLITE/kernel/task.c ****             return(kernel_data->ACTIVE_PTR->INFO);
 363:../MQXLITE/kernel/task.c ****         }
 364:../MQXLITE/kernel/task.c ****         else
 365:../MQXLITE/kernel/task.c ****         {
 366:../MQXLITE/kernel/task.c **** #endif
 367:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 368:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create, MQX_NULL_TASK_ID, MQX_INVALID_PROCESSOR_NUMBER);
 369:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 370:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 371:../MQXLITE/kernel/task.c ****     } /* Endif */
 372:../MQXLITE/kernel/task.c **** #endif
 373:../MQXLITE/kernel/task.c ****     } /* Endif */
 374:../MQXLITE/kernel/task.c **** 
 375:../MQXLITE/kernel/task.c ****     td_ptr = _task_build_internal(template_index, parameter, NULL, 0, user);
 376:../MQXLITE/kernel/task.c **** 
 377:../MQXLITE/kernel/task.c ****     if (td_ptr != NULL)
 378:../MQXLITE/kernel/task.c ****     {
 379:../MQXLITE/kernel/task.c ****         result = td_ptr->TASK_ID;
 380:../MQXLITE/kernel/task.c ****         _INT_DISABLE();
 381:../MQXLITE/kernel/task.c ****         _task_ready_internal(td_ptr);
 382:../MQXLITE/kernel/task.c ****         _INT_ENABLE();
 383:../MQXLITE/kernel/task.c ****         _CHECK_RUN_SCHEDULER(); /* Let a higher priority task run */
 384:../MQXLITE/kernel/task.c ****     }
 385:../MQXLITE/kernel/task.c **** 
 386:../MQXLITE/kernel/task.c ****     _KLOGX3(KLOG_task_create, result, kernel_data->ACTIVE_PTR->TASK_ERROR_CODE);
 387:../MQXLITE/kernel/task.c **** 
 388:../MQXLITE/kernel/task.c ****     return (result);
 389:../MQXLITE/kernel/task.c **** }
 390:../MQXLITE/kernel/task.c **** 
 391:../MQXLITE/kernel/task.c **** /*!
 392:../MQXLITE/kernel/task.c ****  * \brief Creates the task and make it ready.
 393:../MQXLITE/kernel/task.c ****  *
 394:../MQXLITE/kernel/task.c ****  * \param[in] processor_number One of the following:
 395:../MQXLITE/kernel/task.c ****  * \n - Processor number of the processor where the task is to be created.
 396:../MQXLITE/kernel/task.c ****  * \n - 0 (Create on the local processor.)
 397:../MQXLITE/kernel/task.c ****  * \param[in] template_index   One of the following:
 398:../MQXLITE/kernel/task.c ****  * \n - Index of the task template in the processor's task template list to use
 399:../MQXLITE/kernel/task.c ****  * for the child task.
 400:../MQXLITE/kernel/task.c ****  * \n - 0 (Use the task template that create_parameter defines.)
 401:../MQXLITE/kernel/task.c ****  * \param[in] parameter        Pointer:
 402:../MQXLITE/kernel/task.c ****  * \n - Template_index is not 0 (Pointer to the parameter that MQX passes to the
 403:../MQXLITE/kernel/task.c ****  * child task.)
 404:../MQXLITE/kernel/task.c ****  * \n - Template_index is 0 (Pointer to the task template.)
 405:../MQXLITE/kernel/task.c ****  *
 406:../MQXLITE/kernel/task.c ****  * \return Task ID of the child task (Success.)
 407:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Failure.)
 408:../MQXLITE/kernel/task.c ****  *
 409:../MQXLITE/kernel/task.c ****  * \warning If the child is on another processor, blocks the creator until the
 410:../MQXLITE/kernel/task.c ****  * child is created.
 411:../MQXLITE/kernel/task.c ****  * \warning On failure, _task_set_error() is called to set the the following task
 412:../MQXLITE/kernel/task.c ****  * error codes:
 413:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_PROCESSOR_NUMBER (Processor_number is not one of the allowed
 414:../MQXLITE/kernel/task.c ****  * processor numbers.)
 415:../MQXLITE/kernel/task.c ****  * \n - MQX_NO_TASK_TEMPLATE (Template_index is not in the task template list.)
 416:../MQXLITE/kernel/task.c ****  * \n - MQX_OUT_OF_MEMORY (MQX cannot allocate memory for the task data structures.)
 417:../MQXLITE/kernel/task.c ****  * \warning If the child is on the same processor, preempts the creator if the
 418:../MQXLITE/kernel/task.c ****  * child is a higher priority.
 419:../MQXLITE/kernel/task.c ****  *
 420:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
 421:../MQXLITE/kernel/task.c ****  * \see _task_create_at
 422:../MQXLITE/kernel/task.c ****  * \see _task_abort
 423:../MQXLITE/kernel/task.c ****  * \see _task_block
 424:../MQXLITE/kernel/task.c ****  * \see _task_destroy
 425:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
 426:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
 427:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
 428:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
 429:../MQXLITE/kernel/task.c ****  * \see _task_ready
 430:../MQXLITE/kernel/task.c ****  * \see _task_set_error
 431:../MQXLITE/kernel/task.c ****  */
 432:../MQXLITE/kernel/task.c **** _task_id _task_create
 433:../MQXLITE/kernel/task.c **** (
 434:../MQXLITE/kernel/task.c ****     _processor_number   processor_number,
 435:../MQXLITE/kernel/task.c ****     _mqx_uint           template_index,
 436:../MQXLITE/kernel/task.c ****     uint_32             parameter
 437:../MQXLITE/kernel/task.c **** )
 438:../MQXLITE/kernel/task.c **** {
 439:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE && MQX_ENABLE_USER_STDAPI
 440:../MQXLITE/kernel/task.c ****     if (MQX_RUN_IN_USER_MODE)
 441:../MQXLITE/kernel/task.c ****     {
 442:../MQXLITE/kernel/task.c ****         return _usr_task_create(processor_number, template_index, parameter);
 443:../MQXLITE/kernel/task.c ****     }
 444:../MQXLITE/kernel/task.c **** #endif
 445:../MQXLITE/kernel/task.c ****     return _task_create_internal(processor_number, template_index, parameter, FALSE);
 446:../MQXLITE/kernel/task.c **** }
 447:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
 448:../MQXLITE/kernel/task.c **** 
 449:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 450:../MQXLITE/kernel/task.c **** 
 451:../MQXLITE/kernel/task.c **** /*!
 452:../MQXLITE/kernel/task.c ****  * \brief Creates the task and make it ready.
 453:../MQXLITE/kernel/task.c ****  *
 454:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_create() API call but it can be
 455:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
 456:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
 457:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
 458:../MQXLITE/kernel/task.c ****  *
 459:../MQXLITE/kernel/task.c ****  * \param[in] processor_number One of the following:
 460:../MQXLITE/kernel/task.c ****  * \n - Processor number of the processor where the task is to be created.
 461:../MQXLITE/kernel/task.c ****  * \n - 0 (Create on the local processor.)
 462:../MQXLITE/kernel/task.c ****  * \param[in] template_index   One of the following:
 463:../MQXLITE/kernel/task.c ****  * \n - Index of the task template in the processor's task template list to use
 464:../MQXLITE/kernel/task.c ****  * for the child task.
 465:../MQXLITE/kernel/task.c ****  * \n - 0 (Use the task template that create_parameter defines.)
 466:../MQXLITE/kernel/task.c ****  * \param[in] parameter        Pointer:
 467:../MQXLITE/kernel/task.c ****  * \n - Template_index is not 0 (Pointer to the parameter that MQX passes to the
 468:../MQXLITE/kernel/task.c ****  * child task.)
 469:../MQXLITE/kernel/task.c ****  * \n - Template_index is 0 (Pointer to the task template.)
 470:../MQXLITE/kernel/task.c ****  *
 471:../MQXLITE/kernel/task.c ****  * \return Task ID of the child task (Success.)
 472:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Failure.)
 473:../MQXLITE/kernel/task.c ****  *
 474:../MQXLITE/kernel/task.c ****  * \warning If the child is on another processor, blocks the creator until the
 475:../MQXLITE/kernel/task.c ****  * child is created.
 476:../MQXLITE/kernel/task.c ****  * \warning On failure, _task_set_error() is called to set the the following task
 477:../MQXLITE/kernel/task.c ****  * error codes:
 478:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_PROCESSOR_NUMBER (Processor_number is not one of the allowed
 479:../MQXLITE/kernel/task.c ****  * processor numbers.)
 480:../MQXLITE/kernel/task.c ****  * \n - MQX_NO_TASK_TEMPLATE (Template_index is not in the task template list.)
 481:../MQXLITE/kernel/task.c ****  * \n - MQX_OUT_OF_MEMORY (MQX cannot allocate memory for the task data structures.)
 482:../MQXLITE/kernel/task.c ****  * \warning If the child is on the same processor, preempts the creator if the
 483:../MQXLITE/kernel/task.c ****  * child is a higher priority.
 484:../MQXLITE/kernel/task.c ****  *
 485:../MQXLITE/kernel/task.c ****  * \see _task_create
 486:../MQXLITE/kernel/task.c ****  * \see _usr_task_abort
 487:../MQXLITE/kernel/task.c ****  * \see _usr_task_destroy
 488:../MQXLITE/kernel/task.c ****  * \see _usr_task_ready
 489:../MQXLITE/kernel/task.c ****  * \see _usr_task_set_error
 490:../MQXLITE/kernel/task.c ****  */
 491:../MQXLITE/kernel/task.c **** _task_id _usr_task_create
 492:../MQXLITE/kernel/task.c **** (
 493:../MQXLITE/kernel/task.c ****     _processor_number   processor_number,
 494:../MQXLITE/kernel/task.c ****     _mqx_uint           template_index,
 495:../MQXLITE/kernel/task.c ****     uint_32             parameter
 496:../MQXLITE/kernel/task.c **** )
 497:../MQXLITE/kernel/task.c **** {
 498:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params =
 499:../MQXLITE/kernel/task.c ****         {(uint_32)processor_number, (uint_32)template_index, (uint_32)parameter, 0, 0};
 500:../MQXLITE/kernel/task.c **** 
 501:../MQXLITE/kernel/task.c ****     return _mqx_api_call(MQX_API_TASK_CREATE, &params);
 502:../MQXLITE/kernel/task.c **** }
 503:../MQXLITE/kernel/task.c **** 
 504:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
 505:../MQXLITE/kernel/task.c **** 
 506:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
 507:../MQXLITE/kernel/task.c **** /*!
 508:../MQXLITE/kernel/task.c ****  * \brief Creates the task, but do not make it ready.
 509:../MQXLITE/kernel/task.c ****  *
 510:../MQXLITE/kernel/task.c ****  * \param[in] processor_number One of the following:
 511:../MQXLITE/kernel/task.c ****  * \n - Processor number of the processor where the task is to be created.
 512:../MQXLITE/kernel/task.c ****  * \n - 0 (Create on the local processor.)
 513:../MQXLITE/kernel/task.c ****  * \param[in] template_index   One of the following:
 514:../MQXLITE/kernel/task.c ****  * \n - Index of the task template in the processor's task template list to use
 515:../MQXLITE/kernel/task.c ****  * for the child task.
 516:../MQXLITE/kernel/task.c ****  * \n - 0 (Use the task template that create_parameter defines.)
 517:../MQXLITE/kernel/task.c ****  * \param[in] parameter        Pointer:
 518:../MQXLITE/kernel/task.c ****  * \n - Template_index is not 0 (Pointer to the parameter that MQX passes to the
 519:../MQXLITE/kernel/task.c ****  * child task.)
 520:../MQXLITE/kernel/task.c ****  * \n - Template_index is 0 (Pointer to the task template.)
 521:../MQXLITE/kernel/task.c ****  *
 522:../MQXLITE/kernel/task.c ****  * \return Task ID of the child task (Success.)
 523:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Failure.)
 524:../MQXLITE/kernel/task.c ****  *
 525:../MQXLITE/kernel/task.c ****  * \warning If the child is on another processor, blocks the creator until the
 526:../MQXLITE/kernel/task.c ****  * child is created.
 527:../MQXLITE/kernel/task.c ****  * \warning On failure, _task_set_error() is called to set the the following task
 528:../MQXLITE/kernel/task.c ****  * error codes:
 529:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_PROCESSOR_NUMBER (Processor_number is not one of the allowed
 530:../MQXLITE/kernel/task.c ****  * processor numbers.)
 531:../MQXLITE/kernel/task.c ****  * \n - MQX_NO_TASK_TEMPLATE (Template_index is not in the task template list.)
 532:../MQXLITE/kernel/task.c ****  * \n - MQX_OUT_OF_MEMORY (MQX cannot allocate memory for the task data structures.)
 533:../MQXLITE/kernel/task.c ****  * \warning If the child is on the same processor, preempts the creator if the
 534:../MQXLITE/kernel/task.c ****  * child is a higher priority.
 535:../MQXLITE/kernel/task.c ****  *
 536:../MQXLITE/kernel/task.c ****  * \see _task_create
 537:../MQXLITE/kernel/task.c ****  * \see _task_create_at
 538:../MQXLITE/kernel/task.c ****  * \see _task_abort
 539:../MQXLITE/kernel/task.c ****  * \see _task_block
 540:../MQXLITE/kernel/task.c ****  * \see _task_destroy
 541:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
 542:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
 543:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
 544:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
 545:../MQXLITE/kernel/task.c ****  * \see _task_ready
 546:../MQXLITE/kernel/task.c ****  * \see _task_set_error
 547:../MQXLITE/kernel/task.c ****  */
 548:../MQXLITE/kernel/task.c **** _task_id _task_create_blocked
 549:../MQXLITE/kernel/task.c **** (
 550:../MQXLITE/kernel/task.c ****     _processor_number   processor_number,
 551:../MQXLITE/kernel/task.c ****     _mqx_uint           template_index,
 552:../MQXLITE/kernel/task.c ****     uint_32             parameter
 553:../MQXLITE/kernel/task.c **** )
 554:../MQXLITE/kernel/task.c **** { /* Body */
 555:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
 556:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            td_ptr;
 557:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 558:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR task_template_ptr;
 559:../MQXLITE/kernel/task.c ****     boolean                  blocking;
 560:../MQXLITE/kernel/task.c **** #endif
 561:../MQXLITE/kernel/task.c ****     _task_id                 result;
 562:../MQXLITE/kernel/task.c **** 
 563:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 564:../MQXLITE/kernel/task.c ****     _KLOGE4(KLOG_task_create_block, processor_number, template_index, parameter);
 565:../MQXLITE/kernel/task.c **** 
 566:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 567:../MQXLITE/kernel/task.c ****     if (template_index & SYSTEM_TASK_FLAG)
 568:../MQXLITE/kernel/task.c ****     {
 569:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TEMPLATE_INDEX);
 570:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create_block, MQX_NULL_TASK_ID,
 571:../MQXLITE/kernel/task.c ****                         MQX_INVALID_TEMPLATE_INDEX);
 572:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 573:../MQXLITE/kernel/task.c ****     } /* Endif */
 574:../MQXLITE/kernel/task.c **** #endif
 575:../MQXLITE/kernel/task.c **** 
 576:../MQXLITE/kernel/task.c ****     if (processor_number == 0)
 577:../MQXLITE/kernel/task.c ****     {
 578:../MQXLITE/kernel/task.c ****         processor_number = (_processor_number) kernel_data->INIT.PROCESSOR_NUMBER;
 579:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 580:../MQXLITE/kernel/task.c ****     }
 581:../MQXLITE/kernel/task.c ****     else if (processor_number > MQX_MAX_PROCESSOR_NUMBER)
 582:../MQXLITE/kernel/task.c ****     {
 583:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 584:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create_block, MQX_NULL_TASK_ID,
 585:../MQXLITE/kernel/task.c ****                         MQX_INVALID_PROCESSOR_NUMBER);
 586:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 587:../MQXLITE/kernel/task.c **** #endif
 588:../MQXLITE/kernel/task.c ****     }
 589:../MQXLITE/kernel/task.c ****     else if (processor_number != kernel_data->INIT.PROCESSOR_NUMBER)
 590:../MQXLITE/kernel/task.c ****     {
 591:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 592:../MQXLITE/kernel/task.c ****         if ( kernel_data->IPC != NULL )
 593:../MQXLITE/kernel/task.c ****         {
 594:../MQXLITE/kernel/task.c **** #if MQX_TASK_CREATION_BLOCKS
 595:../MQXLITE/kernel/task.c ****             blocking = TRUE;
 596:../MQXLITE/kernel/task.c **** #else
 597:../MQXLITE/kernel/task.c ****             blocking = FALSE;
 598:../MQXLITE/kernel/task.c **** #endif
 599:../MQXLITE/kernel/task.c ****             if (template_index == 0)
 600:../MQXLITE/kernel/task.c ****             {
 601:../MQXLITE/kernel/task.c ****                 /* Task template is pointed to by the parameter */
 602:../MQXLITE/kernel/task.c ****                 task_template_ptr = (TASK_TEMPLATE_STRUCT_PTR)parameter;
 603:../MQXLITE/kernel/task.c ****                 (*kernel_data->IPC)(blocking, processor_number,
 604:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES, IPC_TASK_CREATE_WITH_TEMPLATE, 8L,
 605:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_TEMPLATE_INDEX,
 606:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_ADDRESS,
 607:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_STACKSIZE,
 608:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_PRIORITY,
 609:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_NAME,
 610:../MQXLITE/kernel/task.c ****                                 task_template_ptr->TASK_ATTRIBUTES,
 611:../MQXLITE/kernel/task.c ****                                 task_template_ptr->CREATION_PARAMETER,
 612:../MQXLITE/kernel/task.c ****                                 task_template_ptr->DEFAULT_TIME_SLICE
 613:../MQXLITE/kernel/task.c ****                 );
 614:../MQXLITE/kernel/task.c ****             }
 615:../MQXLITE/kernel/task.c ****             else
 616:../MQXLITE/kernel/task.c ****             {
 617:../MQXLITE/kernel/task.c ****                 (*kernel_data->IPC)(blocking, processor_number,
 618:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES, IPC_TASK_CREATE, 3,
 619:../MQXLITE/kernel/task.c ****                                 processor_number, template_index, parameter);
 620:../MQXLITE/kernel/task.c ****             } /* Endif */
 621:../MQXLITE/kernel/task.c ****             return(kernel_data->ACTIVE_PTR->INFO);
 622:../MQXLITE/kernel/task.c ****         }
 623:../MQXLITE/kernel/task.c ****         else
 624:../MQXLITE/kernel/task.c ****         {
 625:../MQXLITE/kernel/task.c **** #endif
 626:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 627:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create_block, MQX_NULL_TASK_ID,
 628:../MQXLITE/kernel/task.c ****                         MQX_INVALID_PROCESSOR_NUMBER);
 629:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 630:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 631:../MQXLITE/kernel/task.c ****     } /* Endif */
 632:../MQXLITE/kernel/task.c **** #endif
 633:../MQXLITE/kernel/task.c ****     } /* Endif */
 634:../MQXLITE/kernel/task.c **** 
 635:../MQXLITE/kernel/task.c ****     td_ptr = _task_build_internal(template_index, parameter, NULL, 0, FALSE);
 636:../MQXLITE/kernel/task.c ****     if (td_ptr != NULL)
 637:../MQXLITE/kernel/task.c ****     {
 638:../MQXLITE/kernel/task.c ****         td_ptr->STATE = BLOCKED;
 639:../MQXLITE/kernel/task.c ****         result = td_ptr->TASK_ID;
 640:../MQXLITE/kernel/task.c ****     }
 641:../MQXLITE/kernel/task.c ****     else
 642:../MQXLITE/kernel/task.c ****     {
 643:../MQXLITE/kernel/task.c ****         result = MQX_NULL_TASK_ID;
 644:../MQXLITE/kernel/task.c ****     }/* Endif */
 645:../MQXLITE/kernel/task.c **** 
 646:../MQXLITE/kernel/task.c ****     _KLOGX3(KLOG_task_create_block, result,
 647:../MQXLITE/kernel/task.c ****                     kernel_data->ACTIVE_PTR->TASK_ERROR_CODE);
 648:../MQXLITE/kernel/task.c **** 
 649:../MQXLITE/kernel/task.c ****     return (result);
 650:../MQXLITE/kernel/task.c **** 
 651:../MQXLITE/kernel/task.c **** } /* Endbody */
 652:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
 653:../MQXLITE/kernel/task.c **** 
 654:../MQXLITE/kernel/task.c **** /*!
 655:../MQXLITE/kernel/task.c ****  * \brief Creates the task with the stack location specified.
 656:../MQXLITE/kernel/task.c ****  *
 657:../MQXLITE/kernel/task.c ****  * \param[in] processor_number One of the following:
 658:../MQXLITE/kernel/task.c ****  * \n - Processor number of the processor where the task is to be created.
 659:../MQXLITE/kernel/task.c ****  * \n - 0 (Create on the local processor.)
 660:../MQXLITE/kernel/task.c ****  * \param[in] template_index   One of the following:
 661:../MQXLITE/kernel/task.c ****  * \n - Index of the task template in the processor's task template list to use
 662:../MQXLITE/kernel/task.c ****  * for the child task.
 663:../MQXLITE/kernel/task.c ****  * \n - 0 (Use the task template that create_parameter defines.)
 664:../MQXLITE/kernel/task.c ****  * \param[in] parameter        Pointer:
 665:../MQXLITE/kernel/task.c ****  * \n - Template_index is not 0 (Pointer to the parameter that MQX passes to the
 666:../MQXLITE/kernel/task.c ****  * child task.)
 667:../MQXLITE/kernel/task.c ****  * \n - Template_index is 0 (Pointer to the task template.)
 668:../MQXLITE/kernel/task.c ****  * \param[in] stack_ptr        Pointer to where the stack and TD are to be created.
 669:../MQXLITE/kernel/task.c ****  * \param[in] stack_size       The size of the stack.
 670:../MQXLITE/kernel/task.c ****  *
 671:../MQXLITE/kernel/task.c ****  * \return Task ID of the child task (Success.)
 672:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Failure.)
 673:../MQXLITE/kernel/task.c ****  *
 674:../MQXLITE/kernel/task.c ****  * \warning If the child is on another processor, blocks the creator until the
 675:../MQXLITE/kernel/task.c ****  * child is created.
 676:../MQXLITE/kernel/task.c ****  * \warning On failure, _task_set_error() is called to set the following task
 677:../MQXLITE/kernel/task.c ****  * error codes:
 678:../MQXLITE/kernel/task.c ****  * \n Task Error Codes
 679:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_PROCESSOR_NUMBER (Processor_number is not one of the allowed
 680:../MQXLITE/kernel/task.c ****  * processor numbers.)
 681:../MQXLITE/kernel/task.c ****  * \n - MQX_NO_TASK_TEMPLATE (Template_index is not in the task template list.)
 682:../MQXLITE/kernel/task.c ****  * \n - MQX_OUT_OF_MEMORY (MQX cannot allocate memory for the task data structures.)
 683:../MQXLITE/kernel/task.c ****  *
 684:../MQXLITE/kernel/task.c ****  * \see _task_create
 685:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
 686:../MQXLITE/kernel/task.c ****  * \see _task_abort
 687:../MQXLITE/kernel/task.c ****  * \see _task_block
 688:../MQXLITE/kernel/task.c ****  * \see _task_destroy
 689:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
 690:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
 691:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
 692:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
 693:../MQXLITE/kernel/task.c ****  * \see _task_ready
 694:../MQXLITE/kernel/task.c ****  * \see _task_set_error
 695:../MQXLITE/kernel/task.c ****  */
 696:../MQXLITE/kernel/task.c **** _task_id _task_create_at
 697:../MQXLITE/kernel/task.c **** (
 698:../MQXLITE/kernel/task.c ****     _processor_number   processor_number,
 699:../MQXLITE/kernel/task.c ****     _mqx_uint           template_index,
 700:../MQXLITE/kernel/task.c ****     uint_32             parameter,
 701:../MQXLITE/kernel/task.c ****     pointer             stack_ptr,
 702:../MQXLITE/kernel/task.c ****     _mem_size           stack_size
 703:../MQXLITE/kernel/task.c **** )
 704:../MQXLITE/kernel/task.c **** { /* Body */
 322              		.loc 1 704 0
 323              		.cfi_startproc
 324 0000 90B5     		push	{r4, r7, lr}
 325              	.LCFI6:
 326              		.cfi_def_cfa_offset 12
 327              		.cfi_offset 4, -12
 328              		.cfi_offset 7, -8
 329              		.cfi_offset 14, -4
 330 0002 8BB0     		sub	sp, sp, #44
 331              	.LCFI7:
 332              		.cfi_def_cfa_offset 56
 333 0004 02AF     		add	r7, sp, #8
 334              	.LCFI8:
 335              		.cfi_def_cfa 7, 48
 336 0006 B960     		str	r1, [r7, #8]
 337 0008 7A60     		str	r2, [r7, #4]
 338 000a 3B60     		str	r3, [r7]
 339 000c 3B1C     		mov	r3, r7
 340 000e 0E33     		add	r3, r3, #14
 341 0010 021C     		add	r2, r0, #0
 342 0012 1A80     		strh	r2, [r3]
 705:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR kernel_data;
 706:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR          td_ptr;
 707:../MQXLITE/kernel/task.c ****     _task_id               result;
 708:../MQXLITE/kernel/task.c **** 
 709:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 343              		.loc 1 709 0
 344 0014 2B4B     		ldr	r3, .L25
 345 0016 1B68     		ldr	r3, [r3]
 346 0018 BB61     		str	r3, [r7, #24]
 710:../MQXLITE/kernel/task.c ****     _KLOGE5(KLOG_task_create_at, processor_number, template_index, parameter,
 711:../MQXLITE/kernel/task.c ****                     stack_ptr);
 712:../MQXLITE/kernel/task.c **** 
 713:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 714:../MQXLITE/kernel/task.c ****     if (template_index & SYSTEM_TASK_FLAG)
 347              		.loc 1 714 0
 348 001a BB68     		ldr	r3, [r7, #8]
 349 001c 002B     		cmp	r3, #0
 350 001e 04DA     		bge	.L17
 715:../MQXLITE/kernel/task.c ****     {
 716:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TEMPLATE_INDEX);
 351              		.loc 1 716 0
 352 0020 1520     		mov	r0, #21
 353 0022 FFF7FEFF 		bl	_task_set_error
 717:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create_at, MQX_NULL_TASK_ID,
 718:../MQXLITE/kernel/task.c ****                         MQX_INVALID_TEMPLATE_INDEX);
 719:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 354              		.loc 1 719 0
 355 0026 0023     		mov	r3, #0
 356 0028 47E0     		b	.L18
 357              	.L17:
 720:../MQXLITE/kernel/task.c ****     } /* Endif */
 721:../MQXLITE/kernel/task.c **** #endif
 722:../MQXLITE/kernel/task.c **** 
 723:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 724:../MQXLITE/kernel/task.c ****     if (processor_number != 0)
 358              		.loc 1 724 0
 359 002a 3B1C     		mov	r3, r7
 360 002c 0E33     		add	r3, r3, #14
 361 002e 1B88     		ldrh	r3, [r3]
 362 0030 002B     		cmp	r3, #0
 363 0032 04D0     		beq	.L19
 725:../MQXLITE/kernel/task.c ****     {
 726:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_PROCESSOR_NUMBER);
 364              		.loc 1 726 0
 365 0034 1320     		mov	r0, #19
 366 0036 FFF7FEFF 		bl	_task_set_error
 727:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_create_at, MQX_NULL_TASK_ID,
 728:../MQXLITE/kernel/task.c ****                         MQX_INVALID_PROCESSOR_NUMBER);
 729:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 367              		.loc 1 729 0
 368 003a 0023     		mov	r3, #0
 369 003c 3DE0     		b	.L18
 370              	.L19:
 730:../MQXLITE/kernel/task.c ****     } /* Endif */
 731:../MQXLITE/kernel/task.c **** #endif
 732:../MQXLITE/kernel/task.c **** 
 733:../MQXLITE/kernel/task.c ****     td_ptr = _task_build_internal(template_index, parameter, stack_ptr, stack_size, FALSE);
 371              		.loc 1 733 0
 372 003e B868     		ldr	r0, [r7, #8]
 373 0040 7968     		ldr	r1, [r7, #4]
 374 0042 3A68     		ldr	r2, [r7]
 375 0044 3B6B     		ldr	r3, [r7, #48]
 376 0046 0024     		mov	r4, #0
 377 0048 0094     		str	r4, [sp]
 378 004a FFF7FEFF 		bl	_task_build_internal
 379 004e 031C     		mov	r3, r0
 380 0050 7B61     		str	r3, [r7, #20]
 734:../MQXLITE/kernel/task.c ****     if (td_ptr != NULL)
 381              		.loc 1 734 0
 382 0052 7B69     		ldr	r3, [r7, #20]
 383 0054 002B     		cmp	r3, #0
 384 0056 28D0     		beq	.L20
 735:../MQXLITE/kernel/task.c ****     {
 736:../MQXLITE/kernel/task.c ****         result = td_ptr->TASK_ID;
 385              		.loc 1 736 0
 386 0058 7B69     		ldr	r3, [r7, #20]
 387 005a DB68     		ldr	r3, [r3, #12]
 388 005c FB61     		str	r3, [r7, #28]
 737:../MQXLITE/kernel/task.c ****         _INT_DISABLE();
 389              		.loc 1 737 0
 390 005e BB69     		ldr	r3, [r7, #24]
 391 0060 DB69     		ldr	r3, [r3, #28]
 392 0062 9B6C     		ldr	r3, [r3, #72]
 393 0064 002B     		cmp	r3, #0
 394 0066 00D1     		bne	.L21
 395              		.loc 1 737 0 is_stmt 0 discriminator 1
 396              	@ 737 "../MQXLITE/kernel/task.c" 1
 397 0068 72B6     		cpsid i
 398              	@ 0 "" 2
 399              		.code	16
 400              	.L21:
 401              		.loc 1 737 0 discriminator 2
 402 006a BB69     		ldr	r3, [r7, #24]
 403 006c DB69     		ldr	r3, [r3, #28]
 404 006e 9A6C     		ldr	r2, [r3, #72]
 405 0070 0132     		add	r2, r2, #1
 406 0072 9A64     		str	r2, [r3, #72]
 738:../MQXLITE/kernel/task.c ****         _task_ready_internal(td_ptr);
 407              		.loc 1 738 0 is_stmt 1 discriminator 2
 408 0074 7B69     		ldr	r3, [r7, #20]
 409 0076 181C     		mov	r0, r3
 410 0078 FFF7FEFF 		bl	_task_ready_internal
 739:../MQXLITE/kernel/task.c ****         _INT_ENABLE();
 411              		.loc 1 739 0 discriminator 2
 412 007c BB69     		ldr	r3, [r7, #24]
 413 007e DB69     		ldr	r3, [r3, #28]
 414 0080 9B6C     		ldr	r3, [r3, #72]
 415 0082 002B     		cmp	r3, #0
 416 0084 0ED0     		beq	.L22
 417              		.loc 1 739 0 is_stmt 0 discriminator 1
 418 0086 BB69     		ldr	r3, [r7, #24]
 419 0088 DB69     		ldr	r3, [r3, #28]
 420 008a 9A6C     		ldr	r2, [r3, #72]
 421 008c 013A     		sub	r2, r2, #1
 422 008e 9A64     		str	r2, [r3, #72]
 423 0090 9B6C     		ldr	r3, [r3, #72]
 424 0092 002B     		cmp	r3, #0
 425 0094 06D1     		bne	.L22
 426              		.loc 1 739 0 discriminator 2
 427 0096 BB69     		ldr	r3, [r7, #24]
 428 0098 1B8B     		ldrh	r3, [r3, #24]
 429 009a 002B     		cmp	r3, #0
 430 009c 01D0     		beq	.L23
 431              		.loc 1 739 0 discriminator 3
 432              	@ 739 "../MQXLITE/kernel/task.c" 1
 433 009e 62B6     		cpsie i
 434              	@ 0 "" 2
 435              		.code	16
 436 00a0 00E0     		b	.L22
 437              	.L23:
 438              		.loc 1 739 0 discriminator 4
 439              	@ 739 "../MQXLITE/kernel/task.c" 1
 440 00a2 62B6     		cpsie i
 441              	@ 0 "" 2
 442              		.code	16
 443              	.L22:
 740:../MQXLITE/kernel/task.c ****         _CHECK_RUN_SCHEDULER(); /* Let a higher priority task run */
 444              		.loc 1 740 0 is_stmt 1
 445 00a4 FFF7FEFF 		bl	_sched_check_scheduler_internal
 446 00a8 01E0     		b	.L24
 447              	.L20:
 741:../MQXLITE/kernel/task.c ****     }
 742:../MQXLITE/kernel/task.c ****     else
 743:../MQXLITE/kernel/task.c ****     {
 744:../MQXLITE/kernel/task.c ****         result = MQX_NULL_TASK_ID;
 448              		.loc 1 744 0
 449 00aa 0023     		mov	r3, #0
 450 00ac FB61     		str	r3, [r7, #28]
 451              	.L24:
 745:../MQXLITE/kernel/task.c ****     }/* Endif */
 746:../MQXLITE/kernel/task.c **** 
 747:../MQXLITE/kernel/task.c ****     _KLOGX3(KLOG_task_create_at, result,
 748:../MQXLITE/kernel/task.c ****                     kernel_data->ACTIVE_PTR->TASK_ERROR_CODE);
 749:../MQXLITE/kernel/task.c **** 
 750:../MQXLITE/kernel/task.c ****     _tad_task_at_flag++;
 452              		.loc 1 750 0
 453 00ae 064B     		ldr	r3, .L25+4
 454 00b0 1B68     		ldr	r3, [r3]
 455 00b2 5A1C     		add	r2, r3, #1
 456 00b4 044B     		ldr	r3, .L25+4
 457 00b6 1A60     		str	r2, [r3]
 751:../MQXLITE/kernel/task.c **** 
 752:../MQXLITE/kernel/task.c ****     return (result);
 458              		.loc 1 752 0
 459 00b8 FB69     		ldr	r3, [r7, #28]
 460              	.L18:
 753:../MQXLITE/kernel/task.c **** 
 754:../MQXLITE/kernel/task.c **** } /* Endbody */
 461              		.loc 1 754 0
 462 00ba 181C     		mov	r0, r3
 463 00bc BD46     		mov	sp, r7
 464 00be 09B0     		add	sp, sp, #36
 465              		@ sp needed for prologue
 466 00c0 90BD     		pop	{r4, r7, pc}
 467              	.L26:
 468 00c2 C046     		.align	2
 469              	.L25:
 470 00c4 00000000 		.word	_mqx_kernel_data
 471 00c8 00000000 		.word	_tad_task_at_flag
 472              		.cfi_endproc
 473              	.LFE2:
 475              		.section	.text._task_destroy_internal,"ax",%progbits
 476              		.align	2
 477              		.global	_task_destroy_internal
 478              		.code	16
 479              		.thumb_func
 481              	_task_destroy_internal:
 482              	.LFB3:
 755:../MQXLITE/kernel/task.c **** 
 756:../MQXLITE/kernel/task.c **** /*!
 757:../MQXLITE/kernel/task.c ****  * \private
 758:../MQXLITE/kernel/task.c ****  *
 759:../MQXLITE/kernel/task.c ****  * \brief Destroys the task.
 760:../MQXLITE/kernel/task.c ****  *
 761:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of the following:
 762:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task to be destroyed.
 763:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Destroy the calling task.)
 764:../MQXLITE/kernel/task.c ****  * \param[in] user    User mode functionality.
 765:../MQXLITE/kernel/task.c ****  *
 766:../MQXLITE/kernel/task.c ****  * \return MQX_OK
 767:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID
 768:../MQXLITE/kernel/task.c ****  *
 769:../MQXLITE/kernel/task.c ****  * \see _task_destroy
 770:../MQXLITE/kernel/task.c ****  * \see _usr_task_destroy
 771:../MQXLITE/kernel/task.c ****  */
 772:../MQXLITE/kernel/task.c **** _mqx_uint _task_destroy_internal
 773:../MQXLITE/kernel/task.c **** (
 774:../MQXLITE/kernel/task.c ****     _task_id task_id,
 775:../MQXLITE/kernel/task.c ****     boolean  user
 776:../MQXLITE/kernel/task.c **** )
 777:../MQXLITE/kernel/task.c **** {
 483              		.loc 1 777 0
 484              		.cfi_startproc
 485 0000 80B5     		push	{r7, lr}
 486              	.LCFI9:
 487              		.cfi_def_cfa_offset 8
 488              		.cfi_offset 7, -8
 489              		.cfi_offset 14, -4
 490 0002 94B0     		sub	sp, sp, #80
 491              	.LCFI10:
 492              		.cfi_def_cfa_offset 88
 493 0004 00AF     		add	r7, sp, #0
 494              	.LCFI11:
 495              		.cfi_def_cfa_register 7
 496 0006 7860     		str	r0, [r7, #4]
 497 0008 3960     		str	r1, [r7]
 778:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
 779:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            victim_ptr;
 780:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            td_ptr;
 781:../MQXLITE/kernel/task.c ****     _processor_number        processor;
 782:../MQXLITE/kernel/task.c ****     uint_16                  task_num;
 783:../MQXLITE/kernel/task.c **** 
 784:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 498              		.loc 1 784 0
 499 000a 9B4B     		ldr	r3, .L43
 500 000c 1B68     		ldr	r3, [r3]
 501 000e BB64     		str	r3, [r7, #72]
 785:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_destroy, task_id);
 786:../MQXLITE/kernel/task.c **** 
 787:../MQXLITE/kernel/task.c ****     if (task_id != MQX_NULL_TASK_ID) {
 502              		.loc 1 787 0
 503 0010 7B68     		ldr	r3, [r7, #4]
 504 0012 002B     		cmp	r3, #0
 505 0014 10D0     		beq	.L28
 788:../MQXLITE/kernel/task.c ****         processor = PROC_NUMBER_FROM_TASKID(task_id);
 506              		.loc 1 788 0
 507 0016 7B68     		ldr	r3, [r7, #4]
 508 0018 1A0C     		lsr	r2, r3, #16
 509 001a 3B1C     		mov	r3, r7
 510 001c 4633     		add	r3, r3, #70
 511 001e 1A80     		strh	r2, [r3]
 789:../MQXLITE/kernel/task.c ****         if (processor != (_processor_number)kernel_data->INIT.PROCESSOR_NUMBER ) {
 512              		.loc 1 789 0
 513 0020 BA6C     		ldr	r2, [r7, #72]
 514 0022 A823     		mov	r3, #168
 515 0024 5B00     		lsl	r3, r3, #1
 516 0026 D358     		ldr	r3, [r2, r3]
 517 0028 9BB2     		uxth	r3, r3
 518 002a 3A1C     		mov	r2, r7
 519 002c 4632     		add	r2, r2, #70
 520 002e 1288     		ldrh	r2, [r2]
 521 0030 9A42     		cmp	r2, r3
 522 0032 01D0     		beq	.L28
 790:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 791:../MQXLITE/kernel/task.c ****             if ( kernel_data->IPC != NULL ) {
 792:../MQXLITE/kernel/task.c ****                 _KLOGX2(KLOG_task_destroy, MQX_OK);
 793:../MQXLITE/kernel/task.c ****                 return( (*kernel_data->IPC)(FALSE, processor,
 794:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES, IPC_TASK_DESTROY, 1, (_mqx_uint)task_id) );
 795:../MQXLITE/kernel/task.c ****             } else {
 796:../MQXLITE/kernel/task.c **** #endif
 797:../MQXLITE/kernel/task.c ****                 _KLOGX2(KLOG_task_destroy, MQX_INVALID_TASK_ID);
 798:../MQXLITE/kernel/task.c ****                 return(MQX_INVALID_TASK_ID);
 523              		.loc 1 798 0
 524 0034 1223     		mov	r3, #18
 525 0036 1AE1     		b	.L29
 526              	.L28:
 799:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
 800:../MQXLITE/kernel/task.c ****             } /* Endif */
 801:../MQXLITE/kernel/task.c **** #endif
 802:../MQXLITE/kernel/task.c ****         }/* Endif */
 803:../MQXLITE/kernel/task.c ****     }/* Endif */
 804:../MQXLITE/kernel/task.c **** 
 805:../MQXLITE/kernel/task.c ****     victim_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 527              		.loc 1 805 0
 528 0038 7B68     		ldr	r3, [r7, #4]
 529 003a 181C     		mov	r0, r3
 530 003c FFF7FEFF 		bl	_task_get_td
 531 0040 031C     		mov	r3, r0
 532 0042 3B64     		str	r3, [r7, #64]
 806:../MQXLITE/kernel/task.c **** 
 807:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 808:../MQXLITE/kernel/task.c ****     /* check template for correct user task parameters */
 809:../MQXLITE/kernel/task.c ****     if (user) {
 810:../MQXLITE/kernel/task.c ****         if (!(victim_ptr->FLAGS & MQX_USER_TASK)) {
 811:../MQXLITE/kernel/task.c ****             return MQX_INVALID_TASK_ID;
 812:../MQXLITE/kernel/task.c ****         }
 813:../MQXLITE/kernel/task.c ****     }
 814:../MQXLITE/kernel/task.c **** #endif
 815:../MQXLITE/kernel/task.c **** 
 816:../MQXLITE/kernel/task.c ****     /* Make sure we are not trying to destroy the system task */
 817:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
 818:../MQXLITE/kernel/task.c ****     if ((victim_ptr == NULL) || (victim_ptr == SYSTEM_TD_PTR(kernel_data))) {
 533              		.loc 1 818 0
 534 0044 3B6C     		ldr	r3, [r7, #64]
 535 0046 002B     		cmp	r3, #0
 536 0048 05D0     		beq	.L30
 537              		.loc 1 818 0 is_stmt 0 discriminator 1
 538 004a BB6C     		ldr	r3, [r7, #72]
 539 004c 1A1C     		mov	r2, r3
 540 004e 4832     		add	r2, r2, #72
 541 0050 3B6C     		ldr	r3, [r7, #64]
 542 0052 9A42     		cmp	r2, r3
 543 0054 01D1     		bne	.L31
 544              	.L30:
 819:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_destroy, MQX_INVALID_TASK_ID);
 820:../MQXLITE/kernel/task.c ****         return MQX_INVALID_TASK_ID;
 545              		.loc 1 820 0 is_stmt 1
 546 0056 1223     		mov	r3, #18
 547 0058 09E1     		b	.L29
 548              	.L31:
 821:../MQXLITE/kernel/task.c ****     } /* Endif */
 822:../MQXLITE/kernel/task.c **** #endif
 823:../MQXLITE/kernel/task.c **** 
 824:../MQXLITE/kernel/task.c ****     /* First, serialize task creation/destruction */
 825:../MQXLITE/kernel/task.c ****     _lwsem_wait((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 549              		.loc 1 825 0
 550 005a BB6C     		ldr	r3, [r7, #72]
 551 005c F433     		add	r3, r3, #244
 552 005e 181C     		mov	r0, r3
 553 0060 FFF7FEFF 		bl	_lwsem_wait
 826:../MQXLITE/kernel/task.c **** 
 827:../MQXLITE/kernel/task.c ****     _int_disable();
 554              		.loc 1 827 0
 555 0064 FFF7FEFF 		bl	_int_disable
 828:../MQXLITE/kernel/task.c **** 
 829:../MQXLITE/kernel/task.c ****     if (victim_ptr->STATE == DYING) {
 556              		.loc 1 829 0
 557 0068 3B6C     		ldr	r3, [r7, #64]
 558 006a 9B68     		ldr	r3, [r3, #8]
 559 006c 092B     		cmp	r3, #9
 560 006e 08D1     		bne	.L32
 830:../MQXLITE/kernel/task.c ****         /* Task is already being destroyed */
 831:../MQXLITE/kernel/task.c ****         /* SPR P171-0021-01 re-enable interrupts */
 832:../MQXLITE/kernel/task.c ****         _int_enable();
 561              		.loc 1 832 0
 562 0070 FFF7FEFF 		bl	_int_enable
 833:../MQXLITE/kernel/task.c ****         /* END SPR */
 834:../MQXLITE/kernel/task.c ****         _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 563              		.loc 1 834 0
 564 0074 BB6C     		ldr	r3, [r7, #72]
 565 0076 F433     		add	r3, r3, #244
 566 0078 181C     		mov	r0, r3
 567 007a FFF7FEFF 		bl	_lwsem_post
 835:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_destroy, MQX_OK);
 836:../MQXLITE/kernel/task.c ****         return MQX_OK;
 568              		.loc 1 836 0
 569 007e 0023     		mov	r3, #0
 570 0080 F5E0     		b	.L29
 571              	.L32:
 837:../MQXLITE/kernel/task.c ****     } /* Endif */
 838:../MQXLITE/kernel/task.c **** 
 839:../MQXLITE/kernel/task.c ****     /* remove the victim from any queues it may be in. */
 840:../MQXLITE/kernel/task.c ****     if (victim_ptr->STATE == READY) {
 572              		.loc 1 840 0
 573 0082 3B6C     		ldr	r3, [r7, #64]
 574 0084 9B68     		ldr	r3, [r3, #8]
 575 0086 022B     		cmp	r3, #2
 576 0088 11D1     		bne	.L33
 841:../MQXLITE/kernel/task.c ****         if (victim_ptr != kernel_data->ACTIVE_PTR) {
 577              		.loc 1 841 0
 578 008a BB6C     		ldr	r3, [r7, #72]
 579 008c DA69     		ldr	r2, [r3, #28]
 580 008e 3B6C     		ldr	r3, [r7, #64]
 581 0090 9A42     		cmp	r2, r3
 582 0092 50D0     		beq	.L34
 583              	.LBB5:
 842:../MQXLITE/kernel/task.c ****             /* Remove other task from ready queue */
 843:../MQXLITE/kernel/task.c ****             _QUEUE_UNLINK(victim_ptr);
 584              		.loc 1 843 0
 585 0094 3B6C     		ldr	r3, [r7, #64]
 586 0096 5B68     		ldr	r3, [r3, #4]
 587 0098 FB63     		str	r3, [r7, #60]
 588 009a 3B6C     		ldr	r3, [r7, #64]
 589 009c 1B68     		ldr	r3, [r3]
 590 009e BB63     		str	r3, [r7, #56]
 591 00a0 FB6B     		ldr	r3, [r7, #60]
 592 00a2 BA6B     		ldr	r2, [r7, #56]
 593 00a4 1A60     		str	r2, [r3]
 594 00a6 BB6B     		ldr	r3, [r7, #56]
 595 00a8 FA6B     		ldr	r2, [r7, #60]
 596 00aa 5A60     		str	r2, [r3, #4]
 597 00ac 43E0     		b	.L34
 598              	.L33:
 599              	.LBE5:
 844:../MQXLITE/kernel/task.c ****         } /* Endif */
 845:../MQXLITE/kernel/task.c ****     } else if (victim_ptr->STATE & IS_ON_TIMEOUT_Q) {
 600              		.loc 1 845 0
 601 00ae 3B6C     		ldr	r3, [r7, #64]
 602 00b0 9A68     		ldr	r2, [r3, #8]
 603 00b2 8023     		mov	r3, #128
 604 00b4 5B00     		lsl	r3, r3, #1
 605 00b6 1340     		and	r3, r2
 606 00b8 25D0     		beq	.L35
 846:../MQXLITE/kernel/task.c ****         /* Remove from time queue (uses NEXT, PREV field) */
 847:../MQXLITE/kernel/task.c ****         _TIME_DEQUEUE(victim_ptr, kernel_data);
 607              		.loc 1 847 0
 608 00ba 3B6C     		ldr	r3, [r7, #64]
 609 00bc 9A68     		ldr	r2, [r3, #8]
 610 00be 8023     		mov	r3, #128
 611 00c0 5B00     		lsl	r3, r3, #1
 612 00c2 1340     		and	r3, r2
 613 00c4 37D0     		beq	.L34
 614              	.LBB6:
 615              		.loc 1 847 0 is_stmt 0 discriminator 1
 616 00c6 3B6C     		ldr	r3, [r7, #64]
 617 00c8 5B68     		ldr	r3, [r3, #4]
 618 00ca 7B63     		str	r3, [r7, #52]
 619 00cc 3B6C     		ldr	r3, [r7, #64]
 620 00ce 1B68     		ldr	r3, [r3]
 621 00d0 3B63     		str	r3, [r7, #48]
 622 00d2 7B6B     		ldr	r3, [r7, #52]
 623 00d4 3A6B     		ldr	r2, [r7, #48]
 624 00d6 1A60     		str	r2, [r3]
 625 00d8 3B6B     		ldr	r3, [r7, #48]
 626 00da 7A6B     		ldr	r2, [r7, #52]
 627 00dc 5A60     		str	r2, [r3, #4]
 628              	.LBE6:
 629 00de BB6C     		ldr	r3, [r7, #72]
 630 00e0 2933     		add	r3, r3, #41
 631 00e2 FF33     		add	r3, r3, #255
 632 00e4 1A89     		ldrh	r2, [r3, #8]
 633 00e6 013A     		sub	r2, r2, #1
 634 00e8 92B2     		uxth	r2, r2
 635 00ea 1A81     		strh	r2, [r3, #8]
 636 00ec 3B6C     		ldr	r3, [r7, #64]
 637 00ee 9A68     		ldr	r2, [r3, #8]
 638 00f0 624B     		ldr	r3, .L43+4
 639 00f2 1A40     		and	r2, r3
 640 00f4 3B6C     		ldr	r3, [r7, #64]
 641 00f6 9A60     		str	r2, [r3, #8]
 642 00f8 3B6C     		ldr	r3, [r7, #64]
 643 00fa 9B68     		ldr	r3, [r3, #8]
 644 00fc 0322     		mov	r2, #3
 645 00fe 1A43     		orr	r2, r3
 646 0100 3B6C     		ldr	r3, [r7, #64]
 647 0102 9A60     		str	r2, [r3, #8]
 648 0104 17E0     		b	.L34
 649              	.L35:
 848:../MQXLITE/kernel/task.c ****     } else if (victim_ptr->STATE & TD_IS_ON_QUEUE) {
 650              		.loc 1 848 0 is_stmt 1
 651 0106 3B6C     		ldr	r3, [r7, #64]
 652 0108 9A68     		ldr	r2, [r3, #8]
 653 010a 8023     		mov	r3, #128
 654 010c 9B00     		lsl	r3, r3, #2
 655 010e 1340     		and	r3, r2
 656 0110 11D0     		beq	.L34
 657              	.LBB7:
 849:../MQXLITE/kernel/task.c ****         /*
 850:../MQXLITE/kernel/task.c ****          * Remove from queue, where suspended
 851:../MQXLITE/kernel/task.c ****          * eg, MUTEX_BLOCKED, IO_BLOCKED, TASKQ_BLOCKED
 852:../MQXLITE/kernel/task.c ****          * (uses NEXT, PREV field)
 853:../MQXLITE/kernel/task.c ****          */
 854:../MQXLITE/kernel/task.c ****         _QUEUE_REMOVE(victim_ptr->INFO, victim_ptr);
 658              		.loc 1 854 0
 659 0112 3B6C     		ldr	r3, [r7, #64]
 660 0114 5B68     		ldr	r3, [r3, #4]
 661 0116 FB62     		str	r3, [r7, #44]
 662 0118 3B6C     		ldr	r3, [r7, #64]
 663 011a 1B68     		ldr	r3, [r3]
 664 011c BB62     		str	r3, [r7, #40]
 665 011e FB6A     		ldr	r3, [r7, #44]
 666 0120 BA6A     		ldr	r2, [r7, #40]
 667 0122 1A60     		str	r2, [r3]
 668 0124 BB6A     		ldr	r3, [r7, #40]
 669 0126 FA6A     		ldr	r2, [r7, #44]
 670 0128 5A60     		str	r2, [r3, #4]
 671              	.LBE7:
 672 012a 3B6C     		ldr	r3, [r7, #64]
 673 012c DB6A     		ldr	r3, [r3, #44]
 674 012e 1A89     		ldrh	r2, [r3, #8]
 675 0130 013A     		sub	r2, r2, #1
 676 0132 92B2     		uxth	r2, r2
 677 0134 1A81     		strh	r2, [r3, #8]
 678              	.L34:
 855:../MQXLITE/kernel/task.c ****     } /* Endif */
 856:../MQXLITE/kernel/task.c **** 
 857:../MQXLITE/kernel/task.c ****     if (victim_ptr->STATE & TD_IS_ON_AUX_QUEUE) {
 679              		.loc 1 857 0
 680 0136 3B6C     		ldr	r3, [r7, #64]
 681 0138 9A68     		ldr	r2, [r3, #8]
 682 013a 8023     		mov	r3, #128
 683 013c DB00     		lsl	r3, r3, #3
 684 013e 1340     		and	r3, r2
 685 0140 13D0     		beq	.L36
 686              	.LBB8:
 858:../MQXLITE/kernel/task.c ****         /*
 859:../MQXLITE/kernel/task.c ****          * Remove from queue, where suspended
 860:../MQXLITE/kernel/task.c ****          * eg, LWSEM_BLOCKED
 861:../MQXLITE/kernel/task.c ****          * (uses AUX_QUEUE field)
 862:../MQXLITE/kernel/task.c ****          */
 863:../MQXLITE/kernel/task.c ****         _QUEUE_REMOVE(victim_ptr->INFO, &victim_ptr->AUX_QUEUE);
 687              		.loc 1 863 0
 688 0142 3B6C     		ldr	r3, [r7, #64]
 689 0144 3033     		add	r3, r3, #48
 690 0146 5B68     		ldr	r3, [r3, #4]
 691 0148 7B62     		str	r3, [r7, #36]
 692 014a 3B6C     		ldr	r3, [r7, #64]
 693 014c 3033     		add	r3, r3, #48
 694 014e 1B68     		ldr	r3, [r3]
 695 0150 3B62     		str	r3, [r7, #32]
 696 0152 7B6A     		ldr	r3, [r7, #36]
 697 0154 3A6A     		ldr	r2, [r7, #32]
 698 0156 1A60     		str	r2, [r3]
 699 0158 3B6A     		ldr	r3, [r7, #32]
 700 015a 7A6A     		ldr	r2, [r7, #36]
 701 015c 5A60     		str	r2, [r3, #4]
 702              	.LBE8:
 703 015e 3B6C     		ldr	r3, [r7, #64]
 704 0160 DB6A     		ldr	r3, [r3, #44]
 705 0162 1A89     		ldrh	r2, [r3, #8]
 706 0164 013A     		sub	r2, r2, #1
 707 0166 92B2     		uxth	r2, r2
 708 0168 1A81     		strh	r2, [r3, #8]
 709              	.L36:
 864:../MQXLITE/kernel/task.c ****     } /* Endif */
 865:../MQXLITE/kernel/task.c **** 
 866:../MQXLITE/kernel/task.c ****     victim_ptr->STATE   = DYING;
 710              		.loc 1 866 0
 711 016a 3B6C     		ldr	r3, [r7, #64]
 712 016c 0922     		mov	r2, #9
 713 016e 9A60     		str	r2, [r3, #8]
 867:../MQXLITE/kernel/task.c **** 
 868:../MQXLITE/kernel/task.c **** #if MQXCFG_ENABLE_FP && PSP_HAS_FPU
 869:../MQXLITE/kernel/task.c ****     /* Stop Floating point context monitoring */
 870:../MQXLITE/kernel/task.c ****     if (kernel_data->FP_ACTIVE_PTR == victim_ptr) {
 871:../MQXLITE/kernel/task.c ****         kernel_data->FP_ACTIVE_PTR = NULL;
 872:../MQXLITE/kernel/task.c ****     }/* Endif */
 873:../MQXLITE/kernel/task.c **** #endif
 874:../MQXLITE/kernel/task.c **** 
 875:../MQXLITE/kernel/task.c **** #if MQXCFG_ENABLE_DSP && PSP_HAS_DSP
 876:../MQXLITE/kernel/task.c ****     /* Stop DSP context monitoring */
 877:../MQXLITE/kernel/task.c ****     if (kernel_data->DSP_ACTIVE_PTR == victim_ptr) {
 878:../MQXLITE/kernel/task.c ****         kernel_data->DSP_ACTIVE_PTR = NULL;
 879:../MQXLITE/kernel/task.c ****     }/* Endif */
 880:../MQXLITE/kernel/task.c **** #endif
 881:../MQXLITE/kernel/task.c **** 
 882:../MQXLITE/kernel/task.c ****     _int_enable();
 714              		.loc 1 882 0
 715 0170 FFF7FEFF 		bl	_int_enable
 716              	.LBB9:
 883:../MQXLITE/kernel/task.c **** 
 884:../MQXLITE/kernel/task.c **** #if MQX_COMPONENT_DESTRUCTION
 885:../MQXLITE/kernel/task.c ****     {
 886:../MQXLITE/kernel/task.c ****         _mqx_uint i;
 887:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i) {
 717              		.loc 1 887 0
 718 0174 0023     		mov	r3, #0
 719 0176 FB64     		str	r3, [r7, #76]
 720 0178 11E0     		b	.L37
 721              	.L39:
 888:../MQXLITE/kernel/task.c ****             if (kernel_data->COMPONENT_CLEANUP[i] != NULL) {
 722              		.loc 1 888 0
 723 017a BB6C     		ldr	r3, [r7, #72]
 724 017c FA6C     		ldr	r2, [r7, #76]
 725 017e 7432     		add	r2, r2, #116
 726 0180 9200     		lsl	r2, r2, #2
 727 0182 D358     		ldr	r3, [r2, r3]
 728 0184 002B     		cmp	r3, #0
 729 0186 07D0     		beq	.L38
 889:../MQXLITE/kernel/task.c ****                 (*kernel_data->COMPONENT_CLEANUP[i])(victim_ptr);
 730              		.loc 1 889 0
 731 0188 BB6C     		ldr	r3, [r7, #72]
 732 018a FA6C     		ldr	r2, [r7, #76]
 733 018c 7432     		add	r2, r2, #116
 734 018e 9200     		lsl	r2, r2, #2
 735 0190 D358     		ldr	r3, [r2, r3]
 736 0192 3A6C     		ldr	r2, [r7, #64]
 737 0194 101C     		mov	r0, r2
 738 0196 9847     		blx	r3
 739              	.L38:
 887:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i) {
 740              		.loc 1 887 0
 741 0198 FB6C     		ldr	r3, [r7, #76]
 742 019a 0133     		add	r3, r3, #1
 743 019c FB64     		str	r3, [r7, #76]
 744              	.L37:
 887:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i) {
 745              		.loc 1 887 0 is_stmt 0 discriminator 1
 746 019e FB6C     		ldr	r3, [r7, #76]
 747 01a0 0F2B     		cmp	r3, #15
 748 01a2 EAD9     		bls	.L39
 749              	.LBE9:
 890:../MQXLITE/kernel/task.c ****             } /* Endif */
 891:../MQXLITE/kernel/task.c ****         } /* Endfor */
 892:../MQXLITE/kernel/task.c ****     }
 893:../MQXLITE/kernel/task.c **** #endif
 894:../MQXLITE/kernel/task.c **** 
 895:../MQXLITE/kernel/task.c **** 
 896:../MQXLITE/kernel/task.c ****     /* Save the task number */
 897:../MQXLITE/kernel/task.c ****     task_num = TASK_NUMBER_FROM_TASKID(victim_ptr->TASK_ID);
 750              		.loc 1 897 0 is_stmt 1
 751 01a4 3B6C     		ldr	r3, [r7, #64]
 752 01a6 DA68     		ldr	r2, [r3, #12]
 753 01a8 3B1C     		mov	r3, r7
 754 01aa 1E33     		add	r3, r3, #30
 755 01ac 1A80     		strh	r2, [r3]
 898:../MQXLITE/kernel/task.c **** 
 899:../MQXLITE/kernel/task.c ****     td_ptr = kernel_data->ACTIVE_PTR;
 756              		.loc 1 899 0
 757 01ae BB6C     		ldr	r3, [r7, #72]
 758 01b0 DB69     		ldr	r3, [r3, #28]
 759 01b2 BB61     		str	r3, [r7, #24]
 900:../MQXLITE/kernel/task.c **** 
 901:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
 902:../MQXLITE/kernel/task.c ****     if ((victim_ptr->FLAGS & TASK_STACK_PREALLOCATED) == 0) {
 903:../MQXLITE/kernel/task.c ****         pointer block_ptr = _mem_get_next_block_internal(victim_ptr, NULL);
 904:../MQXLITE/kernel/task.c ****         while (block_ptr != NULL) {
 905:../MQXLITE/kernel/task.c ****             pointer next_block_ptr = _mem_get_next_block_internal(victim_ptr, block_ptr);
 906:../MQXLITE/kernel/task.c ****             if (td_ptr != victim_ptr) {
 907:../MQXLITE/kernel/task.c ****                 _mem_transfer_internal(block_ptr, SYSTEM_TD_PTR(kernel_data));
 908:../MQXLITE/kernel/task.c ****             } /* Endif */
 909:../MQXLITE/kernel/task.c ****             if (block_ptr != victim_ptr) {
 910:../MQXLITE/kernel/task.c ****                 _mem_free(block_ptr);
 911:../MQXLITE/kernel/task.c ****             } /* Endif */
 912:../MQXLITE/kernel/task.c ****             block_ptr = next_block_ptr;
 913:../MQXLITE/kernel/task.c ****         } /* Endwhile */
 914:../MQXLITE/kernel/task.c ****     } /* Endif */
 915:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
 916:../MQXLITE/kernel/task.c **** 
 917:../MQXLITE/kernel/task.c ****     victim_ptr->TASK_ID = TASK_ID_DYING;
 760              		.loc 1 917 0
 761 01b4 3B6C     		ldr	r3, [r7, #64]
 762 01b6 8022     		mov	r2, #128
 763 01b8 1206     		lsl	r2, r2, #24
 764 01ba DA60     		str	r2, [r3, #12]
 918:../MQXLITE/kernel/task.c **** 
 919:../MQXLITE/kernel/task.c ****     /* Start SPR P171-0017-01                */
 920:../MQXLITE/kernel/task.c ****     /* Remove td from linked list of all tds */
 921:../MQXLITE/kernel/task.c ****     if (_QUEUE_GET_SIZE(&kernel_data->TD_LIST) == 1) {
 765              		.loc 1 921 0
 766 01bc BB6C     		ldr	r3, [r7, #72]
 767 01be C833     		add	r3, r3, #200
 768 01c0 1B89     		ldrh	r3, [r3, #8]
 769 01c2 012B     		cmp	r3, #1
 770 01c4 08D1     		bne	.L40
 922:../MQXLITE/kernel/task.c ****         /* Destroying the last task */
 923:../MQXLITE/kernel/task.c ****         kernel_data->TASK_NUMBER   = 1;
 771              		.loc 1 923 0
 772 01c6 BA6C     		ldr	r2, [r7, #72]
 773 01c8 D423     		mov	r3, #212
 774 01ca 0121     		mov	r1, #1
 775 01cc D150     		str	r1, [r2, r3]
 924:../MQXLITE/kernel/task.c ****         kernel_data->INSERT_TD_PTR = NULL;
 776              		.loc 1 924 0
 777 01ce BA6C     		ldr	r2, [r7, #72]
 778 01d0 D823     		mov	r3, #216
 779 01d2 0021     		mov	r1, #0
 780 01d4 D150     		str	r1, [r2, r3]
 781 01d6 14E0     		b	.L41
 782              	.L40:
 925:../MQXLITE/kernel/task.c ****     } else if (kernel_data->TASK_NUMBER > task_num) {
 783              		.loc 1 925 0
 784 01d8 BA6C     		ldr	r2, [r7, #72]
 785 01da D423     		mov	r3, #212
 786 01dc D258     		ldr	r2, [r2, r3]
 787 01de 3B1C     		mov	r3, r7
 788 01e0 1E33     		add	r3, r3, #30
 789 01e2 1B88     		ldrh	r3, [r3]
 790 01e4 9A42     		cmp	r2, r3
 791 01e6 0CD9     		bls	.L41
 926:../MQXLITE/kernel/task.c ****         kernel_data->TASK_NUMBER   = task_num;
 792              		.loc 1 926 0
 793 01e8 3B1C     		mov	r3, r7
 794 01ea 1E33     		add	r3, r3, #30
 795 01ec 1988     		ldrh	r1, [r3]
 796 01ee BA6C     		ldr	r2, [r7, #72]
 797 01f0 D423     		mov	r3, #212
 798 01f2 D150     		str	r1, [r2, r3]
 927:../MQXLITE/kernel/task.c ****         kernel_data->INSERT_TD_PTR =
 928:../MQXLITE/kernel/task.c ****                         (TD_STRUCT_PTR)((uchar_ptr)victim_ptr->TD_LIST_INFO.PREV -
 799              		.loc 1 928 0
 800 01f4 3B6C     		ldr	r3, [r7, #64]
 801 01f6 1B6E     		ldr	r3, [r3, #96]
 802 01f8 191C     		mov	r1, r3
 803 01fa 5C39     		sub	r1, r1, #92
 927:../MQXLITE/kernel/task.c ****         kernel_data->INSERT_TD_PTR =
 804              		.loc 1 927 0
 805 01fc BA6C     		ldr	r2, [r7, #72]
 806 01fe D823     		mov	r3, #216
 807 0200 D150     		str	r1, [r2, r3]
 808              	.L41:
 809              	.LBB10:
 929:../MQXLITE/kernel/task.c ****                                         FIELD_OFFSET(TD_STRUCT,TD_LIST_INFO));
 930:../MQXLITE/kernel/task.c ****     } /* Endif */
 931:../MQXLITE/kernel/task.c ****     _QUEUE_REMOVE(&kernel_data->TD_LIST, &victim_ptr->TD_LIST_INFO);
 810              		.loc 1 931 0
 811 0202 3B6C     		ldr	r3, [r7, #64]
 812 0204 5C33     		add	r3, r3, #92
 813 0206 5B68     		ldr	r3, [r3, #4]
 814 0208 7B61     		str	r3, [r7, #20]
 815 020a 3B6C     		ldr	r3, [r7, #64]
 816 020c 5C33     		add	r3, r3, #92
 817 020e 1B68     		ldr	r3, [r3]
 818 0210 3B61     		str	r3, [r7, #16]
 819 0212 7B69     		ldr	r3, [r7, #20]
 820 0214 3A69     		ldr	r2, [r7, #16]
 821 0216 1A60     		str	r2, [r3]
 822 0218 3B69     		ldr	r3, [r7, #16]
 823 021a 7A69     		ldr	r2, [r7, #20]
 824 021c 5A60     		str	r2, [r3, #4]
 825              	.LBE10:
 826 021e BB6C     		ldr	r3, [r7, #72]
 827 0220 C833     		add	r3, r3, #200
 828 0222 1A89     		ldrh	r2, [r3, #8]
 829 0224 013A     		sub	r2, r2, #1
 830 0226 92B2     		uxth	r2, r2
 831 0228 1A81     		strh	r2, [r3, #8]
 932:../MQXLITE/kernel/task.c ****     /* End SPR P171-0017-01                  */
 933:../MQXLITE/kernel/task.c **** 
 934:../MQXLITE/kernel/task.c ****     /* Free up create/destroy for other tasks */
 935:../MQXLITE/kernel/task.c ****     _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 832              		.loc 1 935 0
 833 022a BB6C     		ldr	r3, [r7, #72]
 834 022c F433     		add	r3, r3, #244
 835 022e 181C     		mov	r0, r3
 836 0230 FFF7FEFF 		bl	_lwsem_post
 936:../MQXLITE/kernel/task.c **** 
 937:../MQXLITE/kernel/task.c ****     if (victim_ptr == td_ptr) {
 837              		.loc 1 937 0
 838 0234 3A6C     		ldr	r2, [r7, #64]
 839 0236 BB69     		ldr	r3, [r7, #24]
 840 0238 9A42     		cmp	r2, r3
 841 023a 13D1     		bne	.L42
 938:../MQXLITE/kernel/task.c ****         /* We are destroying the current task */
 939:../MQXLITE/kernel/task.c ****         _int_disable();
 842              		.loc 1 939 0
 843 023c FFF7FEFF 		bl	_int_disable
 844              	.LBB11:
 940:../MQXLITE/kernel/task.c ****         _QUEUE_UNLINK(victim_ptr);  /* Remove myself from the ready queue */
 845              		.loc 1 940 0
 846 0240 3B6C     		ldr	r3, [r7, #64]
 847 0242 5B68     		ldr	r3, [r3, #4]
 848 0244 FB60     		str	r3, [r7, #12]
 849 0246 3B6C     		ldr	r3, [r7, #64]
 850 0248 1B68     		ldr	r3, [r3]
 851 024a BB60     		str	r3, [r7, #8]
 852 024c FB68     		ldr	r3, [r7, #12]
 853 024e BA68     		ldr	r2, [r7, #8]
 854 0250 1A60     		str	r2, [r3]
 855 0252 BB68     		ldr	r3, [r7, #8]
 856 0254 FA68     		ldr	r2, [r7, #12]
 857 0256 5A60     		str	r2, [r3, #4]
 858              	.LBE11:
 941:../MQXLITE/kernel/task.c ****         _psp_destroy_stack_frame(victim_ptr);
 859              		.loc 1 941 0
 860 0258 3B6C     		ldr	r3, [r7, #64]
 861 025a 181C     		mov	r0, r3
 862 025c FFF7FEFF 		bl	_psp_destroy_stack_frame
 942:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
 943:../MQXLITE/kernel/task.c ****         if ((victim_ptr->FLAGS & TASK_STACK_PREALLOCATED) == 0) {
 944:../MQXLITE/kernel/task.c ****             _mem_transfer_internal(victim_ptr, SYSTEM_TD_PTR(kernel_data));
 945:../MQXLITE/kernel/task.c ****             _mem_free(victim_ptr);   /* Free the td which includes task's stack! */
 946:../MQXLITE/kernel/task.c ****         } /* Endif */
 947:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
 948:../MQXLITE/kernel/task.c ****         /* Now we must jump to the scheduler */
 949:../MQXLITE/kernel/task.c ****         _sched_run_internal();   /* WILL NEVER RETURN FROM HERE */
 863              		.loc 1 949 0
 864 0260 FFF7FEFF 		bl	_sched_run_internal
 865              	.L42:
 950:../MQXLITE/kernel/task.c ****     }/* Endif */
 951:../MQXLITE/kernel/task.c **** 
 952:../MQXLITE/kernel/task.c ****     _psp_destroy_stack_frame(victim_ptr);
 866              		.loc 1 952 0
 867 0264 3B6C     		ldr	r3, [r7, #64]
 868 0266 181C     		mov	r0, r3
 869 0268 FFF7FEFF 		bl	_psp_destroy_stack_frame
 953:../MQXLITE/kernel/task.c **** 
 954:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
 955:../MQXLITE/kernel/task.c ****     /* Free the task descriptor. */
 956:../MQXLITE/kernel/task.c ****     if ((victim_ptr->FLAGS & TASK_STACK_PREALLOCATED) == 0) {
 957:../MQXLITE/kernel/task.c ****         _mem_free(victim_ptr);
 958:../MQXLITE/kernel/task.c ****     } /* Endif */
 959:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
 960:../MQXLITE/kernel/task.c **** 
 961:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
 962:../MQXLITE/kernel/task.c ****     if (victim_ptr->FLAGS & MQX_USER_TASK) {
 963:../MQXLITE/kernel/task.c ****         _int_disable();
 964:../MQXLITE/kernel/task.c ****         kernel_data->USR_TASK_RUN_COUNT--;
 965:../MQXLITE/kernel/task.c ****         _int_enable();
 966:../MQXLITE/kernel/task.c ****     }
 967:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
 968:../MQXLITE/kernel/task.c **** 
 969:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_destroy, MQX_OK);
 970:../MQXLITE/kernel/task.c ****     return(MQX_OK);
 870              		.loc 1 970 0
 871 026c 0023     		mov	r3, #0
 872              	.L29:
 971:../MQXLITE/kernel/task.c **** 
 972:../MQXLITE/kernel/task.c **** }
 873              		.loc 1 972 0
 874 026e 181C     		mov	r0, r3
 875 0270 BD46     		mov	sp, r7
 876 0272 14B0     		add	sp, sp, #80
 877              		@ sp needed for prologue
 878 0274 80BD     		pop	{r7, pc}
 879              	.L44:
 880 0276 C046     		.align	2
 881              	.L43:
 882 0278 00000000 		.word	_mqx_kernel_data
 883 027c FFFEFFFF 		.word	-257
 884              		.cfi_endproc
 885              	.LFE3:
 887              		.section	.text._task_destroy,"ax",%progbits
 888              		.align	2
 889              		.global	_task_destroy
 890              		.code	16
 891              		.thumb_func
 893              	_task_destroy:
 894              	.LFB4:
 973:../MQXLITE/kernel/task.c **** 
 974:../MQXLITE/kernel/task.c **** /*!
 975:../MQXLITE/kernel/task.c ****  * \brief Destroys the task.
 976:../MQXLITE/kernel/task.c ****  *
 977:../MQXLITE/kernel/task.c ****  * This function does the following for the task being destroyed:
 978:../MQXLITE/kernel/task.c ****  * \n - Frees memory resources that the task allocated with functions from the
 979:../MQXLITE/kernel/task.c ****  * _mem and _partition families.
 980:../MQXLITE/kernel/task.c ****  * \n - Closes all queues that the task owns and frees all the queue elements.
 981:../MQXLITE/kernel/task.c ****  * \n - Frees any other component resources that the task owns.
 982:../MQXLITE/kernel/task.c ****  *
 983:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of the following:
 984:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task to be destroyed.
 985:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Destroy the calling task.)
 986:../MQXLITE/kernel/task.c ****  *
 987:../MQXLITE/kernel/task.c ****  * \return MQX_OK
 988:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID
 989:../MQXLITE/kernel/task.c ****  *
 990:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is remote, blocks the calling task until
 991:../MQXLITE/kernel/task.c ****  * the task is destroyed.
 992:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is local, does not block the calling task.
 993:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is the active task, blocks it.
 994:../MQXLITE/kernel/task.c ****  *
 995:../MQXLITE/kernel/task.c ****  * \see _task_create
 996:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
 997:../MQXLITE/kernel/task.c ****  * \see _task_create_at
 998:../MQXLITE/kernel/task.c ****  * \see _task_get_creator
 999:../MQXLITE/kernel/task.c ****  * \see _task_get_id
1000:../MQXLITE/kernel/task.c ****  * \see _task_abort
1001:../MQXLITE/kernel/task.c ****  */
1002:../MQXLITE/kernel/task.c **** _mqx_uint _task_destroy
1003:../MQXLITE/kernel/task.c **** (
1004:../MQXLITE/kernel/task.c ****     _task_id task_id
1005:../MQXLITE/kernel/task.c **** )
1006:../MQXLITE/kernel/task.c **** {
 895              		.loc 1 1006 0
 896              		.cfi_startproc
 897 0000 80B5     		push	{r7, lr}
 898              	.LCFI12:
 899              		.cfi_def_cfa_offset 8
 900              		.cfi_offset 7, -8
 901              		.cfi_offset 14, -4
 902 0002 82B0     		sub	sp, sp, #8
 903              	.LCFI13:
 904              		.cfi_def_cfa_offset 16
 905 0004 00AF     		add	r7, sp, #0
 906              	.LCFI14:
 907              		.cfi_def_cfa_register 7
 908 0006 7860     		str	r0, [r7, #4]
1007:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE && MQX_ENABLE_USER_STDAPI
1008:../MQXLITE/kernel/task.c ****     if (MQX_RUN_IN_USER_MODE)
1009:../MQXLITE/kernel/task.c ****     {
1010:../MQXLITE/kernel/task.c ****         return _usr_task_destroy(task_id);
1011:../MQXLITE/kernel/task.c ****     }
1012:../MQXLITE/kernel/task.c **** #endif
1013:../MQXLITE/kernel/task.c **** 
1014:../MQXLITE/kernel/task.c ****     return _task_destroy_internal(task_id, FALSE);
 909              		.loc 1 1014 0
 910 0008 7B68     		ldr	r3, [r7, #4]
 911 000a 181C     		mov	r0, r3
 912 000c 0021     		mov	r1, #0
 913 000e FFF7FEFF 		bl	_task_destroy_internal
 914 0012 031C     		mov	r3, r0
1015:../MQXLITE/kernel/task.c **** }
 915              		.loc 1 1015 0
 916 0014 181C     		mov	r0, r3
 917 0016 BD46     		mov	sp, r7
 918 0018 02B0     		add	sp, sp, #8
 919              		@ sp needed for prologue
 920 001a 80BD     		pop	{r7, pc}
 921              		.cfi_endproc
 922              	.LFE4:
 924              		.section	.text._task_get_exception_handler,"ax",%progbits
 925              		.align	2
 926              		.global	_task_get_exception_handler
 927              		.code	16
 928              		.thumb_func
 930              	_task_get_exception_handler:
 931              	.LFB5:
1016:../MQXLITE/kernel/task.c **** 
1017:../MQXLITE/kernel/task.c **** 
1018:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
1019:../MQXLITE/kernel/task.c **** /*!
1020:../MQXLITE/kernel/task.c ****  * \brief Destroys the task.
1021:../MQXLITE/kernel/task.c ****  *
1022:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_destroy() API call but it can be
1023:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
1024:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
1025:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
1026:../MQXLITE/kernel/task.c ****  *
1027:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of the following:
1028:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task to be destroyed.
1029:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Destroy the calling task.)
1030:../MQXLITE/kernel/task.c ****  *
1031:../MQXLITE/kernel/task.c ****  * \return MQX_OK
1032:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID
1033:../MQXLITE/kernel/task.c ****  *
1034:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is remote, blocks the calling task until
1035:../MQXLITE/kernel/task.c ****  * the task is destroyed.
1036:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is local, does not block the calling task.
1037:../MQXLITE/kernel/task.c ****  * \warning If the task being destroyed is the active task, blocks it.
1038:../MQXLITE/kernel/task.c ****  *
1039:../MQXLITE/kernel/task.c ****  * \see _task_destroy
1040:../MQXLITE/kernel/task.c ****  * \see _usr_task_create
1041:../MQXLITE/kernel/task.c ****  * \see _usr_task_abort
1042:../MQXLITE/kernel/task.c ****  */
1043:../MQXLITE/kernel/task.c **** _mqx_uint _usr_task_destroy
1044:../MQXLITE/kernel/task.c **** (
1045:../MQXLITE/kernel/task.c ****     _task_id task_id
1046:../MQXLITE/kernel/task.c **** )
1047:../MQXLITE/kernel/task.c **** {
1048:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params = {(uint_32)task_id, 0, 0, 0, 0};
1049:../MQXLITE/kernel/task.c ****     return _mqx_api_call(MQX_API_TASK_DESTROY, &params);
1050:../MQXLITE/kernel/task.c **** }
1051:../MQXLITE/kernel/task.c **** 
1052:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
1053:../MQXLITE/kernel/task.c **** 
1054:../MQXLITE/kernel/task.c **** #if MQXCFG_ENABLE_FP && PSP_HAS_FPU
1055:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
1056:../MQXLITE/kernel/task.c **** 
1057:../MQXLITE/kernel/task.c **** /*!
1058:../MQXLITE/kernel/task.c ****  * \brief Enables floating-point context switching for the active task.
1059:../MQXLITE/kernel/task.c ****  *
1060:../MQXLITE/kernel/task.c ****  * When MQX performs a context switch (due to _task_enable_fp call), floating-point
1061:../MQXLITE/kernel/task.c ****  * registers are saved and restored. Otherwise ( _task_disable_fp call) floating-point
1062:../MQXLITE/kernel/task.c ****  * registers are not saved and restored.
1063:../MQXLITE/kernel/task.c ****  *
1064:../MQXLITE/kernel/task.c ****  * \warning Changes context information that MQX stores.
1065:../MQXLITE/kernel/task.c ****  *
1066:../MQXLITE/kernel/task.c ****  * \see _task_disable_fp
1067:../MQXLITE/kernel/task.c ****  */
1068:../MQXLITE/kernel/task.c **** boolean _task_enable_fp(void)
1069:../MQXLITE/kernel/task.c **** {
1070:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
1071:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr;
1072:../MQXLITE/kernel/task.c ****     boolean res = TRUE;
1073:../MQXLITE/kernel/task.c **** 
1074:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
1075:../MQXLITE/kernel/task.c ****     _KLOGE1(KLOG_task_enable_fp);
1076:../MQXLITE/kernel/task.c **** 
1077:../MQXLITE/kernel/task.c ****     td_ptr = kernel_data->ACTIVE_PTR;
1078:../MQXLITE/kernel/task.c ****     _int_disable();
1079:../MQXLITE/kernel/task.c **** 
1080:../MQXLITE/kernel/task.c ****     if (NULL == td_ptr->FLOAT_CONTEXT_PTR)
1081:../MQXLITE/kernel/task.c ****     {
1082:../MQXLITE/kernel/task.c ****         /* we dont have allocated space for fp context... try allocate it */
1083:../MQXLITE/kernel/task.c ****         _psp_build_float_context(td_ptr);
1084:../MQXLITE/kernel/task.c ****     }
1085:../MQXLITE/kernel/task.c **** 
1086:../MQXLITE/kernel/task.c ****     if (NULL != td_ptr->FLOAT_CONTEXT_PTR)
1087:../MQXLITE/kernel/task.c ****     {
1088:../MQXLITE/kernel/task.c ****         /* we have allocated space for fp context */
1089:../MQXLITE/kernel/task.c ****         td_ptr->FLAGS |= MQX_FLOATING_POINT_TASK;
1090:../MQXLITE/kernel/task.c ****         if (kernel_data->FP_ACTIVE_PTR != NULL)
1091:../MQXLITE/kernel/task.c ****         {
1092:../MQXLITE/kernel/task.c ****             if (kernel_data->FP_ACTIVE_PTR != kernel_data->ACTIVE_PTR)
1093:../MQXLITE/kernel/task.c ****             {
1094:../MQXLITE/kernel/task.c ****                 _psp_save_fp_context_internal();
1095:../MQXLITE/kernel/task.c ****             }
1096:../MQXLITE/kernel/task.c ****         }
1097:../MQXLITE/kernel/task.c ****         kernel_data->FP_ACTIVE_PTR = kernel_data->ACTIVE_PTR;
1098:../MQXLITE/kernel/task.c ****     }
1099:../MQXLITE/kernel/task.c ****     else
1100:../MQXLITE/kernel/task.c ****     {
1101:../MQXLITE/kernel/task.c ****         /* some problem - TD dont have allocated space for fp context */
1102:../MQXLITE/kernel/task.c ****         res = FALSE;
1103:../MQXLITE/kernel/task.c ****     }
1104:../MQXLITE/kernel/task.c **** 
1105:../MQXLITE/kernel/task.c ****     _int_enable();
1106:../MQXLITE/kernel/task.c ****     _KLOGX1(KLOG_task_enable_fp);
1107:../MQXLITE/kernel/task.c **** 
1108:../MQXLITE/kernel/task.c ****     return res;
1109:../MQXLITE/kernel/task.c **** }
1110:../MQXLITE/kernel/task.c **** 
1111:../MQXLITE/kernel/task.c **** /*!
1112:../MQXLITE/kernel/task.c ****  * \brief Disables floating-point context switching for the active task if the
1113:../MQXLITE/kernel/task.c ****  * task is a floating-point task.
1114:../MQXLITE/kernel/task.c ****  *
1115:../MQXLITE/kernel/task.c ****  * When MQX performs a context switch (due to _task_enable_fp call), floating-point
1116:../MQXLITE/kernel/task.c ****  * registers are saved and restored. Otherwise ( _task_disable_fp call) floating-point
1117:../MQXLITE/kernel/task.c ****  * registers are not saved and restored.
1118:../MQXLITE/kernel/task.c ****  *
1119:../MQXLITE/kernel/task.c ****  * \warning Changes context information that MQX stores.
1120:../MQXLITE/kernel/task.c ****  *
1121:../MQXLITE/kernel/task.c ****  * \see _task_enable_fp
1122:../MQXLITE/kernel/task.c ****  */
1123:../MQXLITE/kernel/task.c **** void _task_disable_fp(void)
1124:../MQXLITE/kernel/task.c **** { /* Body */
1125:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
1126:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR                   td_ptr;
1127:../MQXLITE/kernel/task.c **** 
1128:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
1129:../MQXLITE/kernel/task.c ****     _KLOGE1(KLOG_task_disable_fp);
1130:../MQXLITE/kernel/task.c **** 
1131:../MQXLITE/kernel/task.c ****     td_ptr = kernel_data->ACTIVE_PTR;
1132:../MQXLITE/kernel/task.c ****     _int_disable();
1133:../MQXLITE/kernel/task.c ****     if (td_ptr->FLAGS & MQX_FLOATING_POINT_TASK)
1134:../MQXLITE/kernel/task.c ****     {
1135:../MQXLITE/kernel/task.c ****         td_ptr->FLAGS &= ~MQX_FLOATING_POINT_TASK;
1136:../MQXLITE/kernel/task.c ****         kernel_data->FP_ACTIVE_PTR = NULL;
1137:../MQXLITE/kernel/task.c ****     }
1138:../MQXLITE/kernel/task.c **** 
1139:../MQXLITE/kernel/task.c ****     if (NULL != td_ptr->FLOAT_CONTEXT_PTR)
1140:../MQXLITE/kernel/task.c ****     {
1141:../MQXLITE/kernel/task.c ****         /* deallocate fp context area */
1142:../MQXLITE/kernel/task.c ****         _mem_free(td_ptr->FLOAT_CONTEXT_PTR);
1143:../MQXLITE/kernel/task.c ****         td_ptr->FLOAT_CONTEXT_PTR = NULL;
1144:../MQXLITE/kernel/task.c ****     }
1145:../MQXLITE/kernel/task.c **** 
1146:../MQXLITE/kernel/task.c ****     _int_enable();
1147:../MQXLITE/kernel/task.c ****     _KLOGX1(KLOG_task_disable_fp);
1148:../MQXLITE/kernel/task.c **** 
1149:../MQXLITE/kernel/task.c **** } /* Endbody */
1150:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
1151:../MQXLITE/kernel/task.c **** #endif /* MQXCFG_ENABLE_FP && PSP_HAS_FPU */
1152:../MQXLITE/kernel/task.c **** 
1153:../MQXLITE/kernel/task.c **** #if MQX_HAS_TASK_ENVIRONMENT
1154:../MQXLITE/kernel/task.c **** 
1155:../MQXLITE/kernel/task.c **** /*!
1156:../MQXLITE/kernel/task.c ****  * \brief Sets the address of the application-specific environment data for the task.
1157:../MQXLITE/kernel/task.c ****  *
1158:../MQXLITE/kernel/task.c ****  * \param[in] task_id         Task ID of the task whose environment is to be set.
1159:../MQXLITE/kernel/task.c ****  * \param[in] environment_ptr Pointer to the environment data.
1160:../MQXLITE/kernel/task.c ****  *
1161:../MQXLITE/kernel/task.c ****  * \return Previous environment data (Success.)
1162:../MQXLITE/kernel/task.c ****  * \return NULL (Failure.)
1163:../MQXLITE/kernel/task.c ****  *
1164:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1165:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1166:../MQXLITE/kernel/task.c ****  *
1167:../MQXLITE/kernel/task.c ****  * \see _task_get_environment
1168:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1169:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1170:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1171:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1172:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1173:../MQXLITE/kernel/task.c ****  */
1174:../MQXLITE/kernel/task.c **** pointer _task_set_environment
1175:../MQXLITE/kernel/task.c **** (
1176:../MQXLITE/kernel/task.c ****     _task_id    task_id,
1177:../MQXLITE/kernel/task.c ****     pointer     environment_ptr
1178:../MQXLITE/kernel/task.c **** )
1179:../MQXLITE/kernel/task.c **** { /* Body */
1180:../MQXLITE/kernel/task.c ****     _KLOGM(KERNEL_DATA_STRUCT_PTR kernel_data;)
1181:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr;
1182:../MQXLITE/kernel/task.c ****     pointer       old_env_ptr;
1183:../MQXLITE/kernel/task.c **** 
1184:../MQXLITE/kernel/task.c ****     _KLOGM(_GET_KERNEL_DATA(kernel_data);)
1185:../MQXLITE/kernel/task.c ****     _KLOGE3(KLOG_task_set_environment, task_id, environment_ptr);
1186:../MQXLITE/kernel/task.c **** 
1187:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR) _task_get_td(task_id);
1188:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
1189:../MQXLITE/kernel/task.c ****     {
1190:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
1191:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_set_environment, NULL);
1192:../MQXLITE/kernel/task.c ****         return (NULL);
1193:../MQXLITE/kernel/task.c ****     }/* Endif */
1194:../MQXLITE/kernel/task.c **** 
1195:../MQXLITE/kernel/task.c ****     old_env_ptr = td_ptr->ENVIRONMENT_PTR;
1196:../MQXLITE/kernel/task.c ****     td_ptr->ENVIRONMENT_PTR = environment_ptr;
1197:../MQXLITE/kernel/task.c **** 
1198:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_environment, old_env_ptr);
1199:../MQXLITE/kernel/task.c ****     return (old_env_ptr);
1200:../MQXLITE/kernel/task.c **** 
1201:../MQXLITE/kernel/task.c **** } /* Endbody */
1202:../MQXLITE/kernel/task.c **** 
1203:../MQXLITE/kernel/task.c **** /*!
1204:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the application-specific environment data for the task.
1205:../MQXLITE/kernel/task.c ****  *
1206:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID of the task whose environment is to be obtained.
1207:../MQXLITE/kernel/task.c ****  *
1208:../MQXLITE/kernel/task.c ****  * \return Environment data (Success.)
1209:../MQXLITE/kernel/task.c ****  * \return NULL (Failure.)
1210:../MQXLITE/kernel/task.c ****  *
1211:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1212:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1213:../MQXLITE/kernel/task.c ****  *
1214:../MQXLITE/kernel/task.c ****  * \see _task_set_environment
1215:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1216:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1217:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1218:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1219:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1220:../MQXLITE/kernel/task.c ****  */
1221:../MQXLITE/kernel/task.c **** pointer _task_get_environment
1222:../MQXLITE/kernel/task.c **** (
1223:../MQXLITE/kernel/task.c ****     _task_id task_id
1224:../MQXLITE/kernel/task.c **** )
1225:../MQXLITE/kernel/task.c **** { /* Body */
1226:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr;
1227:../MQXLITE/kernel/task.c **** 
1228:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR) _task_get_td(task_id);
1229:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
1230:../MQXLITE/kernel/task.c ****     {
1231:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
1232:../MQXLITE/kernel/task.c ****         return (NULL);
1233:../MQXLITE/kernel/task.c ****     }/* Endif */
1234:../MQXLITE/kernel/task.c **** 
1235:../MQXLITE/kernel/task.c ****     return (td_ptr->ENVIRONMENT_PTR);
1236:../MQXLITE/kernel/task.c **** 
1237:../MQXLITE/kernel/task.c **** } /* Endbody */
1238:../MQXLITE/kernel/task.c **** 
1239:../MQXLITE/kernel/task.c **** #endif /* MQX_HAS_TASK_ENVIRONMENT */
1240:../MQXLITE/kernel/task.c **** 
1241:../MQXLITE/kernel/task.c **** #if MQX_HAS_EXCEPTION_HANDLER
1242:../MQXLITE/kernel/task.c **** 
1243:../MQXLITE/kernel/task.c **** /*!
1244:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the task exception handler.
1245:../MQXLITE/kernel/task.c ****  *
1246:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID of the task whose exception handler is to be obtained.
1247:../MQXLITE/kernel/task.c ****  *
1248:../MQXLITE/kernel/task.c ****  * \return Pointer to the task exception handler for the task (might be NULL).
1249:../MQXLITE/kernel/task.c ****  * \return NULL (Task ID is not valid.)
1250:../MQXLITE/kernel/task.c ****  *
1251:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1252:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1253:../MQXLITE/kernel/task.c ****  *
1254:../MQXLITE/kernel/task.c ****  * \see _task_set_exception_handler
1255:../MQXLITE/kernel/task.c ****  * \see _task_get_exit_handler
1256:../MQXLITE/kernel/task.c ****  * \see _task_set_exit_handler
1257:../MQXLITE/kernel/task.c ****  * \see _int_exception_isr
1258:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1259:../MQXLITE/kernel/task.c ****  */
1260:../MQXLITE/kernel/task.c **** TASK_EXCEPTION_FPTR _task_get_exception_handler
1261:../MQXLITE/kernel/task.c **** (
1262:../MQXLITE/kernel/task.c ****     _task_id        task_id
1263:../MQXLITE/kernel/task.c **** )
1264:../MQXLITE/kernel/task.c **** { /* Body */
 932              		.loc 1 1264 0
 933              		.cfi_startproc
 934 0000 80B5     		push	{r7, lr}
 935              	.LCFI15:
 936              		.cfi_def_cfa_offset 8
 937              		.cfi_offset 7, -8
 938              		.cfi_offset 14, -4
 939 0002 84B0     		sub	sp, sp, #16
 940              	.LCFI16:
 941              		.cfi_def_cfa_offset 24
 942 0004 00AF     		add	r7, sp, #0
 943              	.LCFI17:
 944              		.cfi_def_cfa_register 7
 945 0006 7860     		str	r0, [r7, #4]
1265:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR       td_ptr;
1266:../MQXLITE/kernel/task.c ****     TASK_EXCEPTION_FPTR excpt_function;
1267:../MQXLITE/kernel/task.c **** 
1268:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 946              		.loc 1 1268 0
 947 0008 7B68     		ldr	r3, [r7, #4]
 948 000a 181C     		mov	r0, r3
 949 000c FFF7FEFF 		bl	_task_get_td
 950 0010 031C     		mov	r3, r0
 951 0012 FB60     		str	r3, [r7, #12]
1269:../MQXLITE/kernel/task.c ****     if ( td_ptr == NULL )
 952              		.loc 1 1269 0
 953 0014 FB68     		ldr	r3, [r7, #12]
 954 0016 002B     		cmp	r3, #0
 955 0018 04D1     		bne	.L47
1270:../MQXLITE/kernel/task.c ****     {
1271:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
 956              		.loc 1 1271 0
 957 001a 1220     		mov	r0, #18
 958 001c FFF7FEFF 		bl	_task_set_error
1272:../MQXLITE/kernel/task.c ****         return( NULL );
 959              		.loc 1 1272 0
 960 0020 0023     		mov	r3, #0
 961 0022 03E0     		b	.L48
 962              	.L47:
1273:../MQXLITE/kernel/task.c ****     }/* Endif */
1274:../MQXLITE/kernel/task.c **** 
1275:../MQXLITE/kernel/task.c ****     excpt_function   = td_ptr->EXCEPTION_HANDLER_PTR;
 963              		.loc 1 1275 0
 964 0024 FB68     		ldr	r3, [r7, #12]
 965 0026 9B6E     		ldr	r3, [r3, #104]
 966 0028 BB60     		str	r3, [r7, #8]
1276:../MQXLITE/kernel/task.c **** 
1277:../MQXLITE/kernel/task.c ****     return(excpt_function);
 967              		.loc 1 1277 0
 968 002a BB68     		ldr	r3, [r7, #8]
 969              	.L48:
1278:../MQXLITE/kernel/task.c **** 
1279:../MQXLITE/kernel/task.c **** } /* Endbody */
 970              		.loc 1 1279 0
 971 002c 181C     		mov	r0, r3
 972 002e BD46     		mov	sp, r7
 973 0030 04B0     		add	sp, sp, #16
 974              		@ sp needed for prologue
 975 0032 80BD     		pop	{r7, pc}
 976              		.cfi_endproc
 977              	.LFE5:
 979              		.section	.text._task_set_exception_handler,"ax",%progbits
 980              		.align	2
 981              		.global	_task_set_exception_handler
 982              		.code	16
 983              		.thumb_func
 985              	_task_set_exception_handler:
 986              	.LFB6:
1280:../MQXLITE/kernel/task.c **** 
1281:../MQXLITE/kernel/task.c **** /*!
1282:../MQXLITE/kernel/task.c ****  * \brief Sets the address of the task exception handler.
1283:../MQXLITE/kernel/task.c ****  *
1284:../MQXLITE/kernel/task.c ****  * \param[in] task_id         Task ID of the task whose exception handler is to be set.
1285:../MQXLITE/kernel/task.c ****  * \param[in] handler_address Pointer to the task exception handler.
1286:../MQXLITE/kernel/task.c ****  *
1287:../MQXLITE/kernel/task.c ****  * \return Pointer to the previous task exception handler (might be NULL).
1288:../MQXLITE/kernel/task.c ****  * \return NULL (Task ID is not valid.)
1289:../MQXLITE/kernel/task.c ****  *
1290:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1291:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1292:../MQXLITE/kernel/task.c ****  *
1293:../MQXLITE/kernel/task.c ****  * \see _task_get_exception_handler
1294:../MQXLITE/kernel/task.c ****  * \see _task_get_exit_handler
1295:../MQXLITE/kernel/task.c ****  * \see _task_set_exit_handler
1296:../MQXLITE/kernel/task.c ****  * \see _int_exception_isr
1297:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1298:../MQXLITE/kernel/task.c ****  */
1299:../MQXLITE/kernel/task.c **** TASK_EXCEPTION_FPTR _task_set_exception_handler
1300:../MQXLITE/kernel/task.c **** (
1301:../MQXLITE/kernel/task.c ****     _task_id            task_id,
1302:../MQXLITE/kernel/task.c ****     TASK_EXCEPTION_FPTR handler_address
1303:../MQXLITE/kernel/task.c **** )
1304:../MQXLITE/kernel/task.c **** { /* Body */
 987              		.loc 1 1304 0
 988              		.cfi_startproc
 989 0000 80B5     		push	{r7, lr}
 990              	.LCFI18:
 991              		.cfi_def_cfa_offset 8
 992              		.cfi_offset 7, -8
 993              		.cfi_offset 14, -4
 994 0002 84B0     		sub	sp, sp, #16
 995              	.LCFI19:
 996              		.cfi_def_cfa_offset 24
 997 0004 00AF     		add	r7, sp, #0
 998              	.LCFI20:
 999              		.cfi_def_cfa_register 7
 1000 0006 7860     		str	r0, [r7, #4]
 1001 0008 3960     		str	r1, [r7]
1305:../MQXLITE/kernel/task.c ****     _KLOGM(KERNEL_DATA_STRUCT_PTR kernel_data;)
1306:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR       td_ptr;
1307:../MQXLITE/kernel/task.c ****     TASK_EXCEPTION_FPTR old_function;
1308:../MQXLITE/kernel/task.c **** 
1309:../MQXLITE/kernel/task.c ****     _KLOGM(_GET_KERNEL_DATA(kernel_data);)
1310:../MQXLITE/kernel/task.c ****     _KLOGE3(KLOG_task_set_exception_handler, task_id, handler_address);
1311:../MQXLITE/kernel/task.c **** 
1312:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 1002              		.loc 1 1312 0
 1003 000a 7B68     		ldr	r3, [r7, #4]
 1004 000c 181C     		mov	r0, r3
 1005 000e FFF7FEFF 		bl	_task_get_td
 1006 0012 031C     		mov	r3, r0
 1007 0014 FB60     		str	r3, [r7, #12]
1313:../MQXLITE/kernel/task.c ****     if ( td_ptr == NULL )
 1008              		.loc 1 1313 0
 1009 0016 FB68     		ldr	r3, [r7, #12]
 1010 0018 002B     		cmp	r3, #0
 1011 001a 04D1     		bne	.L50
1314:../MQXLITE/kernel/task.c ****     {
1315:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
 1012              		.loc 1 1315 0
 1013 001c 1220     		mov	r0, #18
 1014 001e FFF7FEFF 		bl	_task_set_error
1316:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_set_exception_handler, NULL);
1317:../MQXLITE/kernel/task.c ****         return( NULL );
 1015              		.loc 1 1317 0
 1016 0022 0023     		mov	r3, #0
 1017 0024 06E0     		b	.L51
 1018              	.L50:
1318:../MQXLITE/kernel/task.c ****     } /* Endif */
1319:../MQXLITE/kernel/task.c **** 
1320:../MQXLITE/kernel/task.c ****     old_function = td_ptr->EXCEPTION_HANDLER_PTR;
 1019              		.loc 1 1320 0
 1020 0026 FB68     		ldr	r3, [r7, #12]
 1021 0028 9B6E     		ldr	r3, [r3, #104]
 1022 002a BB60     		str	r3, [r7, #8]
1321:../MQXLITE/kernel/task.c ****     td_ptr->EXCEPTION_HANDLER_PTR = handler_address;
 1023              		.loc 1 1321 0
 1024 002c FB68     		ldr	r3, [r7, #12]
 1025 002e 3A68     		ldr	r2, [r7]
 1026 0030 9A66     		str	r2, [r3, #104]
1322:../MQXLITE/kernel/task.c **** 
1323:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_exception_handler, old_function);
1324:../MQXLITE/kernel/task.c ****     return(old_function);
 1027              		.loc 1 1324 0
 1028 0032 BB68     		ldr	r3, [r7, #8]
 1029              	.L51:
1325:../MQXLITE/kernel/task.c **** 
1326:../MQXLITE/kernel/task.c **** } /* Endbody */
 1030              		.loc 1 1326 0
 1031 0034 181C     		mov	r0, r3
 1032 0036 BD46     		mov	sp, r7
 1033 0038 04B0     		add	sp, sp, #16
 1034              		@ sp needed for prologue
 1035 003a 80BD     		pop	{r7, pc}
 1036              		.cfi_endproc
 1037              	.LFE6:
 1039              		.section	.text._task_get_exit_handler,"ax",%progbits
 1040              		.align	2
 1041              		.global	_task_get_exit_handler
 1042              		.code	16
 1043              		.thumb_func
 1045              	_task_get_exit_handler:
 1046              	.LFB7:
1327:../MQXLITE/kernel/task.c **** 
1328:../MQXLITE/kernel/task.c **** #endif /* MQX_HAS_EXCEPTION_HANDLER */
1329:../MQXLITE/kernel/task.c **** 
1330:../MQXLITE/kernel/task.c **** #if MQX_HAS_EXIT_HANDLER
1331:../MQXLITE/kernel/task.c **** /*!
1332:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the task exit handler for the task.
1333:../MQXLITE/kernel/task.c ****  *
1334:../MQXLITE/kernel/task.c ****  * MQX calls a task's task exit handler if either of these conditions is true:
1335:../MQXLITE/kernel/task.c ****  * \n - Task is terminated with _task_abort().
1336:../MQXLITE/kernel/task.c ****  * \n - Task returns from its function body (for example, if it calls _mqx_exit()).
1337:../MQXLITE/kernel/task.c ****  *
1338:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID of the task whose exit handler is to be obtained.
1339:../MQXLITE/kernel/task.c ****  *
1340:../MQXLITE/kernel/task.c ****  * \return Pointer to the exit handler (might be NULL).
1341:../MQXLITE/kernel/task.c ****  * \return NULL (Task_id is not valid.)
1342:../MQXLITE/kernel/task.c ****  *
1343:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1344:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1345:../MQXLITE/kernel/task.c ****  *
1346:../MQXLITE/kernel/task.c ****  * \see _task_set_exit_handler
1347:../MQXLITE/kernel/task.c ****  * \see _mqx_exit
1348:../MQXLITE/kernel/task.c ****  * \see _task_get_exception_handler
1349:../MQXLITE/kernel/task.c ****  * \see _task_set_exception_handler
1350:../MQXLITE/kernel/task.c ****  * \see _task_abort
1351:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1352:../MQXLITE/kernel/task.c ****  */
1353:../MQXLITE/kernel/task.c **** TASK_EXIT_FPTR _task_get_exit_handler
1354:../MQXLITE/kernel/task.c **** (
1355:../MQXLITE/kernel/task.c ****     _task_id        task_id
1356:../MQXLITE/kernel/task.c **** )
1357:../MQXLITE/kernel/task.c **** { /* Body */
 1047              		.loc 1 1357 0
 1048              		.cfi_startproc
 1049 0000 80B5     		push	{r7, lr}
 1050              	.LCFI21:
 1051              		.cfi_def_cfa_offset 8
 1052              		.cfi_offset 7, -8
 1053              		.cfi_offset 14, -4
 1054 0002 84B0     		sub	sp, sp, #16
 1055              	.LCFI22:
 1056              		.cfi_def_cfa_offset 24
 1057 0004 00AF     		add	r7, sp, #0
 1058              	.LCFI23:
 1059              		.cfi_def_cfa_register 7
 1060 0006 7860     		str	r0, [r7, #4]
1358:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR  td_ptr;
1359:../MQXLITE/kernel/task.c ****     TASK_EXIT_FPTR exit_function;
1360:../MQXLITE/kernel/task.c **** 
1361:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 1061              		.loc 1 1361 0
 1062 0008 7B68     		ldr	r3, [r7, #4]
 1063 000a 181C     		mov	r0, r3
 1064 000c FFF7FEFF 		bl	_task_get_td
 1065 0010 031C     		mov	r3, r0
 1066 0012 FB60     		str	r3, [r7, #12]
1362:../MQXLITE/kernel/task.c ****     if ( td_ptr == NULL )
 1067              		.loc 1 1362 0
 1068 0014 FB68     		ldr	r3, [r7, #12]
 1069 0016 002B     		cmp	r3, #0
 1070 0018 04D1     		bne	.L53
1363:../MQXLITE/kernel/task.c ****     {
1364:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
 1071              		.loc 1 1364 0
 1072 001a 1220     		mov	r0, #18
 1073 001c FFF7FEFF 		bl	_task_set_error
1365:../MQXLITE/kernel/task.c ****         return( NULL );
 1074              		.loc 1 1365 0
 1075 0020 0023     		mov	r3, #0
 1076 0022 03E0     		b	.L54
 1077              	.L53:
1366:../MQXLITE/kernel/task.c ****     }/* Endif */
1367:../MQXLITE/kernel/task.c **** 
1368:../MQXLITE/kernel/task.c ****     exit_function = td_ptr->EXIT_HANDLER_PTR;
 1078              		.loc 1 1368 0
 1079 0024 FB68     		ldr	r3, [r7, #12]
 1080 0026 5B6E     		ldr	r3, [r3, #100]
 1081 0028 BB60     		str	r3, [r7, #8]
1369:../MQXLITE/kernel/task.c **** 
1370:../MQXLITE/kernel/task.c ****     return(exit_function);
 1082              		.loc 1 1370 0
 1083 002a BB68     		ldr	r3, [r7, #8]
 1084              	.L54:
1371:../MQXLITE/kernel/task.c **** } /* Endbody */
 1085              		.loc 1 1371 0
 1086 002c 181C     		mov	r0, r3
 1087 002e BD46     		mov	sp, r7
 1088 0030 04B0     		add	sp, sp, #16
 1089              		@ sp needed for prologue
 1090 0032 80BD     		pop	{r7, pc}
 1091              		.cfi_endproc
 1092              	.LFE7:
 1094              		.section	.text._task_set_exit_handler,"ax",%progbits
 1095              		.align	2
 1096              		.global	_task_set_exit_handler
 1097              		.code	16
 1098              		.thumb_func
 1100              	_task_set_exit_handler:
 1101              	.LFB8:
1372:../MQXLITE/kernel/task.c **** 
1373:../MQXLITE/kernel/task.c **** /*!
1374:../MQXLITE/kernel/task.c ****  * \brief Sets the address of the task exit handler for the task.
1375:../MQXLITE/kernel/task.c ****  *
1376:../MQXLITE/kernel/task.c ****  * MQX calls a task's task exit handler if either of these conditions is true:
1377:../MQXLITE/kernel/task.c ****  * \n - Task is terminated with _task_abort().
1378:../MQXLITE/kernel/task.c ****  * \n - Task returns from its function body (for example, if it calls _mqx_exit()).
1379:../MQXLITE/kernel/task.c ****  *
1380:../MQXLITE/kernel/task.c ****  * \param[in] task_id              Task ID of the task whose exit handler is to be set.
1381:../MQXLITE/kernel/task.c ****  * \param[in] exit_handler_address Pointer to the exit handler for the task.
1382:../MQXLITE/kernel/task.c ****  *
1383:../MQXLITE/kernel/task.c ****  * \return Pointer to the previous exit handler (might be NULL).
1384:../MQXLITE/kernel/task.c ****  * \return NULL (Task_id is not valid.)
1385:../MQXLITE/kernel/task.c ****  *
1386:../MQXLITE/kernel/task.c ****  * \warning On failure, calls _task_set_error() to set the task error code to
1387:../MQXLITE/kernel/task.c ****  * MQX_INVALID_TASK_ID.
1388:../MQXLITE/kernel/task.c ****  *
1389:../MQXLITE/kernel/task.c ****  * \see _task_get_exit_handler
1390:../MQXLITE/kernel/task.c ****  * \see _mqx_exit
1391:../MQXLITE/kernel/task.c ****  * \see _task_get_exception_handler
1392:../MQXLITE/kernel/task.c ****  * \see _task_set_exception_handler
1393:../MQXLITE/kernel/task.c ****  * \see _task_abort
1394:../MQXLITE/kernel/task.c ****  * \see _task_set_error
1395:../MQXLITE/kernel/task.c ****  */
1396:../MQXLITE/kernel/task.c **** TASK_EXIT_FPTR _task_set_exit_handler
1397:../MQXLITE/kernel/task.c **** (
1398:../MQXLITE/kernel/task.c ****     _task_id       task_id,
1399:../MQXLITE/kernel/task.c ****     TASK_EXIT_FPTR exit_handler_address
1400:../MQXLITE/kernel/task.c **** )
1401:../MQXLITE/kernel/task.c **** { /* Body */
 1102              		.loc 1 1401 0
 1103              		.cfi_startproc
 1104 0000 80B5     		push	{r7, lr}
 1105              	.LCFI24:
 1106              		.cfi_def_cfa_offset 8
 1107              		.cfi_offset 7, -8
 1108              		.cfi_offset 14, -4
 1109 0002 84B0     		sub	sp, sp, #16
 1110              	.LCFI25:
 1111              		.cfi_def_cfa_offset 24
 1112 0004 00AF     		add	r7, sp, #0
 1113              	.LCFI26:
 1114              		.cfi_def_cfa_register 7
 1115 0006 7860     		str	r0, [r7, #4]
 1116 0008 3960     		str	r1, [r7]
1402:../MQXLITE/kernel/task.c ****     _KLOGM(KERNEL_DATA_STRUCT_PTR kernel_data;)
1403:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR  td_ptr;
1404:../MQXLITE/kernel/task.c ****     TASK_EXIT_FPTR old_function;
1405:../MQXLITE/kernel/task.c **** 
1406:../MQXLITE/kernel/task.c ****     _KLOGM(_GET_KERNEL_DATA(kernel_data);)
1407:../MQXLITE/kernel/task.c ****     _KLOGE3(KLOG_task_set_exit_handler, task_id, exit_handler_address);
1408:../MQXLITE/kernel/task.c **** 
1409:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 1117              		.loc 1 1409 0
 1118 000a 7B68     		ldr	r3, [r7, #4]
 1119 000c 181C     		mov	r0, r3
 1120 000e FFF7FEFF 		bl	_task_get_td
 1121 0012 031C     		mov	r3, r0
 1122 0014 FB60     		str	r3, [r7, #12]
1410:../MQXLITE/kernel/task.c ****     if ( td_ptr == NULL )
 1123              		.loc 1 1410 0
 1124 0016 FB68     		ldr	r3, [r7, #12]
 1125 0018 002B     		cmp	r3, #0
 1126 001a 04D1     		bne	.L56
1411:../MQXLITE/kernel/task.c ****     {
1412:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
 1127              		.loc 1 1412 0
 1128 001c 1220     		mov	r0, #18
 1129 001e FFF7FEFF 		bl	_task_set_error
1413:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_set_exit_handler, NULL);
1414:../MQXLITE/kernel/task.c ****         return( NULL );
 1130              		.loc 1 1414 0
 1131 0022 0023     		mov	r3, #0
 1132 0024 06E0     		b	.L57
 1133              	.L56:
1415:../MQXLITE/kernel/task.c ****     }/* Endif */
1416:../MQXLITE/kernel/task.c **** 
1417:../MQXLITE/kernel/task.c ****     old_function = td_ptr->EXIT_HANDLER_PTR;
 1134              		.loc 1 1417 0
 1135 0026 FB68     		ldr	r3, [r7, #12]
 1136 0028 5B6E     		ldr	r3, [r3, #100]
 1137 002a BB60     		str	r3, [r7, #8]
1418:../MQXLITE/kernel/task.c ****     td_ptr->EXIT_HANDLER_PTR = exit_handler_address;
 1138              		.loc 1 1418 0
 1139 002c FB68     		ldr	r3, [r7, #12]
 1140 002e 3A68     		ldr	r2, [r7]
 1141 0030 5A66     		str	r2, [r3, #100]
1419:../MQXLITE/kernel/task.c **** 
1420:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_exit_handler, old_function);
1421:../MQXLITE/kernel/task.c ****     return(old_function);
 1142              		.loc 1 1421 0
 1143 0032 BB68     		ldr	r3, [r7, #8]
 1144              	.L57:
1422:../MQXLITE/kernel/task.c **** 
1423:../MQXLITE/kernel/task.c **** } /* Endbody */
 1145              		.loc 1 1423 0
 1146 0034 181C     		mov	r0, r3
 1147 0036 BD46     		mov	sp, r7
 1148 0038 04B0     		add	sp, sp, #16
 1149              		@ sp needed for prologue
 1150 003a 80BD     		pop	{r7, pc}
 1151              		.cfi_endproc
 1152              	.LFE8:
 1154              		.section	.text._task_get_id_from_name,"ax",%progbits
 1155              		.align	2
 1156              		.global	_task_get_id_from_name
 1157              		.code	16
 1158              		.thumb_func
 1160              	_task_get_id_from_name:
 1161              	.LFB9:
1424:../MQXLITE/kernel/task.c **** 
1425:../MQXLITE/kernel/task.c **** #endif /* MQX_HAS_EXIT_HANDLER */
1426:../MQXLITE/kernel/task.c **** 
1427:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TASK_TEMPLATE_PTR
1428:../MQXLITE/kernel/task.c **** /*!
1429:../MQXLITE/kernel/task.c ****  * \brief Gets the task ID that is associated with the task name.
1430:../MQXLITE/kernel/task.c ****  *
1431:../MQXLITE/kernel/task.c ****  * This function uses a task name (from its task template) to find a task id. Only
1432:../MQXLITE/kernel/task.c ****  * the first task found with the provided name is found.
1433:../MQXLITE/kernel/task.c ****  *
1434:../MQXLITE/kernel/task.c ****  * \param[in] name_ptr Pointer to the name to find in the task template list.
1435:../MQXLITE/kernel/task.c ****  *
1436:../MQXLITE/kernel/task.c ****  * \return Task ID that is associated with the first match of name_ptr.
1437:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Name is not in the task template list.)
1438:../MQXLITE/kernel/task.c ****  *
1439:../MQXLITE/kernel/task.c ****  * \see _task_get_creator
1440:../MQXLITE/kernel/task.c ****  * \see _task_get_processor
1441:../MQXLITE/kernel/task.c ****  * \see _task_get_id
1442:../MQXLITE/kernel/task.c ****  */
1443:../MQXLITE/kernel/task.c **** _task_id _task_get_id_from_name
1444:../MQXLITE/kernel/task.c **** (
1445:../MQXLITE/kernel/task.c ****     char_ptr name_ptr
1446:../MQXLITE/kernel/task.c **** )
1447:../MQXLITE/kernel/task.c **** { /* Body */
 1162              		.loc 1 1447 0
 1163              		.cfi_startproc
 1164 0000 80B5     		push	{r7, lr}
 1165              	.LCFI27:
 1166              		.cfi_def_cfa_offset 8
 1167              		.cfi_offset 7, -8
 1168              		.cfi_offset 14, -4
 1169 0002 86B0     		sub	sp, sp, #24
 1170              	.LCFI28:
 1171              		.cfi_def_cfa_offset 32
 1172 0004 00AF     		add	r7, sp, #0
 1173              	.LCFI29:
 1174              		.cfi_def_cfa_register 7
 1175 0006 7860     		str	r0, [r7, #4]
1448:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR  kernel_data;
1449:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
1450:../MQXLITE/kernel/task.c ****     _mqx_uint               size;
1451:../MQXLITE/kernel/task.c **** 
1452:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1176              		.loc 1 1452 0
 1177 0008 1D4B     		ldr	r3, .L64
 1178 000a 1B68     		ldr	r3, [r3]
 1179 000c FB60     		str	r3, [r7, #12]
1453:../MQXLITE/kernel/task.c **** 
1454:../MQXLITE/kernel/task.c ****     _lwsem_wait((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 1180              		.loc 1 1454 0
 1181 000e FB68     		ldr	r3, [r7, #12]
 1182 0010 F433     		add	r3, r3, #244
 1183 0012 181C     		mov	r0, r3
 1184 0014 FFF7FEFF 		bl	_lwsem_wait
1455:../MQXLITE/kernel/task.c **** 
1456:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)((uchar_ptr)kernel_data->TD_LIST.NEXT -
 1185              		.loc 1 1456 0
 1186 0018 FA68     		ldr	r2, [r7, #12]
 1187 001a C823     		mov	r3, #200
 1188 001c D358     		ldr	r3, [r2, r3]
 1189 001e 5C3B     		sub	r3, r3, #92
 1190 0020 7B61     		str	r3, [r7, #20]
1457:../MQXLITE/kernel/task.c ****              FIELD_OFFSET(TD_STRUCT,TD_LIST_INFO));
1458:../MQXLITE/kernel/task.c ****     size   = _QUEUE_GET_SIZE(&kernel_data->TD_LIST);
 1191              		.loc 1 1458 0
 1192 0022 FB68     		ldr	r3, [r7, #12]
 1193 0024 C833     		add	r3, r3, #200
 1194 0026 1B89     		ldrh	r3, [r3, #8]
 1195 0028 3B61     		str	r3, [r7, #16]
1459:../MQXLITE/kernel/task.c **** 
1460:../MQXLITE/kernel/task.c ****     while (size && td_ptr)
 1196              		.loc 1 1460 0
 1197 002a 19E0     		b	.L59
 1198              	.L63:
1461:../MQXLITE/kernel/task.c ****     {
1462:../MQXLITE/kernel/task.c ****         if (strncmp( td_ptr->TASK_TEMPLATE_PTR->TASK_NAME, name_ptr,
 1199              		.loc 1 1462 0
 1200 002c 7B69     		ldr	r3, [r7, #20]
 1201 002e 9B6D     		ldr	r3, [r3, #88]
 1202 0030 1A69     		ldr	r2, [r3, #16]
 1203 0032 7B68     		ldr	r3, [r7, #4]
 1204 0034 101C     		mov	r0, r2
 1205 0036 191C     		mov	r1, r3
 1206 0038 3222     		mov	r2, #50
 1207 003a FFF7FEFF 		bl	strncmp
 1208 003e 031C     		mov	r3, r0
 1209 0040 07D1     		bne	.L60
1463:../MQXLITE/kernel/task.c ****                         MQX_MAX_TASK_NAME_SIZE) == 0)
1464:../MQXLITE/kernel/task.c ****         {
1465:../MQXLITE/kernel/task.c ****             _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 1210              		.loc 1 1465 0
 1211 0042 FB68     		ldr	r3, [r7, #12]
 1212 0044 F433     		add	r3, r3, #244
 1213 0046 181C     		mov	r0, r3
 1214 0048 FFF7FEFF 		bl	_lwsem_post
1466:../MQXLITE/kernel/task.c ****             return td_ptr->TASK_ID;
 1215              		.loc 1 1466 0
 1216 004c 7B69     		ldr	r3, [r7, #20]
 1217 004e DB68     		ldr	r3, [r3, #12]
 1218 0050 12E0     		b	.L61
 1219              	.L60:
1467:../MQXLITE/kernel/task.c ****         } /* Endif */
1468:../MQXLITE/kernel/task.c ****         size--;
 1220              		.loc 1 1468 0
 1221 0052 3B69     		ldr	r3, [r7, #16]
 1222 0054 013B     		sub	r3, r3, #1
 1223 0056 3B61     		str	r3, [r7, #16]
1469:../MQXLITE/kernel/task.c ****         td_ptr = (TD_STRUCT_PTR)((uchar_ptr)(td_ptr->TD_LIST_INFO.NEXT) -
 1224              		.loc 1 1469 0
 1225 0058 7B69     		ldr	r3, [r7, #20]
 1226 005a DB6D     		ldr	r3, [r3, #92]
 1227 005c 5C3B     		sub	r3, r3, #92
 1228 005e 7B61     		str	r3, [r7, #20]
 1229              	.L59:
1460:../MQXLITE/kernel/task.c ****     while (size && td_ptr)
 1230              		.loc 1 1460 0 discriminator 1
 1231 0060 3B69     		ldr	r3, [r7, #16]
 1232 0062 002B     		cmp	r3, #0
 1233 0064 02D0     		beq	.L62
1460:../MQXLITE/kernel/task.c ****     while (size && td_ptr)
 1234              		.loc 1 1460 0 is_stmt 0 discriminator 2
 1235 0066 7B69     		ldr	r3, [r7, #20]
 1236 0068 002B     		cmp	r3, #0
 1237 006a DFD1     		bne	.L63
 1238              	.L62:
1470:../MQXLITE/kernel/task.c ****                  FIELD_OFFSET(TD_STRUCT,TD_LIST_INFO));
1471:../MQXLITE/kernel/task.c ****     } /* Endwhile */
1472:../MQXLITE/kernel/task.c **** 
1473:../MQXLITE/kernel/task.c ****     _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 1239              		.loc 1 1473 0 is_stmt 1
 1240 006c FB68     		ldr	r3, [r7, #12]
 1241 006e F433     		add	r3, r3, #244
 1242 0070 181C     		mov	r0, r3
 1243 0072 FFF7FEFF 		bl	_lwsem_post
1474:../MQXLITE/kernel/task.c **** 
1475:../MQXLITE/kernel/task.c ****     return MQX_NULL_TASK_ID;
 1244              		.loc 1 1475 0
 1245 0076 0023     		mov	r3, #0
 1246              	.L61:
1476:../MQXLITE/kernel/task.c **** 
1477:../MQXLITE/kernel/task.c **** } /* Endbody */
 1247              		.loc 1 1477 0
 1248 0078 181C     		mov	r0, r3
 1249 007a BD46     		mov	sp, r7
 1250 007c 06B0     		add	sp, sp, #24
 1251              		@ sp needed for prologue
 1252 007e 80BD     		pop	{r7, pc}
 1253              	.L65:
 1254              		.align	2
 1255              	.L64:
 1256 0080 00000000 		.word	_mqx_kernel_data
 1257              		.cfi_endproc
 1258              	.LFE9:
 1260              		.section	.text._task_get_template_ptr,"ax",%progbits
 1261              		.align	2
 1262              		.global	_task_get_template_ptr
 1263              		.code	16
 1264              		.thumb_func
 1266              	_task_get_template_ptr:
 1267              	.LFB10:
1478:../MQXLITE/kernel/task.c **** 
1479:../MQXLITE/kernel/task.c **** /*!
1480:../MQXLITE/kernel/task.c ****  * \brief Gets the pointer to the task template for the task ID.
1481:../MQXLITE/kernel/task.c ****  *
1482:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID for the task for which to get pointer.
1483:../MQXLITE/kernel/task.c ****  *
1484:../MQXLITE/kernel/task.c ****  * \return Pointer to the task's task template. NULL if an invalid task_id is
1485:../MQXLITE/kernel/task.c ****  * presented.
1486:../MQXLITE/kernel/task.c ****  *
1487:../MQXLITE/kernel/task.c ****  * \see _task_get_template_index
1488:../MQXLITE/kernel/task.c ****  * \see _task_get_index_from_id
1489:../MQXLITE/kernel/task.c ****  * \see TASK_TEMPLATE_STRUCT
1490:../MQXLITE/kernel/task.c ****  */
1491:../MQXLITE/kernel/task.c **** TASK_TEMPLATE_STRUCT_PTR  _task_get_template_ptr
1492:../MQXLITE/kernel/task.c **** (
1493:../MQXLITE/kernel/task.c ****     _task_id  task_id
1494:../MQXLITE/kernel/task.c **** )
1495:../MQXLITE/kernel/task.c **** { /* Body */
 1268              		.loc 1 1495 0
 1269              		.cfi_startproc
 1270 0000 80B5     		push	{r7, lr}
 1271              	.LCFI30:
 1272              		.cfi_def_cfa_offset 8
 1273              		.cfi_offset 7, -8
 1274              		.cfi_offset 14, -4
 1275 0002 84B0     		sub	sp, sp, #16
 1276              	.LCFI31:
 1277              		.cfi_def_cfa_offset 24
 1278 0004 00AF     		add	r7, sp, #0
 1279              	.LCFI32:
 1280              		.cfi_def_cfa_register 7
 1281 0006 7860     		str	r0, [r7, #4]
1496:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR  td_ptr;
1497:../MQXLITE/kernel/task.c **** 
1498:../MQXLITE/kernel/task.c ****     td_ptr = _task_get_td(task_id);
 1282              		.loc 1 1498 0
 1283 0008 7B68     		ldr	r3, [r7, #4]
 1284 000a 181C     		mov	r0, r3
 1285 000c FFF7FEFF 		bl	_task_get_td
 1286 0010 031C     		mov	r3, r0
 1287 0012 FB60     		str	r3, [r7, #12]
1499:../MQXLITE/kernel/task.c **** 
1500:../MQXLITE/kernel/task.c ****     return (td_ptr ? td_ptr->TASK_TEMPLATE_PTR : NULL);
 1288              		.loc 1 1500 0
 1289 0014 FB68     		ldr	r3, [r7, #12]
 1290 0016 002B     		cmp	r3, #0
 1291 0018 02D0     		beq	.L67
 1292              		.loc 1 1500 0 is_stmt 0 discriminator 1
 1293 001a FB68     		ldr	r3, [r7, #12]
 1294 001c 9B6D     		ldr	r3, [r3, #88]
 1295 001e 00E0     		b	.L68
 1296              	.L67:
 1297              		.loc 1 1500 0 discriminator 2
 1298 0020 0023     		mov	r3, #0
 1299              	.L68:
1501:../MQXLITE/kernel/task.c **** 
1502:../MQXLITE/kernel/task.c **** } /* Endbody */
 1300              		.loc 1 1502 0 is_stmt 1 discriminator 3
 1301 0022 181C     		mov	r0, r3
 1302 0024 BD46     		mov	sp, r7
 1303 0026 04B0     		add	sp, sp, #16
 1304              		@ sp needed for prologue
 1305 0028 80BD     		pop	{r7, pc}
 1306              		.cfi_endproc
 1307              	.LFE10:
 1309 002a C046     		.section	.text._task_get_template_index,"ax",%progbits
 1310              		.align	2
 1311              		.global	_task_get_template_index
 1312              		.code	16
 1313              		.thumb_func
 1315              	_task_get_template_index:
 1316              	.LFB11:
1503:../MQXLITE/kernel/task.c **** 
1504:../MQXLITE/kernel/task.c **** #endif /* MQX_TD_HAS_TASK_TEMPLATE_PTR */
1505:../MQXLITE/kernel/task.c **** 
1506:../MQXLITE/kernel/task.c **** /*!
1507:../MQXLITE/kernel/task.c ****  * \brief Gets the task template index that is associated with the task name.
1508:../MQXLITE/kernel/task.c ****  *
1509:../MQXLITE/kernel/task.c ****  * \param[in] name_ptr Pointer to the name to find in the task template list.
1510:../MQXLITE/kernel/task.c ****  *
1511:../MQXLITE/kernel/task.c ****  * \return Task template index that is associated with the first match of name_ptr.
1512:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID (Name is not in the task template list.)
1513:../MQXLITE/kernel/task.c ****  *
1514:../MQXLITE/kernel/task.c ****  * \see _task_get_id_from_name
1515:../MQXLITE/kernel/task.c ****  * \see _task_get_index_from_id
1516:../MQXLITE/kernel/task.c ****  */
1517:../MQXLITE/kernel/task.c **** _mqx_uint  _task_get_template_index
1518:../MQXLITE/kernel/task.c **** (
1519:../MQXLITE/kernel/task.c ****     char_ptr name_ptr
1520:../MQXLITE/kernel/task.c **** )
1521:../MQXLITE/kernel/task.c **** { /* Body */
 1317              		.loc 1 1521 0
 1318              		.cfi_startproc
 1319 0000 80B5     		push	{r7, lr}
 1320              	.LCFI33:
 1321              		.cfi_def_cfa_offset 8
 1322              		.cfi_offset 7, -8
 1323              		.cfi_offset 14, -4
 1324 0002 84B0     		sub	sp, sp, #16
 1325              	.LCFI34:
 1326              		.cfi_def_cfa_offset 24
 1327 0004 00AF     		add	r7, sp, #0
 1328              	.LCFI35:
 1329              		.cfi_def_cfa_register 7
 1330 0006 7860     		str	r0, [r7, #4]
1522:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
1523:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR task_template_ptr;
1524:../MQXLITE/kernel/task.c **** 
1525:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1331              		.loc 1 1525 0
 1332 0008 174B     		ldr	r3, .L75
 1333 000a 1B68     		ldr	r3, [r3]
 1334 000c BB60     		str	r3, [r7, #8]
1526:../MQXLITE/kernel/task.c **** 
1527:../MQXLITE/kernel/task.c ****     _lwsem_wait((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 1335              		.loc 1 1527 0
 1336 000e BB68     		ldr	r3, [r7, #8]
 1337 0010 F433     		add	r3, r3, #244
 1338 0012 181C     		mov	r0, r3
 1339 0014 FFF7FEFF 		bl	_lwsem_wait
1528:../MQXLITE/kernel/task.c **** 
1529:../MQXLITE/kernel/task.c ****     /* Search all the local task templates for one whose index matches */
1530:../MQXLITE/kernel/task.c ****     task_template_ptr = kernel_data->INIT.TASK_TEMPLATE_LIST;
 1340              		.loc 1 1530 0
 1341 0018 BA68     		ldr	r2, [r7, #8]
 1342 001a B823     		mov	r3, #184
 1343 001c 5B00     		lsl	r3, r3, #1
 1344 001e D358     		ldr	r3, [r2, r3]
 1345 0020 FB60     		str	r3, [r7, #12]
1531:../MQXLITE/kernel/task.c **** 
1532:../MQXLITE/kernel/task.c ****     while (task_template_ptr->TASK_TEMPLATE_INDEX)
 1346              		.loc 1 1532 0
 1347 0022 10E0     		b	.L70
 1348              	.L73:
1533:../MQXLITE/kernel/task.c ****     {
1534:../MQXLITE/kernel/task.c ****         if (task_template_ptr->TASK_NAME != NULL)
 1349              		.loc 1 1534 0
 1350 0024 FB68     		ldr	r3, [r7, #12]
 1351 0026 1B69     		ldr	r3, [r3, #16]
 1352 0028 002B     		cmp	r3, #0
 1353 002a 09D0     		beq	.L71
1535:../MQXLITE/kernel/task.c ****         {
1536:../MQXLITE/kernel/task.c ****             if (strncmp( task_template_ptr->TASK_NAME, name_ptr,
 1354              		.loc 1 1536 0
 1355 002c FB68     		ldr	r3, [r7, #12]
 1356 002e 1A69     		ldr	r2, [r3, #16]
 1357 0030 7B68     		ldr	r3, [r7, #4]
 1358 0032 101C     		mov	r0, r2
 1359 0034 191C     		mov	r1, r3
 1360 0036 3222     		mov	r2, #50
 1361 0038 FFF7FEFF 		bl	strncmp
 1362 003c 031C     		mov	r3, r0
 1363 003e 07D0     		beq	.L74
 1364              	.L71:
1537:../MQXLITE/kernel/task.c ****                             MQX_MAX_TASK_NAME_SIZE) == 0)
1538:../MQXLITE/kernel/task.c ****             {
1539:../MQXLITE/kernel/task.c ****                 break;
1540:../MQXLITE/kernel/task.c ****             } /* Endif */
1541:../MQXLITE/kernel/task.c ****         } /* Endif */
1542:../MQXLITE/kernel/task.c ****         ++task_template_ptr;
 1365              		.loc 1 1542 0
 1366 0040 FB68     		ldr	r3, [r7, #12]
 1367 0042 1C33     		add	r3, r3, #28
 1368 0044 FB60     		str	r3, [r7, #12]
 1369              	.L70:
1532:../MQXLITE/kernel/task.c ****     while (task_template_ptr->TASK_TEMPLATE_INDEX)
 1370              		.loc 1 1532 0 discriminator 1
 1371 0046 FB68     		ldr	r3, [r7, #12]
 1372 0048 1B68     		ldr	r3, [r3]
 1373 004a 002B     		cmp	r3, #0
 1374 004c EAD1     		bne	.L73
 1375 004e 00E0     		b	.L72
 1376              	.L74:
1539:../MQXLITE/kernel/task.c ****                 break;
 1377              		.loc 1 1539 0
 1378 0050 C046     		mov	r8, r8
 1379              	.L72:
1543:../MQXLITE/kernel/task.c ****     } /* Endwhile */
1544:../MQXLITE/kernel/task.c **** 
1545:../MQXLITE/kernel/task.c ****     _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 1380              		.loc 1 1545 0
 1381 0052 BB68     		ldr	r3, [r7, #8]
 1382 0054 F433     		add	r3, r3, #244
 1383 0056 181C     		mov	r0, r3
 1384 0058 FFF7FEFF 		bl	_lwsem_post
1546:../MQXLITE/kernel/task.c **** 
1547:../MQXLITE/kernel/task.c ****     return task_template_ptr->TASK_TEMPLATE_INDEX;
 1385              		.loc 1 1547 0
 1386 005c FB68     		ldr	r3, [r7, #12]
 1387 005e 1B68     		ldr	r3, [r3]
1548:../MQXLITE/kernel/task.c **** 
1549:../MQXLITE/kernel/task.c **** } /* Endwhile */
 1388              		.loc 1 1549 0
 1389 0060 181C     		mov	r0, r3
 1390 0062 BD46     		mov	sp, r7
 1391 0064 04B0     		add	sp, sp, #16
 1392              		@ sp needed for prologue
 1393 0066 80BD     		pop	{r7, pc}
 1394              	.L76:
 1395              		.align	2
 1396              	.L75:
 1397 0068 00000000 		.word	_mqx_kernel_data
 1398              		.cfi_endproc
 1399              	.LFE11:
 1401              		.section	.text._task_get_id_from_td,"ax",%progbits
 1402              		.align	2
 1403              		.global	_task_get_id_from_td
 1404              		.code	16
 1405              		.thumb_func
 1407              	_task_get_id_from_td:
 1408              	.LFB12:
1550:../MQXLITE/kernel/task.c **** 
1551:../MQXLITE/kernel/task.c **** /*!
1552:../MQXLITE/kernel/task.c ****  * \brief Gets the task ID out of the task descriptor.
1553:../MQXLITE/kernel/task.c ****  *
1554:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr Pointer to the task descriptor.
1555:../MQXLITE/kernel/task.c ****  *
1556:../MQXLITE/kernel/task.c ****  * \return TASK_ID Task ID
1557:../MQXLITE/kernel/task.c ****  * \return MQX_NULL_TASK_ID
1558:../MQXLITE/kernel/task.c ****  */
1559:../MQXLITE/kernel/task.c **** _task_id _task_get_id_from_td
1560:../MQXLITE/kernel/task.c **** (
1561:../MQXLITE/kernel/task.c ****     pointer td_ptr
1562:../MQXLITE/kernel/task.c **** )
1563:../MQXLITE/kernel/task.c **** {
 1409              		.loc 1 1563 0
 1410              		.cfi_startproc
 1411 0000 80B5     		push	{r7, lr}
 1412              	.LCFI36:
 1413              		.cfi_def_cfa_offset 8
 1414              		.cfi_offset 7, -8
 1415              		.cfi_offset 14, -4
 1416 0002 82B0     		sub	sp, sp, #8
 1417              	.LCFI37:
 1418              		.cfi_def_cfa_offset 16
 1419 0004 00AF     		add	r7, sp, #0
 1420              	.LCFI38:
 1421              		.cfi_def_cfa_register 7
 1422 0006 7860     		str	r0, [r7, #4]
1564:../MQXLITE/kernel/task.c ****     if (NULL == td_ptr)
 1423              		.loc 1 1564 0
 1424 0008 7B68     		ldr	r3, [r7, #4]
 1425 000a 002B     		cmp	r3, #0
 1426 000c 01D1     		bne	.L78
1565:../MQXLITE/kernel/task.c ****     {
1566:../MQXLITE/kernel/task.c ****         return MQX_NULL_TASK_ID;
 1427              		.loc 1 1566 0
 1428 000e 0023     		mov	r3, #0
 1429 0010 01E0     		b	.L79
 1430              	.L78:
1567:../MQXLITE/kernel/task.c ****     }
1568:../MQXLITE/kernel/task.c ****     return ((TD_STRUCT_PTR)td_ptr)->TASK_ID;
 1431              		.loc 1 1568 0
 1432 0012 7B68     		ldr	r3, [r7, #4]
 1433 0014 DB68     		ldr	r3, [r3, #12]
 1434              	.L79:
1569:../MQXLITE/kernel/task.c **** }
 1435              		.loc 1 1569 0
 1436 0016 181C     		mov	r0, r3
 1437 0018 BD46     		mov	sp, r7
 1438 001a 02B0     		add	sp, sp, #8
 1439              		@ sp needed for prologue
 1440 001c 80BD     		pop	{r7, pc}
 1441              		.cfi_endproc
 1442              	.LFE12:
 1444 001e C046     		.section	.text._task_get_index_from_id,"ax",%progbits
 1445              		.align	2
 1446              		.global	_task_get_index_from_id
 1447              		.code	16
 1448              		.thumb_func
 1450              	_task_get_index_from_id:
 1451              	.LFB13:
1570:../MQXLITE/kernel/task.c **** 
1571:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TASK_TEMPLATE_PTR || MQX_TD_HAS_TEMPLATE_INDEX
1572:../MQXLITE/kernel/task.c **** 
1573:../MQXLITE/kernel/task.c **** /*!
1574:../MQXLITE/kernel/task.c ****  * \brief Gets the task template index for the task ID.
1575:../MQXLITE/kernel/task.c ****  *
1576:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID to look up.
1577:../MQXLITE/kernel/task.c ****  *
1578:../MQXLITE/kernel/task.c ****  * \return Task template index.
1579:../MQXLITE/kernel/task.c ****  * \return 0 (Task ID was not found.)
1580:../MQXLITE/kernel/task.c ****  *
1581:../MQXLITE/kernel/task.c ****  * \see _task_get_template_index
1582:../MQXLITE/kernel/task.c ****  */
1583:../MQXLITE/kernel/task.c **** _mqx_uint _task_get_index_from_id
1584:../MQXLITE/kernel/task.c **** (
1585:../MQXLITE/kernel/task.c ****     _task_id task_id
1586:../MQXLITE/kernel/task.c **** )
1587:../MQXLITE/kernel/task.c **** { /* Body */
 1452              		.loc 1 1587 0
 1453              		.cfi_startproc
 1454 0000 80B5     		push	{r7, lr}
 1455              	.LCFI39:
 1456              		.cfi_def_cfa_offset 8
 1457              		.cfi_offset 7, -8
 1458              		.cfi_offset 14, -4
 1459 0002 84B0     		sub	sp, sp, #16
 1460              	.LCFI40:
 1461              		.cfi_def_cfa_offset 24
 1462 0004 00AF     		add	r7, sp, #0
 1463              	.LCFI41:
 1464              		.cfi_def_cfa_register 7
 1465 0006 7860     		str	r0, [r7, #4]
1588:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
1589:../MQXLITE/kernel/task.c **** 
1590:../MQXLITE/kernel/task.c ****     td_ptr = _task_get_td(task_id);
 1466              		.loc 1 1590 0
 1467 0008 7B68     		ldr	r3, [r7, #4]
 1468 000a 181C     		mov	r0, r3
 1469 000c FFF7FEFF 		bl	_task_get_td
 1470 0010 031C     		mov	r3, r0
 1471 0012 FB60     		str	r3, [r7, #12]
1591:../MQXLITE/kernel/task.c **** 
1592:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
 1472              		.loc 1 1592 0
 1473 0014 FB68     		ldr	r3, [r7, #12]
 1474 0016 002B     		cmp	r3, #0
 1475 0018 01D1     		bne	.L81
1593:../MQXLITE/kernel/task.c ****     {
1594:../MQXLITE/kernel/task.c ****         return 0;
 1476              		.loc 1 1594 0
 1477 001a 0023     		mov	r3, #0
 1478 001c 02E0     		b	.L82
 1479              	.L81:
1595:../MQXLITE/kernel/task.c ****     } /* Endif */
1596:../MQXLITE/kernel/task.c **** 
1597:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TASK_TEMPLATE_PTR
1598:../MQXLITE/kernel/task.c ****     return td_ptr->TASK_TEMPLATE_PTR->TASK_TEMPLATE_INDEX;
 1480              		.loc 1 1598 0
 1481 001e FB68     		ldr	r3, [r7, #12]
 1482 0020 9B6D     		ldr	r3, [r3, #88]
 1483 0022 1B68     		ldr	r3, [r3]
 1484              	.L82:
1599:../MQXLITE/kernel/task.c **** #elif MQX_TD_HAS_TEMPLATE_INDEX
1600:../MQXLITE/kernel/task.c ****     return td_ptr->TEMPLATE_INDEX;
1601:../MQXLITE/kernel/task.c **** #else
1602:../MQXLITE/kernel/task.c ****     return 0;
1603:../MQXLITE/kernel/task.c **** #endif
1604:../MQXLITE/kernel/task.c **** 
1605:../MQXLITE/kernel/task.c **** } /* Endbody */
 1485              		.loc 1 1605 0
 1486 0024 181C     		mov	r0, r3
 1487 0026 BD46     		mov	sp, r7
 1488 0028 04B0     		add	sp, sp, #16
 1489              		@ sp needed for prologue
 1490 002a 80BD     		pop	{r7, pc}
 1491              		.cfi_endproc
 1492              	.LFE13:
 1494              		.section	.text._task_get_parameter,"ax",%progbits
 1495              		.align	2
 1496              		.global	_task_get_parameter
 1497              		.code	16
 1498              		.thumb_func
 1500              	_task_get_parameter:
 1501              	.LFB14:
1606:../MQXLITE/kernel/task.c **** #endif /* MQX_TD_HAS_TASK_TEMPLATE_PTR || MQX_TD_HAS_TEMPLATE_INDEX */
1607:../MQXLITE/kernel/task.c **** 
1608:../MQXLITE/kernel/task.c **** /*!
1609:../MQXLITE/kernel/task.c ****  * \brief Gets the task creation parameter of the active task.
1610:../MQXLITE/kernel/task.c ****  *
1611:../MQXLITE/kernel/task.c ****  * If a deeply nested function needs the task creation parameter, it can get the
1612:../MQXLITE/kernel/task.c ****  * parameter with _task_get_parameter() or _task_get_parameter_for() rather than
1613:../MQXLITE/kernel/task.c ****  * have the task's main body pass the parameter to it.
1614:../MQXLITE/kernel/task.c ****  *
1615:../MQXLITE/kernel/task.c ****  * \return Creation parameter (might be NULL).
1616:../MQXLITE/kernel/task.c ****  *
1617:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1618:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1619:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1620:../MQXLITE/kernel/task.c ****  * \see _task_create
1621:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
1622:../MQXLITE/kernel/task.c ****  * \see _task_create_at
1623:../MQXLITE/kernel/task.c ****  */
1624:../MQXLITE/kernel/task.c **** uint_32 _task_get_parameter(void)
1625:../MQXLITE/kernel/task.c **** { /* Body */
 1502              		.loc 1 1625 0
 1503              		.cfi_startproc
 1504 0000 80B5     		push	{r7, lr}
 1505              	.LCFI42:
 1506              		.cfi_def_cfa_offset 8
 1507              		.cfi_offset 7, -8
 1508              		.cfi_offset 14, -4
 1509 0002 82B0     		sub	sp, sp, #8
 1510              	.LCFI43:
 1511              		.cfi_def_cfa_offset 16
 1512 0004 00AF     		add	r7, sp, #0
 1513              	.LCFI44:
 1514              		.cfi_def_cfa_register 7
1626:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR     kernel_data;
1627:../MQXLITE/kernel/task.c **** 
1628:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1515              		.loc 1 1628 0
 1516 0006 064B     		ldr	r3, .L84
 1517 0008 1B68     		ldr	r3, [r3]
 1518 000a 7B60     		str	r3, [r7, #4]
1629:../MQXLITE/kernel/task.c **** 
1630:../MQXLITE/kernel/task.c ****     return _task_get_parameter_internal(kernel_data->ACTIVE_PTR);
 1519              		.loc 1 1630 0
 1520 000c 7B68     		ldr	r3, [r7, #4]
 1521 000e DB69     		ldr	r3, [r3, #28]
 1522 0010 181C     		mov	r0, r3
 1523 0012 FFF7FEFF 		bl	_task_get_parameter_internal
 1524 0016 031C     		mov	r3, r0
1631:../MQXLITE/kernel/task.c **** 
1632:../MQXLITE/kernel/task.c **** } /* Endbody */
 1525              		.loc 1 1632 0
 1526 0018 181C     		mov	r0, r3
 1527 001a BD46     		mov	sp, r7
 1528 001c 02B0     		add	sp, sp, #8
 1529              		@ sp needed for prologue
 1530 001e 80BD     		pop	{r7, pc}
 1531              	.L85:
 1532              		.align	2
 1533              	.L84:
 1534 0020 00000000 		.word	_mqx_kernel_data
 1535              		.cfi_endproc
 1536              	.LFE14:
 1538              		.section	.text._task_get_parameter_for,"ax",%progbits
 1539              		.align	2
 1540              		.global	_task_get_parameter_for
 1541              		.code	16
 1542              		.thumb_func
 1544              	_task_get_parameter_for:
 1545              	.LFB15:
1633:../MQXLITE/kernel/task.c **** 
1634:../MQXLITE/kernel/task.c **** /*!
1635:../MQXLITE/kernel/task.c ****  * \brief Gets the task creation parameter of the specified task.
1636:../MQXLITE/kernel/task.c ****  *
1637:../MQXLITE/kernel/task.c ****  * If a deeply nested function needs the task creation parameter, it can get the
1638:../MQXLITE/kernel/task.c ****  * parameter with _task_get_parameter() or _task_get_parameter_for() rather than
1639:../MQXLITE/kernel/task.c ****  * have the task's main body pass the parameter to it.
1640:../MQXLITE/kernel/task.c ****  *
1641:../MQXLITE/kernel/task.c ****  * \param[in] tid Task ID of the task to get creation parameter from.
1642:../MQXLITE/kernel/task.c ****  *
1643:../MQXLITE/kernel/task.c ****  * \return Creation parameter (might be NULL).
1644:../MQXLITE/kernel/task.c ****  *
1645:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1646:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1647:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1648:../MQXLITE/kernel/task.c ****  * \see _task_create
1649:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
1650:../MQXLITE/kernel/task.c ****  * \see _task_create_at
1651:../MQXLITE/kernel/task.c ****  */
1652:../MQXLITE/kernel/task.c **** uint_32 _task_get_parameter_for
1653:../MQXLITE/kernel/task.c **** (
1654:../MQXLITE/kernel/task.c ****     _task_id  tid
1655:../MQXLITE/kernel/task.c **** )
1656:../MQXLITE/kernel/task.c **** { /* Body */
 1546              		.loc 1 1656 0
 1547              		.cfi_startproc
 1548 0000 80B5     		push	{r7, lr}
 1549              	.LCFI45:
 1550              		.cfi_def_cfa_offset 8
 1551              		.cfi_offset 7, -8
 1552              		.cfi_offset 14, -4
 1553 0002 84B0     		sub	sp, sp, #16
 1554              	.LCFI46:
 1555              		.cfi_def_cfa_offset 24
 1556 0004 00AF     		add	r7, sp, #0
 1557              	.LCFI47:
 1558              		.cfi_def_cfa_register 7
 1559 0006 7860     		str	r0, [r7, #4]
1657:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr;
1658:../MQXLITE/kernel/task.c **** 
1659:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(tid);
 1560              		.loc 1 1659 0
 1561 0008 7B68     		ldr	r3, [r7, #4]
 1562 000a 181C     		mov	r0, r3
 1563 000c FFF7FEFF 		bl	_task_get_td
 1564 0010 031C     		mov	r3, r0
 1565 0012 FB60     		str	r3, [r7, #12]
1660:../MQXLITE/kernel/task.c **** 
1661:../MQXLITE/kernel/task.c ****     return _task_get_parameter_internal(td_ptr);
 1566              		.loc 1 1661 0
 1567 0014 FB68     		ldr	r3, [r7, #12]
 1568 0016 181C     		mov	r0, r3
 1569 0018 FFF7FEFF 		bl	_task_get_parameter_internal
 1570 001c 031C     		mov	r3, r0
1662:../MQXLITE/kernel/task.c **** 
1663:../MQXLITE/kernel/task.c **** } /* Endbody */
 1571              		.loc 1 1663 0
 1572 001e 181C     		mov	r0, r3
 1573 0020 BD46     		mov	sp, r7
 1574 0022 04B0     		add	sp, sp, #16
 1575              		@ sp needed for prologue
 1576 0024 80BD     		pop	{r7, pc}
 1577              		.cfi_endproc
 1578              	.LFE15:
 1580 0026 C046     		.section	.text._task_get_parameter_internal,"ax",%progbits
 1581              		.align	2
 1582              		.global	_task_get_parameter_internal
 1583              		.code	16
 1584              		.thumb_func
 1586              	_task_get_parameter_internal:
 1587              	.LFB16:
1664:../MQXLITE/kernel/task.c **** 
1665:../MQXLITE/kernel/task.c **** /*!
1666:../MQXLITE/kernel/task.c ****  * \private
1667:../MQXLITE/kernel/task.c ****  *
1668:../MQXLITE/kernel/task.c ****  * \brief Gets the task creation parameter of the specified task.
1669:../MQXLITE/kernel/task.c ****  *
1670:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr Task ID of the task to get creation parameter from.
1671:../MQXLITE/kernel/task.c ****  *
1672:../MQXLITE/kernel/task.c ****  * \return Creation parameter (might be NULL).
1673:../MQXLITE/kernel/task.c ****  *
1674:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1675:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1676:../MQXLITE/kernel/task.c ****  *
1677:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
1678:../MQXLITE/kernel/task.c ****  */
1679:../MQXLITE/kernel/task.c **** uint_32 _task_get_parameter_internal
1680:../MQXLITE/kernel/task.c **** (
1681:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr
1682:../MQXLITE/kernel/task.c **** )
1683:../MQXLITE/kernel/task.c **** {
 1588              		.loc 1 1683 0
 1589              		.cfi_startproc
 1590 0000 80B5     		push	{r7, lr}
 1591              	.LCFI48:
 1592              		.cfi_def_cfa_offset 8
 1593              		.cfi_offset 7, -8
 1594              		.cfi_offset 14, -4
 1595 0002 84B0     		sub	sp, sp, #16
 1596              	.LCFI49:
 1597              		.cfi_def_cfa_offset 24
 1598 0004 00AF     		add	r7, sp, #0
 1599              	.LCFI50:
 1600              		.cfi_def_cfa_register 7
 1601 0006 7860     		str	r0, [r7, #4]
1684:../MQXLITE/kernel/task.c ****     PSP_STACK_START_STRUCT_PTR stack_start_ptr;
1685:../MQXLITE/kernel/task.c ****     stack_start_ptr = _psp_get_stack_start(td_ptr);
 1602              		.loc 1 1685 0
 1603 0008 7B68     		ldr	r3, [r7, #4]
 1604 000a 181C     		mov	r0, r3
 1605 000c FFF7FEFF 		bl	_psp_get_stack_start
 1606 0010 031C     		mov	r3, r0
 1607 0012 FB60     		str	r3, [r7, #12]
1686:../MQXLITE/kernel/task.c ****     return PSP_TASK_PARAM(stack_start_ptr);
 1608              		.loc 1 1686 0
 1609 0014 FB68     		ldr	r3, [r7, #12]
 1610 0016 DB6C     		ldr	r3, [r3, #76]
1687:../MQXLITE/kernel/task.c **** }
 1611              		.loc 1 1687 0
 1612 0018 181C     		mov	r0, r3
 1613 001a BD46     		mov	sp, r7
 1614 001c 04B0     		add	sp, sp, #16
 1615              		@ sp needed for prologue
 1616 001e 80BD     		pop	{r7, pc}
 1617              		.cfi_endproc
 1618              	.LFE16:
 1620              		.section	.text._task_set_parameter,"ax",%progbits
 1621              		.align	2
 1622              		.global	_task_set_parameter
 1623              		.code	16
 1624              		.thumb_func
 1626              	_task_set_parameter:
 1627              	.LFB17:
1688:../MQXLITE/kernel/task.c **** 
1689:../MQXLITE/kernel/task.c **** /*!
1690:../MQXLITE/kernel/task.c ****  * \brief Sets the task creation parameter of the active task.
1691:../MQXLITE/kernel/task.c ****  *
1692:../MQXLITE/kernel/task.c ****  * \param[in] new_value Value to set the task parameter to.
1693:../MQXLITE/kernel/task.c ****  *
1694:../MQXLITE/kernel/task.c ****  * \return Previous creation parameter (might be NULL).
1695:../MQXLITE/kernel/task.c ****  *
1696:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1697:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1698:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1699:../MQXLITE/kernel/task.c ****  * \see _task_create
1700:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
1701:../MQXLITE/kernel/task.c ****  * \see _task_create_at
1702:../MQXLITE/kernel/task.c ****  */
1703:../MQXLITE/kernel/task.c **** uint_32 _task_set_parameter
1704:../MQXLITE/kernel/task.c **** (
1705:../MQXLITE/kernel/task.c ****     uint_32 new_value
1706:../MQXLITE/kernel/task.c **** )
1707:../MQXLITE/kernel/task.c **** { /* Body */
 1628              		.loc 1 1707 0
 1629              		.cfi_startproc
 1630 0000 80B5     		push	{r7, lr}
 1631              	.LCFI51:
 1632              		.cfi_def_cfa_offset 8
 1633              		.cfi_offset 7, -8
 1634              		.cfi_offset 14, -4
 1635 0002 84B0     		sub	sp, sp, #16
 1636              	.LCFI52:
 1637              		.cfi_def_cfa_offset 24
 1638 0004 00AF     		add	r7, sp, #0
 1639              	.LCFI53:
 1640              		.cfi_def_cfa_register 7
 1641 0006 7860     		str	r0, [r7, #4]
1708:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR     kernel_data;
1709:../MQXLITE/kernel/task.c ****     uint_32                    old_value;
1710:../MQXLITE/kernel/task.c **** 
1711:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1642              		.loc 1 1711 0
 1643 0008 084B     		ldr	r3, .L89
 1644 000a 1B68     		ldr	r3, [r3]
 1645 000c FB60     		str	r3, [r7, #12]
1712:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_set_parameter, new_value);
1713:../MQXLITE/kernel/task.c **** 
1714:../MQXLITE/kernel/task.c ****     old_value = _task_set_parameter_internal(new_value, kernel_data->ACTIVE_PTR);
 1646              		.loc 1 1714 0
 1647 000e FB68     		ldr	r3, [r7, #12]
 1648 0010 DB69     		ldr	r3, [r3, #28]
 1649 0012 7A68     		ldr	r2, [r7, #4]
 1650 0014 101C     		mov	r0, r2
 1651 0016 191C     		mov	r1, r3
 1652 0018 FFF7FEFF 		bl	_task_set_parameter_internal
 1653 001c 031C     		mov	r3, r0
 1654 001e BB60     		str	r3, [r7, #8]
1715:../MQXLITE/kernel/task.c **** 
1716:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_parameter, old_value);
1717:../MQXLITE/kernel/task.c ****     return old_value;
 1655              		.loc 1 1717 0
 1656 0020 BB68     		ldr	r3, [r7, #8]
1718:../MQXLITE/kernel/task.c **** 
1719:../MQXLITE/kernel/task.c **** } /* Endbody */
 1657              		.loc 1 1719 0
 1658 0022 181C     		mov	r0, r3
 1659 0024 BD46     		mov	sp, r7
 1660 0026 04B0     		add	sp, sp, #16
 1661              		@ sp needed for prologue
 1662 0028 80BD     		pop	{r7, pc}
 1663              	.L90:
 1664 002a C046     		.align	2
 1665              	.L89:
 1666 002c 00000000 		.word	_mqx_kernel_data
 1667              		.cfi_endproc
 1668              	.LFE17:
 1670              		.section	.text._task_set_parameter_for,"ax",%progbits
 1671              		.align	2
 1672              		.global	_task_set_parameter_for
 1673              		.code	16
 1674              		.thumb_func
 1676              	_task_set_parameter_for:
 1677              	.LFB18:
1720:../MQXLITE/kernel/task.c **** 
1721:../MQXLITE/kernel/task.c **** /*!
1722:../MQXLITE/kernel/task.c ****  * \brief Sets the task creation parameter of the specified task.
1723:../MQXLITE/kernel/task.c ****  *
1724:../MQXLITE/kernel/task.c ****  * \param[in] new_value Value to set the task parameter to.
1725:../MQXLITE/kernel/task.c ****  * \param[in] tid       Task ID of the task to set.
1726:../MQXLITE/kernel/task.c ****  *
1727:../MQXLITE/kernel/task.c ****  * \return Previous creation parameter (might be NULL).
1728:../MQXLITE/kernel/task.c ****  *
1729:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter
1730:../MQXLITE/kernel/task.c ****  * \see _task_get_parameter_for
1731:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1732:../MQXLITE/kernel/task.c ****  * \see _task_create
1733:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
1734:../MQXLITE/kernel/task.c ****  * \see _task_create_at
1735:../MQXLITE/kernel/task.c ****  */
1736:../MQXLITE/kernel/task.c **** uint_32 _task_set_parameter_for
1737:../MQXLITE/kernel/task.c **** (
1738:../MQXLITE/kernel/task.c ****     uint_32   new_value,
1739:../MQXLITE/kernel/task.c ****     _task_id  tid
1740:../MQXLITE/kernel/task.c **** )
1741:../MQXLITE/kernel/task.c **** { /* Body */
 1678              		.loc 1 1741 0
 1679              		.cfi_startproc
 1680 0000 80B5     		push	{r7, lr}
 1681              	.LCFI54:
 1682              		.cfi_def_cfa_offset 8
 1683              		.cfi_offset 7, -8
 1684              		.cfi_offset 14, -4
 1685 0002 86B0     		sub	sp, sp, #24
 1686              	.LCFI55:
 1687              		.cfi_def_cfa_offset 32
 1688 0004 00AF     		add	r7, sp, #0
 1689              	.LCFI56:
 1690              		.cfi_def_cfa_register 7
 1691 0006 7860     		str	r0, [r7, #4]
 1692 0008 3960     		str	r1, [r7]
1742:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR  kernel_data;
1743:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
1744:../MQXLITE/kernel/task.c ****     uint_32                 old_value;
1745:../MQXLITE/kernel/task.c **** 
1746:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1693              		.loc 1 1746 0
 1694 000a 0D4B     		ldr	r3, .L94
 1695 000c 1B68     		ldr	r3, [r3]
 1696 000e 7B61     		str	r3, [r7, #20]
1747:../MQXLITE/kernel/task.c ****     _KLOGE3(KLOG_task_set_parameter_for, tid, new_value);
1748:../MQXLITE/kernel/task.c **** 
1749:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(tid);
 1697              		.loc 1 1749 0
 1698 0010 3B68     		ldr	r3, [r7]
 1699 0012 181C     		mov	r0, r3
 1700 0014 FFF7FEFF 		bl	_task_get_td
 1701 0018 031C     		mov	r3, r0
 1702 001a 3B61     		str	r3, [r7, #16]
1750:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
1751:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
 1703              		.loc 1 1751 0
 1704 001c 3B69     		ldr	r3, [r7, #16]
 1705 001e 002B     		cmp	r3, #0
 1706 0020 01D1     		bne	.L92
1752:../MQXLITE/kernel/task.c ****     {
1753:../MQXLITE/kernel/task.c ****         _KLOGX3(KLOG_task_set_parameter_for, tid, MQX_INVALID_PARAMETER);
1754:../MQXLITE/kernel/task.c ****         return 0;
 1707              		.loc 1 1754 0
 1708 0022 0023     		mov	r3, #0
 1709 0024 08E0     		b	.L93
 1710              	.L92:
1755:../MQXLITE/kernel/task.c ****     } /* Endif */
1756:../MQXLITE/kernel/task.c **** #endif
1757:../MQXLITE/kernel/task.c **** 
1758:../MQXLITE/kernel/task.c ****     old_value = _task_set_parameter_internal(new_value, td_ptr);
 1711              		.loc 1 1758 0
 1712 0026 7A68     		ldr	r2, [r7, #4]
 1713 0028 3B69     		ldr	r3, [r7, #16]
 1714 002a 101C     		mov	r0, r2
 1715 002c 191C     		mov	r1, r3
 1716 002e FFF7FEFF 		bl	_task_set_parameter_internal
 1717 0032 031C     		mov	r3, r0
 1718 0034 FB60     		str	r3, [r7, #12]
1759:../MQXLITE/kernel/task.c **** 
1760:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_parameter_for, old_value);
1761:../MQXLITE/kernel/task.c ****     return old_value;
 1719              		.loc 1 1761 0
 1720 0036 FB68     		ldr	r3, [r7, #12]
 1721              	.L93:
1762:../MQXLITE/kernel/task.c **** 
1763:../MQXLITE/kernel/task.c **** } /* Endbody */
 1722              		.loc 1 1763 0
 1723 0038 181C     		mov	r0, r3
 1724 003a BD46     		mov	sp, r7
 1725 003c 06B0     		add	sp, sp, #24
 1726              		@ sp needed for prologue
 1727 003e 80BD     		pop	{r7, pc}
 1728              	.L95:
 1729              		.align	2
 1730              	.L94:
 1731 0040 00000000 		.word	_mqx_kernel_data
 1732              		.cfi_endproc
 1733              	.LFE18:
 1735              		.section	.text._task_set_parameter_internal,"ax",%progbits
 1736              		.align	2
 1737              		.global	_task_set_parameter_internal
 1738              		.code	16
 1739              		.thumb_func
 1741              	_task_set_parameter_internal:
 1742              	.LFB19:
1764:../MQXLITE/kernel/task.c **** 
1765:../MQXLITE/kernel/task.c **** /*!
1766:../MQXLITE/kernel/task.c ****  * \private
1767:../MQXLITE/kernel/task.c ****  *
1768:../MQXLITE/kernel/task.c ****  * \brief Sets the task creation parameter of the specified task.
1769:../MQXLITE/kernel/task.c ****  *
1770:../MQXLITE/kernel/task.c ****  * \param[in] new_value Value to set the task parameter to.
1771:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr    Task ID of the task to set.
1772:../MQXLITE/kernel/task.c ****  *
1773:../MQXLITE/kernel/task.c ****  * \return Previous creation parameter (might be NULL).
1774:../MQXLITE/kernel/task.c ****  *
1775:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter
1776:../MQXLITE/kernel/task.c ****  * \see _task_set_parameter_for
1777:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
1778:../MQXLITE/kernel/task.c ****  */
1779:../MQXLITE/kernel/task.c **** uint_32 _task_set_parameter_internal
1780:../MQXLITE/kernel/task.c **** (
1781:../MQXLITE/kernel/task.c ****     uint_32       new_value,
1782:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr
1783:../MQXLITE/kernel/task.c **** )
1784:../MQXLITE/kernel/task.c **** { /* Body */
 1743              		.loc 1 1784 0
 1744              		.cfi_startproc
 1745 0000 80B5     		push	{r7, lr}
 1746              	.LCFI57:
 1747              		.cfi_def_cfa_offset 8
 1748              		.cfi_offset 7, -8
 1749              		.cfi_offset 14, -4
 1750 0002 84B0     		sub	sp, sp, #16
 1751              	.LCFI58:
 1752              		.cfi_def_cfa_offset 24
 1753 0004 00AF     		add	r7, sp, #0
 1754              	.LCFI59:
 1755              		.cfi_def_cfa_register 7
 1756 0006 7860     		str	r0, [r7, #4]
 1757 0008 3960     		str	r1, [r7]
1785:../MQXLITE/kernel/task.c ****     PSP_STACK_START_STRUCT_PTR stack_start_ptr;
1786:../MQXLITE/kernel/task.c ****     uint_32                    old_value;
1787:../MQXLITE/kernel/task.c **** 
1788:../MQXLITE/kernel/task.c ****     stack_start_ptr = _psp_get_stack_start(td_ptr);
 1758              		.loc 1 1788 0
 1759 000a 3B68     		ldr	r3, [r7]
 1760 000c 181C     		mov	r0, r3
 1761 000e FFF7FEFF 		bl	_psp_get_stack_start
 1762 0012 031C     		mov	r3, r0
 1763 0014 FB60     		str	r3, [r7, #12]
1789:../MQXLITE/kernel/task.c **** 
1790:../MQXLITE/kernel/task.c ****     old_value = PSP_TASK_PARAM(stack_start_ptr);
 1764              		.loc 1 1790 0
 1765 0016 FB68     		ldr	r3, [r7, #12]
 1766 0018 DB6C     		ldr	r3, [r3, #76]
 1767 001a BB60     		str	r3, [r7, #8]
1791:../MQXLITE/kernel/task.c ****     PSP_TASK_PARAM(stack_start_ptr) = new_value;
 1768              		.loc 1 1791 0
 1769 001c FB68     		ldr	r3, [r7, #12]
 1770 001e 7A68     		ldr	r2, [r7, #4]
 1771 0020 DA64     		str	r2, [r3, #76]
1792:../MQXLITE/kernel/task.c **** 
1793:../MQXLITE/kernel/task.c ****     return old_value;
 1772              		.loc 1 1793 0
 1773 0022 BB68     		ldr	r3, [r7, #8]
1794:../MQXLITE/kernel/task.c **** 
1795:../MQXLITE/kernel/task.c **** } /* Endbody */
 1774              		.loc 1 1795 0
 1775 0024 181C     		mov	r0, r3
 1776 0026 BD46     		mov	sp, r7
 1777 0028 04B0     		add	sp, sp, #16
 1778              		@ sp needed for prologue
 1779 002a 80BD     		pop	{r7, pc}
 1780              		.cfi_endproc
 1781              	.LFE19:
 1783              		.section	.text._task_get_priority,"ax",%progbits
 1784              		.align	2
 1785              		.global	_task_get_priority
 1786              		.code	16
 1787              		.thumb_func
 1789              	_task_get_priority:
 1790              	.LFB20:
1796:../MQXLITE/kernel/task.c **** 
1797:../MQXLITE/kernel/task.c **** #if MQX_HAS_DYNAMIC_PRIORITIES
1798:../MQXLITE/kernel/task.c **** 
1799:../MQXLITE/kernel/task.c **** /*!
1800:../MQXLITE/kernel/task.c ****  * \brief Gets the priority of the task.
1801:../MQXLITE/kernel/task.c ****  *
1802:../MQXLITE/kernel/task.c ****  * \param[in]  task_id      One of the following:
1803:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task for which to set or get info.
1804:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Use the calling task.)
1805:../MQXLITE/kernel/task.c ****  * \param[out] priority_ptr Pointer to the priority.
1806:../MQXLITE/kernel/task.c ****  *
1807:../MQXLITE/kernel/task.c ****  * \return MQX_OK
1808:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID (Task_id does not represent a currently valid task.)
1809:../MQXLITE/kernel/task.c ****  *
1810:../MQXLITE/kernel/task.c ****  * \warning Might dispatch a task.
1811:../MQXLITE/kernel/task.c ****  *
1812:../MQXLITE/kernel/task.c ****  * \see _task_set_priority
1813:../MQXLITE/kernel/task.c ****  * \see _task_get_creator
1814:../MQXLITE/kernel/task.c ****  * \see _task_get_processor
1815:../MQXLITE/kernel/task.c ****  * \see _sem_create
1816:../MQXLITE/kernel/task.c ****  * \see _sem_create_fast
1817:../MQXLITE/kernel/task.c ****  * \see _sem_wait
1818:../MQXLITE/kernel/task.c ****  * \see _sem_wait_for
1819:../MQXLITE/kernel/task.c ****  * \see _sem_wait_ticks
1820:../MQXLITE/kernel/task.c ****  * \see _sem_wait_until
1821:../MQXLITE/kernel/task.c ****  * \see _mutatr_get_sched_protocol
1822:../MQXLITE/kernel/task.c ****  * \see _mutatr_set_sched_protocol
1823:../MQXLITE/kernel/task.c ****  * \see _mutex_lock
1824:../MQXLITE/kernel/task.c ****  */
1825:../MQXLITE/kernel/task.c **** _mqx_uint _task_get_priority
1826:../MQXLITE/kernel/task.c **** (
1827:../MQXLITE/kernel/task.c ****     _task_id      task_id,
1828:../MQXLITE/kernel/task.c ****     _mqx_uint_ptr priority_ptr
1829:../MQXLITE/kernel/task.c **** )
1830:../MQXLITE/kernel/task.c **** { /* Body */
 1791              		.loc 1 1830 0
 1792              		.cfi_startproc
 1793 0000 80B5     		push	{r7, lr}
 1794              	.LCFI60:
 1795              		.cfi_def_cfa_offset 8
 1796              		.cfi_offset 7, -8
 1797              		.cfi_offset 14, -4
 1798 0002 84B0     		sub	sp, sp, #16
 1799              	.LCFI61:
 1800              		.cfi_def_cfa_offset 24
 1801 0004 00AF     		add	r7, sp, #0
 1802              	.LCFI62:
 1803              		.cfi_def_cfa_register 7
 1804 0006 7860     		str	r0, [r7, #4]
 1805 0008 3960     		str	r1, [r7]
1831:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
1832:../MQXLITE/kernel/task.c **** 
1833:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 1806              		.loc 1 1833 0
 1807 000a 7B68     		ldr	r3, [r7, #4]
 1808 000c 181C     		mov	r0, r3
 1809 000e FFF7FEFF 		bl	_task_get_td
 1810 0012 031C     		mov	r3, r0
 1811 0014 FB60     		str	r3, [r7, #12]
1834:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
 1812              		.loc 1 1834 0
 1813 0016 FB68     		ldr	r3, [r7, #12]
 1814 0018 002B     		cmp	r3, #0
 1815 001a 01D1     		bne	.L98
1835:../MQXLITE/kernel/task.c ****     {
1836:../MQXLITE/kernel/task.c ****         return(MQX_INVALID_TASK_ID);
 1816              		.loc 1 1836 0
 1817 001c 1223     		mov	r3, #18
 1818 001e 06E0     		b	.L99
 1819              	.L98:
1837:../MQXLITE/kernel/task.c ****     } /* Endif */
1838:../MQXLITE/kernel/task.c ****     *priority_ptr = td_ptr->HOME_QUEUE->PRIORITY;
 1820              		.loc 1 1838 0
 1821 0020 FB68     		ldr	r3, [r7, #12]
 1822 0022 1B6A     		ldr	r3, [r3, #32]
 1823 0024 DB89     		ldrh	r3, [r3, #14]
 1824 0026 1A1C     		mov	r2, r3
 1825 0028 3B68     		ldr	r3, [r7]
 1826 002a 1A60     		str	r2, [r3]
1839:../MQXLITE/kernel/task.c ****     return MQX_OK;
 1827              		.loc 1 1839 0
 1828 002c 0023     		mov	r3, #0
 1829              	.L99:
1840:../MQXLITE/kernel/task.c **** 
1841:../MQXLITE/kernel/task.c **** } /* Endbody */
 1830              		.loc 1 1841 0
 1831 002e 181C     		mov	r0, r3
 1832 0030 BD46     		mov	sp, r7
 1833 0032 04B0     		add	sp, sp, #16
 1834              		@ sp needed for prologue
 1835 0034 80BD     		pop	{r7, pc}
 1836              		.cfi_endproc
 1837              	.LFE20:
 1839 0036 C046     		.section	.text._task_set_priority,"ax",%progbits
 1840              		.align	2
 1841              		.global	_task_set_priority
 1842              		.code	16
 1843              		.thumb_func
 1845              	_task_set_priority:
 1846              	.LFB21:
1842:../MQXLITE/kernel/task.c **** 
1843:../MQXLITE/kernel/task.c **** /*!
1844:../MQXLITE/kernel/task.c ****  * \brief Sets the priority of the task.
1845:../MQXLITE/kernel/task.c ****  *
1846:../MQXLITE/kernel/task.c ****  * MQX might boost the priority of a task that waits for a semaphore or locks a
1847:../MQXLITE/kernel/task.c ****  * mutex. If MQX has boosted the priority of the task that is specified by task_id,
1848:../MQXLITE/kernel/task.c ****  * _task_set_priority() will raise but not lower the task's priority.
1849:../MQXLITE/kernel/task.c ****  * \n If the task is in the blocked state, priority change takes place when task
1850:../MQXLITE/kernel/task.c ****  * is ready.
1851:../MQXLITE/kernel/task.c ****  * \n When the task is in the ready state, priority change takes place immediately.
1852:../MQXLITE/kernel/task.c ****  *
1853:../MQXLITE/kernel/task.c ****  * \param[in]  task_id      One of the following:
1854:../MQXLITE/kernel/task.c ****  * \n - Task ID of the task for which to set or get info.
1855:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Use the calling task.)
1856:../MQXLITE/kernel/task.c ****  * \param[in]  new_priority New task priority.
1857:../MQXLITE/kernel/task.c ****  * \param[out] priority_ptr Pointer to the previous task priority.
1858:../MQXLITE/kernel/task.c ****  *
1859:../MQXLITE/kernel/task.c ****  * \return MQX_OK
1860:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID (Task_id does not represent a currently valid task.)
1861:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_PARAMETER (New_priority is numerically greater than the
1862:../MQXLITE/kernel/task.c ****  * lowest-allowable priority of an application task.)
1863:../MQXLITE/kernel/task.c ****  *
1864:../MQXLITE/kernel/task.c ****  * \warning Might dispatch a task.
1865:../MQXLITE/kernel/task.c ****  *
1866:../MQXLITE/kernel/task.c ****  * \see _task_get_priority
1867:../MQXLITE/kernel/task.c ****  * \see _task_get_creator
1868:../MQXLITE/kernel/task.c ****  * \see _task_get_processor
1869:../MQXLITE/kernel/task.c ****  * \see _sem_create
1870:../MQXLITE/kernel/task.c ****  * \see _sem_create_fast
1871:../MQXLITE/kernel/task.c ****  * \see _sem_wait
1872:../MQXLITE/kernel/task.c ****  * \see _sem_wait_for
1873:../MQXLITE/kernel/task.c ****  * \see _sem_wait_ticks
1874:../MQXLITE/kernel/task.c ****  * \see _sem_wait_until
1875:../MQXLITE/kernel/task.c ****  * \see _mutatr_get_sched_protocol
1876:../MQXLITE/kernel/task.c ****  * \see _mutatr_set_sched_protocol
1877:../MQXLITE/kernel/task.c ****  * \see _mutex_lock
1878:../MQXLITE/kernel/task.c ****  */
1879:../MQXLITE/kernel/task.c **** _mqx_uint _task_set_priority
1880:../MQXLITE/kernel/task.c **** (
1881:../MQXLITE/kernel/task.c ****     _task_id     task_id,
1882:../MQXLITE/kernel/task.c ****     _mqx_uint     new_priority,
1883:../MQXLITE/kernel/task.c ****     _mqx_uint_ptr priority_ptr
1884:../MQXLITE/kernel/task.c **** )
1885:../MQXLITE/kernel/task.c **** { /* Body */
 1847              		.loc 1 1885 0
 1848              		.cfi_startproc
 1849 0000 80B5     		push	{r7, lr}
 1850              	.LCFI63:
 1851              		.cfi_def_cfa_offset 8
 1852              		.cfi_offset 7, -8
 1853              		.cfi_offset 14, -4
 1854 0002 8AB0     		sub	sp, sp, #40
 1855              	.LCFI64:
 1856              		.cfi_def_cfa_offset 48
 1857 0004 00AF     		add	r7, sp, #0
 1858              	.LCFI65:
 1859              		.cfi_def_cfa_register 7
 1860 0006 F860     		str	r0, [r7, #12]
 1861 0008 B960     		str	r1, [r7, #8]
 1862 000a 7A60     		str	r2, [r7, #4]
1886:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR  kernel_data;
1887:../MQXLITE/kernel/task.c ****     READY_Q_STRUCT_PTR      ready_q_ptr;
1888:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
1889:../MQXLITE/kernel/task.c ****     TASK_QUEUE_STRUCT_PTR   task_queue_ptr;
1890:../MQXLITE/kernel/task.c **** 
1891:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 1863              		.loc 1 1891 0
 1864 000c 384B     		ldr	r3, .L107
 1865 000e 1B68     		ldr	r3, [r3]
 1866 0010 7B62     		str	r3, [r7, #36]
1892:../MQXLITE/kernel/task.c **** 
1893:../MQXLITE/kernel/task.c ****     _KLOGE3(KLOG_task_set_priority, task_id, new_priority);
1894:../MQXLITE/kernel/task.c **** 
1895:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
1896:../MQXLITE/kernel/task.c ****     if (new_priority > kernel_data->LOWEST_TASK_PRIORITY)
 1867              		.loc 1 1896 0
 1868 0012 7A6A     		ldr	r2, [r7, #36]
 1869 0014 C423     		mov	r3, #196
 1870 0016 D258     		ldr	r2, [r2, r3]
 1871 0018 BB68     		ldr	r3, [r7, #8]
 1872 001a 9A42     		cmp	r2, r3
 1873 001c 01D2     		bcs	.L101
1897:../MQXLITE/kernel/task.c ****     {
1898:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_set_priority, MQX_INVALID_PARAMETER);
1899:../MQXLITE/kernel/task.c ****         return(MQX_INVALID_PARAMETER);
 1874              		.loc 1 1899 0
 1875 001e 0C23     		mov	r3, #12
 1876 0020 61E0     		b	.L102
 1877              	.L101:
1900:../MQXLITE/kernel/task.c ****     }/* Endif */
1901:../MQXLITE/kernel/task.c **** #endif
1902:../MQXLITE/kernel/task.c **** 
1903:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 1878              		.loc 1 1903 0
 1879 0022 FB68     		ldr	r3, [r7, #12]
 1880 0024 181C     		mov	r0, r3
 1881 0026 FFF7FEFF 		bl	_task_get_td
 1882 002a 031C     		mov	r3, r0
 1883 002c 3B62     		str	r3, [r7, #32]
1904:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
 1884              		.loc 1 1904 0
 1885 002e 3B6A     		ldr	r3, [r7, #32]
 1886 0030 002B     		cmp	r3, #0
 1887 0032 01D1     		bne	.L103
1905:../MQXLITE/kernel/task.c ****     {
1906:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_set_priority, MQX_INVALID_TASK_ID);
1907:../MQXLITE/kernel/task.c ****         return(MQX_INVALID_TASK_ID);
 1888              		.loc 1 1907 0
 1889 0034 1223     		mov	r3, #18
 1890 0036 56E0     		b	.L102
 1891              	.L103:
1908:../MQXLITE/kernel/task.c ****     } /* Endif */
1909:../MQXLITE/kernel/task.c **** 
1910:../MQXLITE/kernel/task.c ****     _int_disable();
 1892              		.loc 1 1910 0
 1893 0038 FFF7FEFF 		bl	_int_disable
1911:../MQXLITE/kernel/task.c ****     /* Return old priority */
1912:../MQXLITE/kernel/task.c ****     *priority_ptr = td_ptr->HOME_QUEUE->PRIORITY;
 1894              		.loc 1 1912 0
 1895 003c 3B6A     		ldr	r3, [r7, #32]
 1896 003e 1B6A     		ldr	r3, [r3, #32]
 1897 0040 DB89     		ldrh	r3, [r3, #14]
 1898 0042 1A1C     		mov	r2, r3
 1899 0044 7B68     		ldr	r3, [r7, #4]
 1900 0046 1A60     		str	r2, [r3]
1913:../MQXLITE/kernel/task.c **** 
1914:../MQXLITE/kernel/task.c ****     /* Make the change permanent */
1915:../MQXLITE/kernel/task.c ****     ready_q_ptr = kernel_data->READY_Q_LIST;
 1901              		.loc 1 1915 0
 1902 0048 7B6A     		ldr	r3, [r7, #36]
 1903 004a 1B6A     		ldr	r3, [r3, #32]
 1904 004c FB61     		str	r3, [r7, #28]
1916:../MQXLITE/kernel/task.c ****     td_ptr->HOME_QUEUE = ready_q_ptr - new_priority;
 1905              		.loc 1 1916 0
 1906 004e BB68     		ldr	r3, [r7, #8]
 1907 0050 1B01     		lsl	r3, r3, #4
 1908 0052 5B42     		neg	r3, r3
 1909 0054 FA69     		ldr	r2, [r7, #28]
 1910 0056 D218     		add	r2, r2, r3
 1911 0058 3B6A     		ldr	r3, [r7, #32]
 1912 005a 1A62     		str	r2, [r3, #32]
1917:../MQXLITE/kernel/task.c **** 
1918:../MQXLITE/kernel/task.c ****     if (td_ptr->BOOSTED)
 1913              		.loc 1 1918 0
 1914 005c 3B6A     		ldr	r3, [r7, #32]
 1915 005e 5B6C     		ldr	r3, [r3, #68]
 1916 0060 002B     		cmp	r3, #0
 1917 0062 0DD0     		beq	.L104
1919:../MQXLITE/kernel/task.c ****     {
1920:../MQXLITE/kernel/task.c ****         /* Can only change priority to a higher (lower value) */
1921:../MQXLITE/kernel/task.c ****         if (new_priority < td_ptr->MY_QUEUE->PRIORITY)
 1918              		.loc 1 1921 0
 1919 0064 3B6A     		ldr	r3, [r7, #32]
 1920 0066 DB69     		ldr	r3, [r3, #28]
 1921 0068 DB89     		ldrh	r3, [r3, #14]
 1922 006a 1A1C     		mov	r2, r3
 1923 006c BB68     		ldr	r3, [r7, #8]
 1924 006e 9A42     		cmp	r2, r3
 1925 0070 0CD9     		bls	.L105
1922:../MQXLITE/kernel/task.c ****         {
1923:../MQXLITE/kernel/task.c ****             /* Move the task to the correct priority level */
1924:../MQXLITE/kernel/task.c ****             _sched_set_priority_internal(td_ptr, new_priority);
 1926              		.loc 1 1924 0
 1927 0072 3A6A     		ldr	r2, [r7, #32]
 1928 0074 BB68     		ldr	r3, [r7, #8]
 1929 0076 101C     		mov	r0, r2
 1930 0078 191C     		mov	r1, r3
 1931 007a FFF7FEFF 		bl	_sched_set_priority_internal
 1932 007e 05E0     		b	.L105
 1933              	.L104:
1925:../MQXLITE/kernel/task.c ****         } /* Endif */
1926:../MQXLITE/kernel/task.c ****     }
1927:../MQXLITE/kernel/task.c ****     else
1928:../MQXLITE/kernel/task.c ****     {
1929:../MQXLITE/kernel/task.c ****         /* Move the task to the correct priority level */
1930:../MQXLITE/kernel/task.c ****         _sched_set_priority_internal(td_ptr, new_priority);
 1934              		.loc 1 1930 0
 1935 0080 3A6A     		ldr	r2, [r7, #32]
 1936 0082 BB68     		ldr	r3, [r7, #8]
 1937 0084 101C     		mov	r0, r2
 1938 0086 191C     		mov	r1, r3
 1939 0088 FFF7FEFF 		bl	_sched_set_priority_internal
 1940              	.L105:
1931:../MQXLITE/kernel/task.c ****     } /* Endif */
1932:../MQXLITE/kernel/task.c **** 
1933:../MQXLITE/kernel/task.c ****     if (td_ptr->STATE == TASK_QUEUE_BLOCKED)
 1941              		.loc 1 1933 0
 1942 008c 3B6A     		ldr	r3, [r7, #32]
 1943 008e 9A68     		ldr	r2, [r3, #8]
 1944 0090 184B     		ldr	r3, .L107+4
 1945 0092 9A42     		cmp	r2, r3
 1946 0094 22D1     		bne	.L106
1934:../MQXLITE/kernel/task.c ****     {
1935:../MQXLITE/kernel/task.c ****         task_queue_ptr = (TASK_QUEUE_STRUCT_PTR)
1936:../MQXLITE/kernel/task.c ****                          ((uchar_ptr)td_ptr->INFO - FIELD_OFFSET(TASK_QUEUE_STRUCT, TD_QUEUE));
 1947              		.loc 1 1936 0
 1948 0096 3B6A     		ldr	r3, [r7, #32]
 1949 0098 DB6A     		ldr	r3, [r3, #44]
 1950 009a 103B     		sub	r3, r3, #16
1935:../MQXLITE/kernel/task.c ****         task_queue_ptr = (TASK_QUEUE_STRUCT_PTR)
 1951              		.loc 1 1935 0
 1952 009c BB61     		str	r3, [r7, #24]
1937:../MQXLITE/kernel/task.c ****         if (task_queue_ptr->POLICY & MQX_TASK_QUEUE_BY_PRIORITY)
 1953              		.loc 1 1937 0
 1954 009e BB69     		ldr	r3, [r7, #24]
 1955 00a0 DA68     		ldr	r2, [r3, #12]
 1956 00a2 0823     		mov	r3, #8
 1957 00a4 1340     		and	r3, r2
 1958 00a6 19D0     		beq	.L106
 1959              	.LBB12:
1938:../MQXLITE/kernel/task.c ****         {
1939:../MQXLITE/kernel/task.c ****             /* Requeue the td by priority */
1940:../MQXLITE/kernel/task.c ****             _QUEUE_REMOVE(&task_queue_ptr->TD_QUEUE, td_ptr);
 1960              		.loc 1 1940 0
 1961 00a8 3B6A     		ldr	r3, [r7, #32]
 1962 00aa 5B68     		ldr	r3, [r3, #4]
 1963 00ac 7B61     		str	r3, [r7, #20]
 1964 00ae 3B6A     		ldr	r3, [r7, #32]
 1965 00b0 1B68     		ldr	r3, [r3]
 1966 00b2 3B61     		str	r3, [r7, #16]
 1967 00b4 7B69     		ldr	r3, [r7, #20]
 1968 00b6 3A69     		ldr	r2, [r7, #16]
 1969 00b8 1A60     		str	r2, [r3]
 1970 00ba 3B69     		ldr	r3, [r7, #16]
 1971 00bc 7A69     		ldr	r2, [r7, #20]
 1972 00be 5A60     		str	r2, [r3, #4]
 1973              	.LBE12:
 1974 00c0 BB69     		ldr	r3, [r7, #24]
 1975 00c2 1033     		add	r3, r3, #16
 1976 00c4 1A89     		ldrh	r2, [r3, #8]
 1977 00c6 013A     		sub	r2, r2, #1
 1978 00c8 92B2     		uxth	r2, r2
 1979 00ca 1A81     		strh	r2, [r3, #8]
1941:../MQXLITE/kernel/task.c ****             _sched_insert_priorityq_internal(&task_queue_ptr->TD_QUEUE, td_ptr);
 1980              		.loc 1 1941 0
 1981 00cc BB69     		ldr	r3, [r7, #24]
 1982 00ce 1A1C     		mov	r2, r3
 1983 00d0 1032     		add	r2, r2, #16
 1984 00d2 3B6A     		ldr	r3, [r7, #32]
 1985 00d4 101C     		mov	r0, r2
 1986 00d6 191C     		mov	r1, r3
 1987 00d8 FFF7FEFF 		bl	_sched_insert_priorityq_internal
 1988              	.L106:
1942:../MQXLITE/kernel/task.c ****         }/* Endif */
1943:../MQXLITE/kernel/task.c ****     }/* Endif */
1944:../MQXLITE/kernel/task.c **** 
1945:../MQXLITE/kernel/task.c ****     /* Allow higher priority tasks to run */
1946:../MQXLITE/kernel/task.c ****     _CHECK_RUN_SCHEDULER();
 1989              		.loc 1 1946 0
 1990 00dc FFF7FEFF 		bl	_sched_check_scheduler_internal
1947:../MQXLITE/kernel/task.c **** 
1948:../MQXLITE/kernel/task.c ****     _int_enable();
 1991              		.loc 1 1948 0
 1992 00e0 FFF7FEFF 		bl	_int_enable
1949:../MQXLITE/kernel/task.c **** 
1950:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_priority, MQX_OK);
1951:../MQXLITE/kernel/task.c ****     return MQX_OK;
 1993              		.loc 1 1951 0
 1994 00e4 0023     		mov	r3, #0
 1995              	.L102:
1952:../MQXLITE/kernel/task.c **** 
1953:../MQXLITE/kernel/task.c **** } /* Endbody */
 1996              		.loc 1 1953 0
 1997 00e6 181C     		mov	r0, r3
 1998 00e8 BD46     		mov	sp, r7
 1999 00ea 0AB0     		add	sp, sp, #40
 2000              		@ sp needed for prologue
 2001 00ec 80BD     		pop	{r7, pc}
 2002              	.L108:
 2003 00ee C046     		.align	2
 2004              	.L107:
 2005 00f0 00000000 		.word	_mqx_kernel_data
 2006 00f4 29020000 		.word	553
 2007              		.cfi_endproc
 2008              	.LFE21:
 2010              		.section	.text._task_ready,"ax",%progbits
 2011              		.align	2
 2012              		.global	_task_ready
 2013              		.code	16
 2014              		.thumb_func
 2016              	_task_ready:
 2017              	.LFB22:
1954:../MQXLITE/kernel/task.c **** 
1955:../MQXLITE/kernel/task.c **** #endif /* MQX_HAS_DYNAMIC_PRIORITIES */
1956:../MQXLITE/kernel/task.c **** 
1957:../MQXLITE/kernel/task.c **** /*!
1958:../MQXLITE/kernel/task.c ****  * \brief Makes the task ready to run by putting it in its ready queue.
1959:../MQXLITE/kernel/task.c ****  *
1960:../MQXLITE/kernel/task.c ****  * This function is the only way to make ready a task that called _task_block().
1961:../MQXLITE/kernel/task.c ****  *
1962:../MQXLITE/kernel/task.c ****  * \param[in] td Pointer to the task descriptor of the task (on this processor)
1963:../MQXLITE/kernel/task.c ****  * to be made ready.
1964:../MQXLITE/kernel/task.c ****  *
1965:../MQXLITE/kernel/task.c ****  * \warning If the new ready task has higher priority than the calling task,
1966:../MQXLITE/kernel/task.c ****  * MQX makes the new ready task active.
1967:../MQXLITE/kernel/task.c ****  * \warning Might set one of the following task error codes:
1968:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_TASK_ID (Task_id is not valid for this processor.)
1969:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_TASK_STATE (Task is already in its ready queue.)
1970:../MQXLITE/kernel/task.c ****  *
1971:../MQXLITE/kernel/task.c ****  * \see _task_block
1972:../MQXLITE/kernel/task.c ****  * \see _time_dequeue
1973:../MQXLITE/kernel/task.c ****  * \see _taskq_resume
1974:../MQXLITE/kernel/task.c ****  */
1975:../MQXLITE/kernel/task.c **** void _task_ready
1976:../MQXLITE/kernel/task.c **** (
1977:../MQXLITE/kernel/task.c ****     pointer td
1978:../MQXLITE/kernel/task.c **** )
1979:../MQXLITE/kernel/task.c **** {
 2018              		.loc 1 1979 0
 2019              		.cfi_startproc
 2020 0000 80B5     		push	{r7, lr}
 2021              	.LCFI66:
 2022              		.cfi_def_cfa_offset 8
 2023              		.cfi_offset 7, -8
 2024              		.cfi_offset 14, -4
 2025 0002 84B0     		sub	sp, sp, #16
 2026              	.LCFI67:
 2027              		.cfi_def_cfa_offset 24
 2028 0004 00AF     		add	r7, sp, #0
 2029              	.LCFI68:
 2030              		.cfi_def_cfa_register 7
 2031 0006 7860     		str	r0, [r7, #4]
1980:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR  kernel_data;
1981:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr = (TD_STRUCT_PTR)td;
 2032              		.loc 1 1981 0
 2033 0008 7B68     		ldr	r3, [r7, #4]
 2034 000a FB60     		str	r3, [r7, #12]
1982:../MQXLITE/kernel/task.c **** 
1983:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE && MQX_ENABLE_USER_STDAPI
1984:../MQXLITE/kernel/task.c ****     if (MQX_RUN_IN_USER_MODE)
1985:../MQXLITE/kernel/task.c ****     {
1986:../MQXLITE/kernel/task.c ****         _usr_task_ready(td);
1987:../MQXLITE/kernel/task.c ****         return;
1988:../MQXLITE/kernel/task.c ****     }
1989:../MQXLITE/kernel/task.c **** #endif
1990:../MQXLITE/kernel/task.c **** 
1991:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2035              		.loc 1 1991 0
 2036 000c 214B     		ldr	r3, .L116
 2037 000e 1B68     		ldr	r3, [r3]
 2038 0010 BB60     		str	r3, [r7, #8]
1992:../MQXLITE/kernel/task.c **** 
1993:../MQXLITE/kernel/task.c ****     /* Perform a validity check on the td */
1994:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
1995:../MQXLITE/kernel/task.c ****     if (PROC_NUMBER_FROM_TASKID(td_ptr->TASK_ID) != kernel_data->INIT.PROCESSOR_NUMBER)
 2039              		.loc 1 1995 0
 2040 0012 FB68     		ldr	r3, [r7, #12]
 2041 0014 DB68     		ldr	r3, [r3, #12]
 2042 0016 1B0C     		lsr	r3, r3, #16
 2043 0018 9BB2     		uxth	r3, r3
 2044 001a 1A1C     		mov	r2, r3
 2045 001c B968     		ldr	r1, [r7, #8]
 2046 001e A823     		mov	r3, #168
 2047 0020 5B00     		lsl	r3, r3, #1
 2048 0022 CB58     		ldr	r3, [r1, r3]
 2049 0024 9A42     		cmp	r2, r3
 2050 0026 03D0     		beq	.L110
1996:../MQXLITE/kernel/task.c ****     {
1997:../MQXLITE/kernel/task.c ****         _KLOGE2(KLOG_task_ready, td_ptr);
1998:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_ID);
 2051              		.loc 1 1998 0
 2052 0028 1220     		mov	r0, #18
 2053 002a FFF7FEFF 		bl	_task_set_error
1999:../MQXLITE/kernel/task.c ****         _KLOGX1(KLOG_task_ready);
2000:../MQXLITE/kernel/task.c ****         return;
 2054              		.loc 1 2000 0
 2055 002e 2EE0     		b	.L109
 2056              	.L110:
2001:../MQXLITE/kernel/task.c ****     }
2002:../MQXLITE/kernel/task.c **** #endif
2003:../MQXLITE/kernel/task.c **** 
2004:../MQXLITE/kernel/task.c ****     _INT_DISABLE();
 2057              		.loc 1 2004 0
 2058 0030 BB68     		ldr	r3, [r7, #8]
 2059 0032 DB69     		ldr	r3, [r3, #28]
 2060 0034 9B6C     		ldr	r3, [r3, #72]
 2061 0036 002B     		cmp	r3, #0
 2062 0038 00D1     		bne	.L112
 2063              		.loc 1 2004 0 is_stmt 0 discriminator 1
 2064              	@ 2004 "../MQXLITE/kernel/task.c" 1
 2065 003a 72B6     		cpsid i
 2066              	@ 0 "" 2
 2067              		.code	16
 2068              	.L112:
 2069              		.loc 1 2004 0 discriminator 2
 2070 003c BB68     		ldr	r3, [r7, #8]
 2071 003e DB69     		ldr	r3, [r3, #28]
 2072 0040 9A6C     		ldr	r2, [r3, #72]
 2073 0042 0132     		add	r2, r2, #1
 2074 0044 9A64     		str	r2, [r3, #72]
2005:../MQXLITE/kernel/task.c **** 
2006:../MQXLITE/kernel/task.c ****     if (td_ptr->STATE == READY)
 2075              		.loc 1 2006 0 is_stmt 1 discriminator 2
 2076 0046 FB68     		ldr	r3, [r7, #12]
 2077 0048 9B68     		ldr	r3, [r3, #8]
 2078 004a 022B     		cmp	r3, #2
 2079 004c 05D1     		bne	.L113
2007:../MQXLITE/kernel/task.c ****     {
2008:../MQXLITE/kernel/task.c ****         /* The task is already on the ready to run Queue! */
2009:../MQXLITE/kernel/task.c ****         _int_enable();
 2080              		.loc 1 2009 0
 2081 004e FFF7FEFF 		bl	_int_enable
2010:../MQXLITE/kernel/task.c ****         _KLOGE2(KLOG_task_ready, td_ptr);
2011:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_INVALID_TASK_STATE);
 2082              		.loc 1 2011 0
 2083 0052 1120     		mov	r0, #17
 2084 0054 FFF7FEFF 		bl	_task_set_error
2012:../MQXLITE/kernel/task.c ****         _KLOGX1(KLOG_task_ready);
2013:../MQXLITE/kernel/task.c ****         return;
 2085              		.loc 1 2013 0
 2086 0058 19E0     		b	.L109
 2087              	.L113:
2014:../MQXLITE/kernel/task.c ****     }/* Endif */
2015:../MQXLITE/kernel/task.c **** 
2016:../MQXLITE/kernel/task.c ****     _task_ready_internal(td_ptr);
 2088              		.loc 1 2016 0
 2089 005a FB68     		ldr	r3, [r7, #12]
 2090 005c 181C     		mov	r0, r3
 2091 005e FFF7FEFF 		bl	_task_ready_internal
2017:../MQXLITE/kernel/task.c **** 
2018:../MQXLITE/kernel/task.c ****     _INT_ENABLE();
 2092              		.loc 1 2018 0
 2093 0062 BB68     		ldr	r3, [r7, #8]
 2094 0064 DB69     		ldr	r3, [r3, #28]
 2095 0066 9B6C     		ldr	r3, [r3, #72]
 2096 0068 002B     		cmp	r3, #0
 2097 006a 0ED0     		beq	.L114
 2098              		.loc 1 2018 0 is_stmt 0 discriminator 1
 2099 006c BB68     		ldr	r3, [r7, #8]
 2100 006e DB69     		ldr	r3, [r3, #28]
 2101 0070 9A6C     		ldr	r2, [r3, #72]
 2102 0072 013A     		sub	r2, r2, #1
 2103 0074 9A64     		str	r2, [r3, #72]
 2104 0076 9B6C     		ldr	r3, [r3, #72]
 2105 0078 002B     		cmp	r3, #0
 2106 007a 06D1     		bne	.L114
 2107              		.loc 1 2018 0 discriminator 2
 2108 007c BB68     		ldr	r3, [r7, #8]
 2109 007e 1B8B     		ldrh	r3, [r3, #24]
 2110 0080 002B     		cmp	r3, #0
 2111 0082 01D0     		beq	.L115
 2112              		.loc 1 2018 0 discriminator 3
 2113              	@ 2018 "../MQXLITE/kernel/task.c" 1
 2114 0084 62B6     		cpsie i
 2115              	@ 0 "" 2
 2116              		.code	16
 2117 0086 00E0     		b	.L114
 2118              	.L115:
 2119              		.loc 1 2018 0 discriminator 4
 2120              	@ 2018 "../MQXLITE/kernel/task.c" 1
 2121 0088 62B6     		cpsie i
 2122              	@ 0 "" 2
 2123              		.code	16
 2124              	.L114:
2019:../MQXLITE/kernel/task.c **** 
2020:../MQXLITE/kernel/task.c ****     _CHECK_RUN_SCHEDULER(); /* Let higher priority task run */
 2125              		.loc 1 2020 0 is_stmt 1
 2126 008a FFF7FEFF 		bl	_sched_check_scheduler_internal
 2127              	.L109:
2021:../MQXLITE/kernel/task.c **** }
 2128              		.loc 1 2021 0
 2129 008e BD46     		mov	sp, r7
 2130 0090 04B0     		add	sp, sp, #16
 2131              		@ sp needed for prologue
 2132 0092 80BD     		pop	{r7, pc}
 2133              	.L117:
 2134              		.align	2
 2135              	.L116:
 2136 0094 00000000 		.word	_mqx_kernel_data
 2137              		.cfi_endproc
 2138              	.LFE22:
 2140              		.section	.text._task_restart_func,"ax",%progbits
 2141              		.align	2
 2142              		.code	16
 2143              		.thumb_func
 2145              	_task_restart_func:
 2146              	.LFB23:
2022:../MQXLITE/kernel/task.c **** 
2023:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
2024:../MQXLITE/kernel/task.c **** 
2025:../MQXLITE/kernel/task.c **** /*!
2026:../MQXLITE/kernel/task.c ****  * \brief Makes the task ready to run by putting it in its ready queue.
2027:../MQXLITE/kernel/task.c ****  *
2028:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_ready() API call but it can be
2029:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
2030:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
2031:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
2032:../MQXLITE/kernel/task.c ****  *
2033:../MQXLITE/kernel/task.c ****  * \param[in] td Pointer to the task descriptor of the task (on this processor)
2034:../MQXLITE/kernel/task.c ****  * to be made ready.
2035:../MQXLITE/kernel/task.c ****  *
2036:../MQXLITE/kernel/task.c ****  * \warning If the new ready task has higher priority than the calling task,
2037:../MQXLITE/kernel/task.c ****  * MQX makes the new ready task active.
2038:../MQXLITE/kernel/task.c ****  * \warning Might set one of the following task error codes:
2039:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_TASK_ID (Task_id is not valid for this processor.)
2040:../MQXLITE/kernel/task.c ****  * \n - MQX_INVALID_TASK_STATE (Task is already in its ready queue.)
2041:../MQXLITE/kernel/task.c ****  *
2042:../MQXLITE/kernel/task.c ****  * \see _task_ready
2043:../MQXLITE/kernel/task.c ****  */
2044:../MQXLITE/kernel/task.c **** void _usr_task_ready
2045:../MQXLITE/kernel/task.c **** (
2046:../MQXLITE/kernel/task.c ****     pointer td
2047:../MQXLITE/kernel/task.c **** )
2048:../MQXLITE/kernel/task.c **** {
2049:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params = {(uint_32)td, 0, 0, 0, 0};
2050:../MQXLITE/kernel/task.c ****     _mqx_api_call(MQX_API_TASK_READY, &params);
2051:../MQXLITE/kernel/task.c **** }
2052:../MQXLITE/kernel/task.c **** 
2053:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
2054:../MQXLITE/kernel/task.c **** 
2055:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TASK_TEMPLATE_PTR
2056:../MQXLITE/kernel/task.c **** 
2057:../MQXLITE/kernel/task.c **** /*!
2058:../MQXLITE/kernel/task.c ****  * \brief Restart the specified task.
2059:../MQXLITE/kernel/task.c ****  *
2060:../MQXLITE/kernel/task.c ****  * Restart the task specified by the given task_id (the victim).
2061:../MQXLITE/kernel/task.c ****  * \n All of the victim's resources are released, specifically all queues are
2062:../MQXLITE/kernel/task.c ****  * closed and all memory is freed.
2063:../MQXLITE/kernel/task.c ****  * \n Component cleanup functions are called to free any component resources
2064:../MQXLITE/kernel/task.c ****  * owned by this task.
2065:../MQXLITE/kernel/task.c ****  *
2066:../MQXLITE/kernel/task.c ****  * \param[in] task_id   Task ID of the task to restart.
2067:../MQXLITE/kernel/task.c ****  * \param[in] param_ptr One of the following:
2068:../MQXLITE/kernel/task.c ****  * \n - Pointer to a new task creation parameter.
2069:../MQXLITE/kernel/task.c ****  * \n - NULL (victim's creation parameter used).
2070:../MQXLITE/kernel/task.c ****  * \param[in] blocked   Whether the task should be restarted in the blocked state or not.
2071:../MQXLITE/kernel/task.c ****  *
2072:../MQXLITE/kernel/task.c ****  * \return MQX_OK
2073:../MQXLITE/kernel/task.c ****  * \return MQX_CANNOT_CALL_FUNCTION_FROM_ISR (Function cannot be called from an ISR.)
2074:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID (Task_id is invalid.)
2075:../MQXLITE/kernel/task.c ****  * \return MQX_OUT_OF_MEMORY (Not enough memory to rebuild stack.)
2076:../MQXLITE/kernel/task.c ****  *
2077:../MQXLITE/kernel/task.c ****  * \warning Cannot be called from an ISR.
2078:../MQXLITE/kernel/task.c ****  *
2079:../MQXLITE/kernel/task.c ****  * \see _task_create
2080:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
2081:../MQXLITE/kernel/task.c ****  * \see _task_create_at
2082:../MQXLITE/kernel/task.c ****  */
2083:../MQXLITE/kernel/task.c **** static _mqx_uint _task_restart_func
2084:../MQXLITE/kernel/task.c **** (
2085:../MQXLITE/kernel/task.c ****     _task_id    task_id,
2086:../MQXLITE/kernel/task.c ****     uint_32_ptr param_ptr,
2087:../MQXLITE/kernel/task.c ****     boolean     blocked
2088:../MQXLITE/kernel/task.c **** )
2089:../MQXLITE/kernel/task.c **** { /* Body */
 2147              		.loc 1 2089 0
 2148              		.cfi_startproc
 2149 0000 90B5     		push	{r4, r7, lr}
 2150              	.LCFI69:
 2151              		.cfi_def_cfa_offset 12
 2152              		.cfi_offset 4, -12
 2153              		.cfi_offset 7, -8
 2154              		.cfi_offset 14, -4
 2155 0002 9DB0     		sub	sp, sp, #116
 2156              	.LCFI70:
 2157              		.cfi_def_cfa_offset 128
 2158 0004 02AF     		add	r7, sp, #8
 2159              	.LCFI71:
 2160              		.cfi_def_cfa 7, 120
 2161 0006 F860     		str	r0, [r7, #12]
 2162 0008 B960     		str	r1, [r7, #8]
 2163 000a 7A60     		str	r2, [r7, #4]
2090:../MQXLITE/kernel/task.c ****     PSP_STACK_START_STRUCT_PTR  stack_start_ptr;
2091:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR      kernel_data;
2092:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR    template_ptr;
2093:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               victim_ptr;
2094:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               td_ptr;
2095:../MQXLITE/kernel/task.c ****     READY_Q_STRUCT_PTR          ready_q_ptr;
2096:../MQXLITE/kernel/task.c ****     char_ptr                    stack_ptr;
2097:../MQXLITE/kernel/task.c ****     uint_32                     create_param;
2098:../MQXLITE/kernel/task.c ****     _processor_number           processor;
2099:../MQXLITE/kernel/task.c ****     _mem_size                   stack_size;
2100:../MQXLITE/kernel/task.c **** 
2101:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2164              		.loc 1 2101 0
 2165 000c AE4B     		ldr	r3, .L143
 2166 000e 1B68     		ldr	r3, [r3]
 2167 0010 7B65     		str	r3, [r7, #84]
2102:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_restart, task_id);
2103:../MQXLITE/kernel/task.c **** 
2104:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
2105:../MQXLITE/kernel/task.c ****     if (kernel_data->IN_ISR)
 2168              		.loc 1 2105 0
 2169 0012 7B6D     		ldr	r3, [r7, #84]
 2170 0014 1B8B     		ldrh	r3, [r3, #24]
 2171 0016 002B     		cmp	r3, #0
 2172 0018 01D0     		beq	.L119
2106:../MQXLITE/kernel/task.c ****     {
2107:../MQXLITE/kernel/task.c ****         /* Cannot be called from an ISR */
2108:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_restart, MQX_CANNOT_CALL_FUNCTION_FROM_ISR);
2109:../MQXLITE/kernel/task.c ****         return(MQX_CANNOT_CALL_FUNCTION_FROM_ISR);
 2173              		.loc 1 2109 0
 2174 001a 0D23     		mov	r3, #13
 2175 001c 4FE1     		b	.L120
 2176              	.L119:
2110:../MQXLITE/kernel/task.c ****     } /* Endif */
2111:../MQXLITE/kernel/task.c **** #endif
2112:../MQXLITE/kernel/task.c **** 
2113:../MQXLITE/kernel/task.c ****     if (task_id != MQX_NULL_TASK_ID)
 2177              		.loc 1 2113 0
 2178 001e FB68     		ldr	r3, [r7, #12]
 2179 0020 002B     		cmp	r3, #0
 2180 0022 10D0     		beq	.L121
2114:../MQXLITE/kernel/task.c ****     {
2115:../MQXLITE/kernel/task.c ****         processor = PROC_NUMBER_FROM_TASKID(task_id);
 2181              		.loc 1 2115 0
 2182 0024 FB68     		ldr	r3, [r7, #12]
 2183 0026 1A0C     		lsr	r2, r3, #16
 2184 0028 3B1C     		mov	r3, r7
 2185 002a 5233     		add	r3, r3, #82
 2186 002c 1A80     		strh	r2, [r3]
2116:../MQXLITE/kernel/task.c ****         if (processor != (_processor_number)kernel_data->INIT.PROCESSOR_NUMBER )
 2187              		.loc 1 2116 0
 2188 002e 7A6D     		ldr	r2, [r7, #84]
 2189 0030 A823     		mov	r3, #168
 2190 0032 5B00     		lsl	r3, r3, #1
 2191 0034 D358     		ldr	r3, [r2, r3]
 2192 0036 9BB2     		uxth	r3, r3
 2193 0038 3A1C     		mov	r2, r7
 2194 003a 5232     		add	r2, r2, #82
 2195 003c 1288     		ldrh	r2, [r2]
 2196 003e 9A42     		cmp	r2, r3
 2197 0040 01D0     		beq	.L121
2117:../MQXLITE/kernel/task.c ****         {
2118:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
2119:../MQXLITE/kernel/task.c ****             if ( kernel_data->IPC != NULL )
2120:../MQXLITE/kernel/task.c ****             {
2121:../MQXLITE/kernel/task.c ****                 _KLOGX2(KLOG_task_restart, MQX_OK);
2122:../MQXLITE/kernel/task.c ****                 return( (*kernel_data->IPC)(FALSE, processor,
2123:../MQXLITE/kernel/task.c ****                                 KERNEL_MESSAGES, IPC_TASK_RESTART, 3, (_mqx_uint)task_id,
2124:../MQXLITE/kernel/task.c ****                                 (_mqx_uint)param_ptr, (_mqx_uint)blocked));
2125:../MQXLITE/kernel/task.c ****             }
2126:../MQXLITE/kernel/task.c ****             else
2127:../MQXLITE/kernel/task.c ****             {
2128:../MQXLITE/kernel/task.c **** #endif
2129:../MQXLITE/kernel/task.c ****                 _KLOGX2(KLOG_task_restart, MQX_INVALID_TASK_ID);
2130:../MQXLITE/kernel/task.c ****                 return(MQX_INVALID_TASK_ID);
 2198              		.loc 1 2130 0
 2199 0042 1223     		mov	r3, #18
 2200 0044 3BE1     		b	.L120
 2201              	.L121:
2131:../MQXLITE/kernel/task.c **** #if MQX_IS_MULTI_PROCESSOR
2132:../MQXLITE/kernel/task.c ****             } /* Endif */
2133:../MQXLITE/kernel/task.c **** #endif
2134:../MQXLITE/kernel/task.c ****         }/* Endif */
2135:../MQXLITE/kernel/task.c ****     }/* Endif */
2136:../MQXLITE/kernel/task.c **** 
2137:../MQXLITE/kernel/task.c ****     victim_ptr = (TD_STRUCT_PTR)_task_get_td(task_id);
 2202              		.loc 1 2137 0
 2203 0046 FB68     		ldr	r3, [r7, #12]
 2204 0048 181C     		mov	r0, r3
 2205 004a FFF7FEFF 		bl	_task_get_td
 2206 004e 031C     		mov	r3, r0
 2207 0050 FB64     		str	r3, [r7, #76]
2138:../MQXLITE/kernel/task.c **** 
2139:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
2140:../MQXLITE/kernel/task.c ****     if (victim_ptr == NULL)
 2208              		.loc 1 2140 0
 2209 0052 FB6C     		ldr	r3, [r7, #76]
 2210 0054 002B     		cmp	r3, #0
 2211 0056 01D1     		bne	.L122
2141:../MQXLITE/kernel/task.c ****     {
2142:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_restart, MQX_INVALID_TASK_ID);
2143:../MQXLITE/kernel/task.c ****         return(MQX_INVALID_TASK_ID);
 2212              		.loc 1 2143 0
 2213 0058 1223     		mov	r3, #18
 2214 005a 30E1     		b	.L120
 2215              	.L122:
2144:../MQXLITE/kernel/task.c ****     } /* Endif */
2145:../MQXLITE/kernel/task.c **** 
2146:../MQXLITE/kernel/task.c ****     if (victim_ptr == SYSTEM_TD_PTR(kernel_data))
 2216              		.loc 1 2146 0
 2217 005c 7B6D     		ldr	r3, [r7, #84]
 2218 005e 1A1C     		mov	r2, r3
 2219 0060 4832     		add	r2, r2, #72
 2220 0062 FB6C     		ldr	r3, [r7, #76]
 2221 0064 9A42     		cmp	r2, r3
 2222 0066 01D1     		bne	.L123
2147:../MQXLITE/kernel/task.c ****     {
2148:../MQXLITE/kernel/task.c ****         _KLOGX2(KLOG_task_restart, MQX_INVALID_TASK_ID);
2149:../MQXLITE/kernel/task.c ****         return(MQX_INVALID_TASK_ID);
 2223              		.loc 1 2149 0
 2224 0068 1223     		mov	r3, #18
 2225 006a 28E1     		b	.L120
 2226              	.L123:
2150:../MQXLITE/kernel/task.c ****     } /* Endif */
2151:../MQXLITE/kernel/task.c **** #endif
2152:../MQXLITE/kernel/task.c **** 
2153:../MQXLITE/kernel/task.c ****     /* First, serialize task creation/destruction/restart */
2154:../MQXLITE/kernel/task.c ****     _lwsem_wait((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 2227              		.loc 1 2154 0
 2228 006c 7B6D     		ldr	r3, [r7, #84]
 2229 006e F433     		add	r3, r3, #244
 2230 0070 181C     		mov	r0, r3
 2231 0072 FFF7FEFF 		bl	_lwsem_wait
2155:../MQXLITE/kernel/task.c **** 
2156:../MQXLITE/kernel/task.c ****     _int_disable();
 2232              		.loc 1 2156 0
 2233 0076 FFF7FEFF 		bl	_int_disable
2157:../MQXLITE/kernel/task.c ****     /* remove the victim from any queues it may be in. */
2158:../MQXLITE/kernel/task.c ****     if (victim_ptr->STATE == READY)
 2234              		.loc 1 2158 0
 2235 007a FB6C     		ldr	r3, [r7, #76]
 2236 007c 9B68     		ldr	r3, [r3, #8]
 2237 007e 022B     		cmp	r3, #2
 2238 0080 11D1     		bne	.L124
2159:../MQXLITE/kernel/task.c ****     {
2160:../MQXLITE/kernel/task.c ****         if (victim_ptr != kernel_data->ACTIVE_PTR)
 2239              		.loc 1 2160 0
 2240 0082 7B6D     		ldr	r3, [r7, #84]
 2241 0084 DA69     		ldr	r2, [r3, #28]
 2242 0086 FB6C     		ldr	r3, [r7, #76]
 2243 0088 9A42     		cmp	r2, r3
 2244 008a 50D0     		beq	.L125
 2245              	.LBB13:
2161:../MQXLITE/kernel/task.c ****         {
2162:../MQXLITE/kernel/task.c ****             /* Remove other task from ready queue */
2163:../MQXLITE/kernel/task.c ****             _QUEUE_UNLINK(victim_ptr);
 2246              		.loc 1 2163 0
 2247 008c FB6C     		ldr	r3, [r7, #76]
 2248 008e 5B68     		ldr	r3, [r3, #4]
 2249 0090 BB64     		str	r3, [r7, #72]
 2250 0092 FB6C     		ldr	r3, [r7, #76]
 2251 0094 1B68     		ldr	r3, [r3]
 2252 0096 7B64     		str	r3, [r7, #68]
 2253 0098 BB6C     		ldr	r3, [r7, #72]
 2254 009a 7A6C     		ldr	r2, [r7, #68]
 2255 009c 1A60     		str	r2, [r3]
 2256 009e 7B6C     		ldr	r3, [r7, #68]
 2257 00a0 BA6C     		ldr	r2, [r7, #72]
 2258 00a2 5A60     		str	r2, [r3, #4]
 2259 00a4 43E0     		b	.L125
 2260              	.L124:
 2261              	.LBE13:
2164:../MQXLITE/kernel/task.c ****         } /* Endif */
2165:../MQXLITE/kernel/task.c ****     }
2166:../MQXLITE/kernel/task.c ****     else if (victim_ptr->STATE & IS_ON_TIMEOUT_Q)
 2262              		.loc 1 2166 0
 2263 00a6 FB6C     		ldr	r3, [r7, #76]
 2264 00a8 9A68     		ldr	r2, [r3, #8]
 2265 00aa 8023     		mov	r3, #128
 2266 00ac 5B00     		lsl	r3, r3, #1
 2267 00ae 1340     		and	r3, r2
 2268 00b0 25D0     		beq	.L126
2167:../MQXLITE/kernel/task.c ****     {
2168:../MQXLITE/kernel/task.c ****         /* Remove from time queue */
2169:../MQXLITE/kernel/task.c ****         _TIME_DEQUEUE(victim_ptr, kernel_data);
 2269              		.loc 1 2169 0
 2270 00b2 FB6C     		ldr	r3, [r7, #76]
 2271 00b4 9A68     		ldr	r2, [r3, #8]
 2272 00b6 8023     		mov	r3, #128
 2273 00b8 5B00     		lsl	r3, r3, #1
 2274 00ba 1340     		and	r3, r2
 2275 00bc 37D0     		beq	.L125
 2276              	.LBB14:
 2277              		.loc 1 2169 0 is_stmt 0 discriminator 1
 2278 00be FB6C     		ldr	r3, [r7, #76]
 2279 00c0 5B68     		ldr	r3, [r3, #4]
 2280 00c2 3B64     		str	r3, [r7, #64]
 2281 00c4 FB6C     		ldr	r3, [r7, #76]
 2282 00c6 1B68     		ldr	r3, [r3]
 2283 00c8 FB63     		str	r3, [r7, #60]
 2284 00ca 3B6C     		ldr	r3, [r7, #64]
 2285 00cc FA6B     		ldr	r2, [r7, #60]
 2286 00ce 1A60     		str	r2, [r3]
 2287 00d0 FB6B     		ldr	r3, [r7, #60]
 2288 00d2 3A6C     		ldr	r2, [r7, #64]
 2289 00d4 5A60     		str	r2, [r3, #4]
 2290              	.LBE14:
 2291 00d6 7B6D     		ldr	r3, [r7, #84]
 2292 00d8 2933     		add	r3, r3, #41
 2293 00da FF33     		add	r3, r3, #255
 2294 00dc 1A89     		ldrh	r2, [r3, #8]
 2295 00de 013A     		sub	r2, r2, #1
 2296 00e0 92B2     		uxth	r2, r2
 2297 00e2 1A81     		strh	r2, [r3, #8]
 2298 00e4 FB6C     		ldr	r3, [r7, #76]
 2299 00e6 9A68     		ldr	r2, [r3, #8]
 2300 00e8 784B     		ldr	r3, .L143+4
 2301 00ea 1A40     		and	r2, r3
 2302 00ec FB6C     		ldr	r3, [r7, #76]
 2303 00ee 9A60     		str	r2, [r3, #8]
 2304 00f0 FB6C     		ldr	r3, [r7, #76]
 2305 00f2 9B68     		ldr	r3, [r3, #8]
 2306 00f4 0322     		mov	r2, #3
 2307 00f6 1A43     		orr	r2, r3
 2308 00f8 FB6C     		ldr	r3, [r7, #76]
 2309 00fa 9A60     		str	r2, [r3, #8]
 2310 00fc 17E0     		b	.L125
 2311              	.L126:
2170:../MQXLITE/kernel/task.c ****     }
2171:../MQXLITE/kernel/task.c ****     else if (victim_ptr->STATE & TD_IS_ON_QUEUE)
 2312              		.loc 1 2171 0 is_stmt 1
 2313 00fe FB6C     		ldr	r3, [r7, #76]
 2314 0100 9A68     		ldr	r2, [r3, #8]
 2315 0102 8023     		mov	r3, #128
 2316 0104 9B00     		lsl	r3, r3, #2
 2317 0106 1340     		and	r3, r2
 2318 0108 11D0     		beq	.L125
 2319              	.LBB15:
2172:../MQXLITE/kernel/task.c ****     {
2173:../MQXLITE/kernel/task.c ****         /* Remove from queue, where suspended
2174:../MQXLITE/kernel/task.c ****          * eg, MUTEX_BLOCKED, IO_BLOCKED, TASKQ_BLOCKED
2175:../MQXLITE/kernel/task.c ****          */
2176:../MQXLITE/kernel/task.c ****         _QUEUE_REMOVE(victim_ptr->INFO, victim_ptr);
 2320              		.loc 1 2176 0
 2321 010a FB6C     		ldr	r3, [r7, #76]
 2322 010c 5B68     		ldr	r3, [r3, #4]
 2323 010e BB63     		str	r3, [r7, #56]
 2324 0110 FB6C     		ldr	r3, [r7, #76]
 2325 0112 1B68     		ldr	r3, [r3]
 2326 0114 7B63     		str	r3, [r7, #52]
 2327 0116 BB6B     		ldr	r3, [r7, #56]
 2328 0118 7A6B     		ldr	r2, [r7, #52]
 2329 011a 1A60     		str	r2, [r3]
 2330 011c 7B6B     		ldr	r3, [r7, #52]
 2331 011e BA6B     		ldr	r2, [r7, #56]
 2332 0120 5A60     		str	r2, [r3, #4]
 2333              	.LBE15:
 2334 0122 FB6C     		ldr	r3, [r7, #76]
 2335 0124 DB6A     		ldr	r3, [r3, #44]
 2336 0126 1A89     		ldrh	r2, [r3, #8]
 2337 0128 013A     		sub	r2, r2, #1
 2338 012a 92B2     		uxth	r2, r2
 2339 012c 1A81     		strh	r2, [r3, #8]
 2340              	.L125:
2177:../MQXLITE/kernel/task.c ****     } /* Endif */
2178:../MQXLITE/kernel/task.c **** 
2179:../MQXLITE/kernel/task.c ****     if (victim_ptr->STATE & TD_IS_ON_AUX_QUEUE)
 2341              		.loc 1 2179 0
 2342 012e FB6C     		ldr	r3, [r7, #76]
 2343 0130 9A68     		ldr	r2, [r3, #8]
 2344 0132 8023     		mov	r3, #128
 2345 0134 DB00     		lsl	r3, r3, #3
 2346 0136 1340     		and	r3, r2
 2347 0138 13D0     		beq	.L127
 2348              	.LBB16:
2180:../MQXLITE/kernel/task.c ****     {
2181:../MQXLITE/kernel/task.c ****         /*
2182:../MQXLITE/kernel/task.c ****          * Remove from queue, where suspended
2183:../MQXLITE/kernel/task.c ****          * eg, LWSEM_BLOCKED
2184:../MQXLITE/kernel/task.c ****          * (uses AUX_QUEUE field)
2185:../MQXLITE/kernel/task.c ****          */
2186:../MQXLITE/kernel/task.c ****         _QUEUE_REMOVE(victim_ptr->INFO, &victim_ptr->AUX_QUEUE);
 2349              		.loc 1 2186 0
 2350 013a FB6C     		ldr	r3, [r7, #76]
 2351 013c 3033     		add	r3, r3, #48
 2352 013e 5B68     		ldr	r3, [r3, #4]
 2353 0140 3B63     		str	r3, [r7, #48]
 2354 0142 FB6C     		ldr	r3, [r7, #76]
 2355 0144 3033     		add	r3, r3, #48
 2356 0146 1B68     		ldr	r3, [r3]
 2357 0148 FB62     		str	r3, [r7, #44]
 2358 014a 3B6B     		ldr	r3, [r7, #48]
 2359 014c FA6A     		ldr	r2, [r7, #44]
 2360 014e 1A60     		str	r2, [r3]
 2361 0150 FB6A     		ldr	r3, [r7, #44]
 2362 0152 3A6B     		ldr	r2, [r7, #48]
 2363 0154 5A60     		str	r2, [r3, #4]
 2364              	.LBE16:
 2365 0156 FB6C     		ldr	r3, [r7, #76]
 2366 0158 DB6A     		ldr	r3, [r3, #44]
 2367 015a 1A89     		ldrh	r2, [r3, #8]
 2368 015c 013A     		sub	r2, r2, #1
 2369 015e 92B2     		uxth	r2, r2
 2370 0160 1A81     		strh	r2, [r3, #8]
 2371              	.L127:
2187:../MQXLITE/kernel/task.c ****     } /* Endif */
2188:../MQXLITE/kernel/task.c **** 
2189:../MQXLITE/kernel/task.c ****     victim_ptr->STATE   = DYING;
 2372              		.loc 1 2189 0
 2373 0162 FB6C     		ldr	r3, [r7, #76]
 2374 0164 0922     		mov	r2, #9
 2375 0166 9A60     		str	r2, [r3, #8]
2190:../MQXLITE/kernel/task.c **** 
2191:../MQXLITE/kernel/task.c **** #if MQXCFG_ENABLE_FP && PSP_HAS_FPU
2192:../MQXLITE/kernel/task.c ****     /* Stop Floating point context monitoring */
2193:../MQXLITE/kernel/task.c ****     if (kernel_data->FP_ACTIVE_PTR == victim_ptr)
2194:../MQXLITE/kernel/task.c ****     {
2195:../MQXLITE/kernel/task.c ****         kernel_data->FP_ACTIVE_PTR = NULL;
2196:../MQXLITE/kernel/task.c ****     }/* Endif */
2197:../MQXLITE/kernel/task.c **** #endif
2198:../MQXLITE/kernel/task.c **** 
2199:../MQXLITE/kernel/task.c ****     _int_enable();
 2376              		.loc 1 2199 0
 2377 0168 FFF7FEFF 		bl	_int_enable
 2378              	.LBB17:
2200:../MQXLITE/kernel/task.c **** 
2201:../MQXLITE/kernel/task.c **** #if MQX_COMPONENT_DESTRUCTION
2202:../MQXLITE/kernel/task.c ****     {
2203:../MQXLITE/kernel/task.c ****         _mqx_uint   i;
2204:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i)
 2379              		.loc 1 2204 0
 2380 016c 0023     		mov	r3, #0
 2381 016e BB65     		str	r3, [r7, #88]
 2382 0170 11E0     		b	.L128
 2383              	.L130:
2205:../MQXLITE/kernel/task.c ****         {
2206:../MQXLITE/kernel/task.c ****             if (kernel_data->COMPONENT_CLEANUP[i] != NULL)
 2384              		.loc 1 2206 0
 2385 0172 7B6D     		ldr	r3, [r7, #84]
 2386 0174 BA6D     		ldr	r2, [r7, #88]
 2387 0176 7432     		add	r2, r2, #116
 2388 0178 9200     		lsl	r2, r2, #2
 2389 017a D358     		ldr	r3, [r2, r3]
 2390 017c 002B     		cmp	r3, #0
 2391 017e 07D0     		beq	.L129
2207:../MQXLITE/kernel/task.c ****             {
2208:../MQXLITE/kernel/task.c ****                 (*kernel_data->COMPONENT_CLEANUP[i])(victim_ptr);
 2392              		.loc 1 2208 0
 2393 0180 7B6D     		ldr	r3, [r7, #84]
 2394 0182 BA6D     		ldr	r2, [r7, #88]
 2395 0184 7432     		add	r2, r2, #116
 2396 0186 9200     		lsl	r2, r2, #2
 2397 0188 D358     		ldr	r3, [r2, r3]
 2398 018a FA6C     		ldr	r2, [r7, #76]
 2399 018c 101C     		mov	r0, r2
 2400 018e 9847     		blx	r3
 2401              	.L129:
2204:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i)
 2402              		.loc 1 2204 0
 2403 0190 BB6D     		ldr	r3, [r7, #88]
 2404 0192 0133     		add	r3, r3, #1
 2405 0194 BB65     		str	r3, [r7, #88]
 2406              	.L128:
2204:../MQXLITE/kernel/task.c ****         for (i = 0; i < MAX_KERNEL_COMPONENTS; ++i)
 2407              		.loc 1 2204 0 is_stmt 0 discriminator 1
 2408 0196 BB6D     		ldr	r3, [r7, #88]
 2409 0198 0F2B     		cmp	r3, #15
 2410 019a EAD9     		bls	.L130
 2411              	.LBE17:
2209:../MQXLITE/kernel/task.c ****             } /* Endif */
2210:../MQXLITE/kernel/task.c ****         } /* Endfor */
2211:../MQXLITE/kernel/task.c ****     }
2212:../MQXLITE/kernel/task.c **** #endif
2213:../MQXLITE/kernel/task.c **** 
2214:../MQXLITE/kernel/task.c ****     td_ptr = kernel_data->ACTIVE_PTR;
 2412              		.loc 1 2214 0 is_stmt 1
 2413 019c 7B6D     		ldr	r3, [r7, #84]
 2414 019e DB69     		ldr	r3, [r3, #28]
 2415 01a0 BB62     		str	r3, [r7, #40]
2215:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
2216:../MQXLITE/kernel/task.c ****     {
2217:../MQXLITE/kernel/task.c ****         pointer                     block_ptr;
2218:../MQXLITE/kernel/task.c ****         block_ptr = _mem_get_next_block_internal(victim_ptr, NULL);
2219:../MQXLITE/kernel/task.c ****         while (block_ptr != NULL)
2220:../MQXLITE/kernel/task.c ****         {
2221:../MQXLITE/kernel/task.c ****             if (block_ptr           == victim_ptr ||
2222:../MQXLITE/kernel/task.c ****                 MEM_TYPE_TD         == GET_MEMBLOCK_TYPE(block_ptr) ||
2223:../MQXLITE/kernel/task.c ****                 MEM_TYPE_TASK_STACK == GET_MEMBLOCK_TYPE(block_ptr))
2224:../MQXLITE/kernel/task.c ****             {
2225:../MQXLITE/kernel/task.c **** 
2226:../MQXLITE/kernel/task.c ****                 block_ptr = _mem_get_next_block_internal (victim_ptr, block_ptr);
2227:../MQXLITE/kernel/task.c ****                 if (block_ptr == victim_ptr)
2228:../MQXLITE/kernel/task.c ****                     break;
2229:../MQXLITE/kernel/task.c ****             }
2230:../MQXLITE/kernel/task.c ****             else
2231:../MQXLITE/kernel/task.c ****             {
2232:../MQXLITE/kernel/task.c ****                 _mem_transfer_td_internal(block_ptr, victim_ptr, td_ptr);
2233:../MQXLITE/kernel/task.c ****                 _mem_free(block_ptr);
2234:../MQXLITE/kernel/task.c ****                 block_ptr = _mem_get_next_block_internal (victim_ptr, NULL);
2235:../MQXLITE/kernel/task.c ****             }
2236:../MQXLITE/kernel/task.c ****         }
2237:../MQXLITE/kernel/task.c ****     }
2238:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
2239:../MQXLITE/kernel/task.c **** 
2240:../MQXLITE/kernel/task.c ****     /* Free up create/destroy/restart for other tasks */
2241:../MQXLITE/kernel/task.c ****     _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 2416              		.loc 1 2241 0
 2417 01a2 7B6D     		ldr	r3, [r7, #84]
 2418 01a4 F433     		add	r3, r3, #244
 2419 01a6 181C     		mov	r0, r3
 2420 01a8 FFF7FEFF 		bl	_lwsem_post
2242:../MQXLITE/kernel/task.c **** 
2243:../MQXLITE/kernel/task.c ****     template_ptr    = victim_ptr->TASK_TEMPLATE_PTR;
 2421              		.loc 1 2243 0
 2422 01ac FB6C     		ldr	r3, [r7, #76]
 2423 01ae 9B6D     		ldr	r3, [r3, #88]
 2424 01b0 7B62     		str	r3, [r7, #36]
2244:../MQXLITE/kernel/task.c ****     stack_start_ptr = _psp_get_stack_start(victim_ptr);
 2425              		.loc 1 2244 0
 2426 01b2 FB6C     		ldr	r3, [r7, #76]
 2427 01b4 181C     		mov	r0, r3
 2428 01b6 FFF7FEFF 		bl	_psp_get_stack_start
 2429 01ba 031C     		mov	r3, r0
 2430 01bc 3B62     		str	r3, [r7, #32]
2245:../MQXLITE/kernel/task.c ****     if (param_ptr == NULL)
 2431              		.loc 1 2245 0
 2432 01be BB68     		ldr	r3, [r7, #8]
 2433 01c0 002B     		cmp	r3, #0
 2434 01c2 03D1     		bne	.L131
2246:../MQXLITE/kernel/task.c ****     {
2247:../MQXLITE/kernel/task.c ****         create_param = stack_start_ptr->PARAMETER;
 2435              		.loc 1 2247 0
 2436 01c4 3B6A     		ldr	r3, [r7, #32]
 2437 01c6 DB6C     		ldr	r3, [r3, #76]
 2438 01c8 3B66     		str	r3, [r7, #96]
 2439 01ca 02E0     		b	.L132
 2440              	.L131:
2248:../MQXLITE/kernel/task.c ****     }
2249:../MQXLITE/kernel/task.c ****     else
2250:../MQXLITE/kernel/task.c ****     {
2251:../MQXLITE/kernel/task.c ****         create_param = *param_ptr;
 2441              		.loc 1 2251 0
 2442 01cc BB68     		ldr	r3, [r7, #8]
 2443 01ce 1B68     		ldr	r3, [r3]
 2444 01d0 3B66     		str	r3, [r7, #96]
 2445              	.L132:
2252:../MQXLITE/kernel/task.c ****     } /* Endif */
2253:../MQXLITE/kernel/task.c **** 
2254:../MQXLITE/kernel/task.c ****     if (victim_ptr->STACK_ALLOC_BLOCK)    {
 2446              		.loc 1 2254 0
 2447 01d2 FB6C     		ldr	r3, [r7, #76]
 2448 01d4 DB6E     		ldr	r3, [r3, #108]
 2449 01d6 002B     		cmp	r3, #0
 2450 01d8 03D0     		beq	.L133
2255:../MQXLITE/kernel/task.c ****         stack_ptr = victim_ptr->STACK_ALLOC_BLOCK;
 2451              		.loc 1 2255 0
 2452 01da FB6C     		ldr	r3, [r7, #76]
 2453 01dc DB6E     		ldr	r3, [r3, #108]
 2454 01de 7B66     		str	r3, [r7, #100]
 2455 01e0 02E0     		b	.L134
 2456              	.L133:
2256:../MQXLITE/kernel/task.c ****     }
2257:../MQXLITE/kernel/task.c ****     else    {
2258:../MQXLITE/kernel/task.c ****         stack_ptr = (char_ptr)victim_ptr + sizeof(TD_STRUCT);
 2457              		.loc 1 2258 0
 2458 01e2 FB6C     		ldr	r3, [r7, #76]
 2459 01e4 7033     		add	r3, r3, #112
 2460 01e6 7B66     		str	r3, [r7, #100]
 2461              	.L134:
2259:../MQXLITE/kernel/task.c ****     }
2260:../MQXLITE/kernel/task.c **** 
2261:../MQXLITE/kernel/task.c ****     if (stack_ptr == (pointer)template_ptr)
 2462              		.loc 1 2261 0
 2463 01e8 7A6E     		ldr	r2, [r7, #100]
 2464 01ea 7B6A     		ldr	r3, [r7, #36]
 2465 01ec 9A42     		cmp	r2, r3
 2466 01ee 02D1     		bne	.L135
2262:../MQXLITE/kernel/task.c ****     {
2263:../MQXLITE/kernel/task.c ****         /* task has been created with temporary template, copy of template is before stack in alloc
2264:../MQXLITE/kernel/task.c ****             stack_ptr +=  sizeof(TASK_TEMPLATE_STRUCT);
 2467              		.loc 1 2264 0
 2468 01f0 7B6E     		ldr	r3, [r7, #100]
 2469 01f2 1C33     		add	r3, r3, #28
 2470 01f4 7B66     		str	r3, [r7, #100]
 2471              	.L135:
2265:../MQXLITE/kernel/task.c ****     }
2266:../MQXLITE/kernel/task.c **** 
2267:../MQXLITE/kernel/task.c ****     stack_size = template_ptr->TASK_STACKSIZE;
 2472              		.loc 1 2267 0
 2473 01f6 7B6A     		ldr	r3, [r7, #36]
 2474 01f8 9B68     		ldr	r3, [r3, #8]
 2475 01fa FB65     		str	r3, [r7, #92]
2268:../MQXLITE/kernel/task.c ****     if ( stack_size <= PSP_MINSTACKSIZE  )
 2476              		.loc 1 2268 0
 2477 01fc FB6D     		ldr	r3, [r7, #92]
 2478 01fe 982B     		cmp	r3, #152
 2479 0200 01D8     		bhi	.L136
2269:../MQXLITE/kernel/task.c ****     {
2270:../MQXLITE/kernel/task.c ****         stack_size = PSP_MINSTACKSIZE;
 2480              		.loc 1 2270 0
 2481 0202 9823     		mov	r3, #152
 2482 0204 FB65     		str	r3, [r7, #92]
 2483              	.L136:
2271:../MQXLITE/kernel/task.c ****     } /* Endif */
2272:../MQXLITE/kernel/task.c **** 
2273:../MQXLITE/kernel/task.c ****     /* Make the size a multiple of the memory alignment */
2274:../MQXLITE/kernel/task.c ****     _MEMORY_ALIGN_VAL_LARGER(stack_size);
 2484              		.loc 1 2274 0
 2485 0206 FB6D     		ldr	r3, [r7, #92]
 2486 0208 0F33     		add	r3, r3, #15
 2487 020a 0F22     		mov	r2, #15
 2488 020c 9343     		bic	r3, r2
 2489 020e FB65     		str	r3, [r7, #92]
2275:../MQXLITE/kernel/task.c **** 
2276:../MQXLITE/kernel/task.c ****     ready_q_ptr = kernel_data->READY_Q_LIST - template_ptr->TASK_PRIORITY;
 2490              		.loc 1 2276 0
 2491 0210 7B6D     		ldr	r3, [r7, #84]
 2492 0212 1A6A     		ldr	r2, [r3, #32]
 2493 0214 7B6A     		ldr	r3, [r7, #36]
 2494 0216 DB68     		ldr	r3, [r3, #12]
 2495 0218 1B01     		lsl	r3, r3, #4
 2496 021a 5B42     		neg	r3, r3
 2497 021c D318     		add	r3, r2, r3
 2498 021e FB61     		str	r3, [r7, #28]
2277:../MQXLITE/kernel/task.c ****     victim_ptr->MY_QUEUE = ready_q_ptr;
 2499              		.loc 1 2277 0
 2500 0220 FB6C     		ldr	r3, [r7, #76]
 2501 0222 FA69     		ldr	r2, [r7, #28]
 2502 0224 DA61     		str	r2, [r3, #28]
2278:../MQXLITE/kernel/task.c **** #if MQX_HAS_DYNAMIC_PRIORITIES
2279:../MQXLITE/kernel/task.c ****     victim_ptr->HOME_QUEUE  = ready_q_ptr;
 2503              		.loc 1 2279 0
 2504 0226 FB6C     		ldr	r3, [r7, #76]
 2505 0228 FA69     		ldr	r2, [r7, #28]
 2506 022a 1A62     		str	r2, [r3, #32]
2280:../MQXLITE/kernel/task.c **** #endif
2281:../MQXLITE/kernel/task.c ****     victim_ptr->TASK_SR     = ready_q_ptr->ENABLE_SR;
 2507              		.loc 1 2281 0
 2508 022c FB69     		ldr	r3, [r7, #28]
 2509 022e 9A89     		ldrh	r2, [r3, #12]
 2510 0230 FB6C     		ldr	r3, [r7, #76]
 2511 0232 9A84     		strh	r2, [r3, #36]
2282:../MQXLITE/kernel/task.c ****     victim_ptr->FLAGS       = template_ptr->TASK_ATTRIBUTES;
 2512              		.loc 1 2282 0
 2513 0234 7B6A     		ldr	r3, [r7, #36]
 2514 0236 5A69     		ldr	r2, [r3, #20]
 2515 0238 FB6C     		ldr	r3, [r7, #76]
 2516 023a 9A62     		str	r2, [r3, #40]
2283:../MQXLITE/kernel/task.c **** 
2284:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
2285:../MQXLITE/kernel/task.c ****     if (template_ptr->TASK_ATTRIBUTES & MQX_USER_TASK)
2286:../MQXLITE/kernel/task.c ****     {
2287:../MQXLITE/kernel/task.c ****         victim_ptr->FLAGS |= TASK_USER_MODE;
2288:../MQXLITE/kernel/task.c ****     }
2289:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
2290:../MQXLITE/kernel/task.c **** 
2291:../MQXLITE/kernel/task.c **** #if MQX_HAS_TIME_SLICE
2292:../MQXLITE/kernel/task.c ****     /* Reset the time slice back to the default */
2293:../MQXLITE/kernel/task.c ****     if (template_ptr->DEFAULT_TIME_SLICE)
2294:../MQXLITE/kernel/task.c ****     {
2295:../MQXLITE/kernel/task.c **** #if (MQX_DEFAULT_TIME_SLICE_IN_TICKS == 0)
2296:../MQXLITE/kernel/task.c ****         uint_32 ticks;
2297:../MQXLITE/kernel/task.c **** 
2298:../MQXLITE/kernel/task.c ****         ticks = ((template_ptr->DEFAULT_TIME_SLICE * 2 *
2299:../MQXLITE/kernel/task.c ****                         kernel_data->TICKS_PER_SECOND) / 1000) / 2  /* Rounding.. */;
2300:../MQXLITE/kernel/task.c ****         PSP_ADD_TICKS_TO_TICK_STRUCT(&td_ptr->TIME_SLICE,
2301:../MQXLITE/kernel/task.c ****             ticks, &td_ptr->TIME_SLICE);
2302:../MQXLITE/kernel/task.c **** #else
2303:../MQXLITE/kernel/task.c ****         PSP_ADD_TICKS_TO_TICK_STRUCT(&victim_ptr->TIME_SLICE,
2304:../MQXLITE/kernel/task.c ****             template_ptr->DEFAULT_TIME_SLICE, &victim_ptr->TIME_SLICE);
2305:../MQXLITE/kernel/task.c **** #endif
2306:../MQXLITE/kernel/task.c ****     }
2307:../MQXLITE/kernel/task.c ****     else
2308:../MQXLITE/kernel/task.c ****     {
2309:../MQXLITE/kernel/task.c ****         victim_ptr->TIME_SLICE = kernel_data->SCHED_TIME_SLICE;
2310:../MQXLITE/kernel/task.c ****     } /* Endif */
2311:../MQXLITE/kernel/task.c ****     /* Reset scheduling policy for task */
2312:../MQXLITE/kernel/task.c ****     if (kernel_data->SCHED_POLICY == MQX_SCHED_RR)
2313:../MQXLITE/kernel/task.c ****     {
2314:../MQXLITE/kernel/task.c ****         victim_ptr->FLAGS |= MQX_TIME_SLICE_TASK;
2315:../MQXLITE/kernel/task.c ****     } /* Endif */
2316:../MQXLITE/kernel/task.c **** #endif
2317:../MQXLITE/kernel/task.c **** 
2318:../MQXLITE/kernel/task.c **** #if MQX_USE_IO
2319:../MQXLITE/kernel/task.c ****     /* Reset the io streams back to the default */
2320:../MQXLITE/kernel/task.c ****     victim_ptr->STDIN_STREAM  = kernel_data->PROCESSOR_STDIN;
2321:../MQXLITE/kernel/task.c ****     victim_ptr->STDOUT_STREAM = kernel_data->PROCESSOR_STDOUT;
2322:../MQXLITE/kernel/task.c ****     victim_ptr->STDERR_STREAM = kernel_data->PROCESSOR_STDERR;
2323:../MQXLITE/kernel/task.c **** #endif
2324:../MQXLITE/kernel/task.c **** 
2325:../MQXLITE/kernel/task.c ****     _int_disable();
 2517              		.loc 1 2325 0
 2518 023c FFF7FEFF 		bl	_int_disable
2326:../MQXLITE/kernel/task.c **** 
2327:../MQXLITE/kernel/task.c ****     if (victim_ptr == td_ptr)
 2519              		.loc 1 2327 0
 2520 0240 FA6C     		ldr	r2, [r7, #76]
 2521 0242 BB6A     		ldr	r3, [r7, #40]
 2522 0244 9A42     		cmp	r2, r3
 2523 0246 0BD1     		bne	.L137
 2524              	.LBB18:
2328:../MQXLITE/kernel/task.c ****     {
2329:../MQXLITE/kernel/task.c ****         _QUEUE_UNLINK(victim_ptr);  /* Remove victim from the queue */
 2525              		.loc 1 2329 0
 2526 0248 FB6C     		ldr	r3, [r7, #76]
 2527 024a 5B68     		ldr	r3, [r3, #4]
 2528 024c BB61     		str	r3, [r7, #24]
 2529 024e FB6C     		ldr	r3, [r7, #76]
 2530 0250 1B68     		ldr	r3, [r3]
 2531 0252 7B61     		str	r3, [r7, #20]
 2532 0254 BB69     		ldr	r3, [r7, #24]
 2533 0256 7A69     		ldr	r2, [r7, #20]
 2534 0258 1A60     		str	r2, [r3]
 2535 025a 7B69     		ldr	r3, [r7, #20]
 2536 025c BA69     		ldr	r2, [r7, #24]
 2537 025e 5A60     		str	r2, [r3, #4]
 2538              	.L137:
 2539              	.LBE18:
2330:../MQXLITE/kernel/task.c ****     } /* Endif */
2331:../MQXLITE/kernel/task.c **** 
2332:../MQXLITE/kernel/task.c ****     /* Rebuild the task's initial context */
2333:../MQXLITE/kernel/task.c ****     if (FALSE == _psp_build_stack_frame(victim_ptr, stack_ptr, stack_size, template_ptr, victim_ptr
 2540              		.loc 1 2333 0
 2541 0260 FB6C     		ldr	r3, [r7, #76]
 2542 0262 9B8C     		ldrh	r3, [r3, #36]
 2543 0264 1C1C     		mov	r4, r3
 2544 0266 F86C     		ldr	r0, [r7, #76]
 2545 0268 796E     		ldr	r1, [r7, #100]
 2546 026a FA6D     		ldr	r2, [r7, #92]
 2547 026c 7B6A     		ldr	r3, [r7, #36]
 2548 026e 0094     		str	r4, [sp]
 2549 0270 3C6E     		ldr	r4, [r7, #96]
 2550 0272 0194     		str	r4, [sp, #4]
 2551 0274 FFF7FEFF 		bl	_psp_build_stack_frame
 2552 0278 031C     		mov	r3, r0
 2553 027a 01D1     		bne	.L138
2334:../MQXLITE/kernel/task.c ****     {
2335:../MQXLITE/kernel/task.c ****         /* build stack failed */
2336:../MQXLITE/kernel/task.c ****         return MQX_OUT_OF_MEMORY;
 2554              		.loc 1 2336 0
 2555 027c 0423     		mov	r3, #4
 2556 027e 1EE0     		b	.L120
 2557              	.L138:
2337:../MQXLITE/kernel/task.c ****     }
2338:../MQXLITE/kernel/task.c **** 
2339:../MQXLITE/kernel/task.c ****     if (blocked)
 2558              		.loc 1 2339 0
 2559 0280 7B68     		ldr	r3, [r7, #4]
 2560 0282 002B     		cmp	r3, #0
 2561 0284 03D0     		beq	.L139
2340:../MQXLITE/kernel/task.c ****     {
2341:../MQXLITE/kernel/task.c ****         victim_ptr->STATE = BLOCKED;
 2562              		.loc 1 2341 0
 2563 0286 FB6C     		ldr	r3, [r7, #76]
 2564 0288 0322     		mov	r2, #3
 2565 028a 9A60     		str	r2, [r3, #8]
 2566 028c 03E0     		b	.L140
 2567              	.L139:
2342:../MQXLITE/kernel/task.c ****     }
2343:../MQXLITE/kernel/task.c ****     else
2344:../MQXLITE/kernel/task.c ****     {
2345:../MQXLITE/kernel/task.c ****         _task_ready_internal(victim_ptr);
 2568              		.loc 1 2345 0
 2569 028e FB6C     		ldr	r3, [r7, #76]
 2570 0290 181C     		mov	r0, r3
 2571 0292 FFF7FEFF 		bl	_task_ready_internal
 2572              	.L140:
2346:../MQXLITE/kernel/task.c ****     } /* Endif */
2347:../MQXLITE/kernel/task.c **** 
2348:../MQXLITE/kernel/task.c ****     victim_ptr->DISABLED_LEVEL = 0;
 2573              		.loc 1 2348 0
 2574 0296 FB6C     		ldr	r3, [r7, #76]
 2575 0298 0022     		mov	r2, #0
 2576 029a 9A64     		str	r2, [r3, #72]
2349:../MQXLITE/kernel/task.c **** 
2350:../MQXLITE/kernel/task.c ****     if (victim_ptr == td_ptr)
 2577              		.loc 1 2350 0
 2578 029c FA6C     		ldr	r2, [r7, #76]
 2579 029e BB6A     		ldr	r3, [r7, #40]
 2580 02a0 9A42     		cmp	r2, r3
 2581 02a2 01D1     		bne	.L141
2351:../MQXLITE/kernel/task.c ****     {
2352:../MQXLITE/kernel/task.c ****         /*
2353:../MQXLITE/kernel/task.c ****          * The active task is to be restarted.
2354:../MQXLITE/kernel/task.c ****          * Will not return from here
2355:../MQXLITE/kernel/task.c ****          */
2356:../MQXLITE/kernel/task.c ****         _sched_run_internal();
 2582              		.loc 1 2356 0
 2583 02a4 FFF7FEFF 		bl	_sched_run_internal
 2584              	.L141:
2357:../MQXLITE/kernel/task.c ****     } /* Endif */
2358:../MQXLITE/kernel/task.c **** 
2359:../MQXLITE/kernel/task.c ****     /* The victim has been added to the ready Q. Preemption check must be made */
2360:../MQXLITE/kernel/task.c ****     if (kernel_data->CURRENT_READY_Q != td_ptr->MY_QUEUE)
 2585              		.loc 1 2360 0
 2586 02a8 7B6D     		ldr	r3, [r7, #84]
 2587 02aa 5A6A     		ldr	r2, [r3, #36]
 2588 02ac BB6A     		ldr	r3, [r7, #40]
 2589 02ae DB69     		ldr	r3, [r3, #28]
 2590 02b0 9A42     		cmp	r2, r3
 2591 02b2 01D0     		beq	.L142
2361:../MQXLITE/kernel/task.c ****     {
2362:../MQXLITE/kernel/task.c ****         _sched_execute_scheduler_internal();
 2592              		.loc 1 2362 0
 2593 02b4 FFF7FEFF 		bl	_sched_execute_scheduler_internal
 2594              	.L142:
2363:../MQXLITE/kernel/task.c ****     } /* Endif */
2364:../MQXLITE/kernel/task.c **** 
2365:../MQXLITE/kernel/task.c ****     _int_enable();
 2595              		.loc 1 2365 0
 2596 02b8 FFF7FEFF 		bl	_int_enable
2366:../MQXLITE/kernel/task.c **** 
2367:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_restart, MQX_OK);
2368:../MQXLITE/kernel/task.c ****     return(MQX_OK);
 2597              		.loc 1 2368 0
 2598 02bc 0023     		mov	r3, #0
 2599              	.L120:
2369:../MQXLITE/kernel/task.c **** 
2370:../MQXLITE/kernel/task.c **** } /* Endbody */
 2600              		.loc 1 2370 0
 2601 02be 181C     		mov	r0, r3
 2602 02c0 BD46     		mov	sp, r7
 2603 02c2 1BB0     		add	sp, sp, #108
 2604              		@ sp needed for prologue
 2605 02c4 90BD     		pop	{r4, r7, pc}
 2606              	.L144:
 2607 02c6 C046     		.align	2
 2608              	.L143:
 2609 02c8 00000000 		.word	_mqx_kernel_data
 2610 02cc FFFEFFFF 		.word	-257
 2611              		.cfi_endproc
 2612              	.LFE23:
 2614              		.section	.text._task_restart,"ax",%progbits
 2615              		.align	2
 2616              		.global	_task_restart
 2617              		.code	16
 2618              		.thumb_func
 2620              	_task_restart:
 2621              	.LFB24:
2371:../MQXLITE/kernel/task.c **** 
2372:../MQXLITE/kernel/task.c **** /*!
2373:../MQXLITE/kernel/task.c ****  * \brief Restart the specified task.
2374:../MQXLITE/kernel/task.c ****  *
2375:../MQXLITE/kernel/task.c ****  * This function closes all queues that the task has open, releases all the task's
2376:../MQXLITE/kernel/task.c ****  * resources, and frees all memory that is associated with the task's resources.
2377:../MQXLITE/kernel/task.c ****  * \n This function restarts the task with the same task descriptor, task ID, and
2378:../MQXLITE/kernel/task.c ****  * task stack (Reserve stack for Stack Start Structure and call the
2379:../MQXLITE/kernel/task.c ****  * _task_restart_func().).
2380:../MQXLITE/kernel/task.c ****  *
2381:../MQXLITE/kernel/task.c ****  * \param[in] task_id   Task ID of the task to restart.
2382:../MQXLITE/kernel/task.c ****  * \param[in] param_ptr One of the following:
2383:../MQXLITE/kernel/task.c ****  * \n - Pointer to a new task creation parameter.
2384:../MQXLITE/kernel/task.c ****  * \n - NULL
2385:../MQXLITE/kernel/task.c ****  * \param[in] blocked   Whether the task should be restarted in the blocked state or not.
2386:../MQXLITE/kernel/task.c ****  *
2387:../MQXLITE/kernel/task.c ****  * \return MQX_OK
2388:../MQXLITE/kernel/task.c ****  * \return MQX_CANNOT_CALL_FUNCTION_FROM_ISR (Function cannot be called from an ISR.)
2389:../MQXLITE/kernel/task.c ****  * \return MQX_INVALID_TASK_ID (Task_id is invalid.)
2390:../MQXLITE/kernel/task.c ****  * \return MQX_OUT_OF_MEMORY (Not enough memory to restart function.)
2391:../MQXLITE/kernel/task.c ****  *
2392:../MQXLITE/kernel/task.c ****  * \warning Cannot be called from an ISR.
2393:../MQXLITE/kernel/task.c ****  *
2394:../MQXLITE/kernel/task.c ****  * \see _task_create
2395:../MQXLITE/kernel/task.c ****  * \see _task_create_blocked
2396:../MQXLITE/kernel/task.c ****  * \see _task_create_at
2397:../MQXLITE/kernel/task.c ****  */
2398:../MQXLITE/kernel/task.c **** _mqx_uint _task_restart
2399:../MQXLITE/kernel/task.c **** (
2400:../MQXLITE/kernel/task.c ****     _task_id    task_id,
2401:../MQXLITE/kernel/task.c ****     uint_32_ptr param_ptr,
2402:../MQXLITE/kernel/task.c ****     boolean     blocked
2403:../MQXLITE/kernel/task.c **** )
2404:../MQXLITE/kernel/task.c **** { /* Body */
 2622              		.loc 1 2404 0
 2623              		.cfi_startproc
 2624 0000 80B5     		push	{r7, lr}
 2625              	.LCFI72:
 2626              		.cfi_def_cfa_offset 8
 2627              		.cfi_offset 7, -8
 2628              		.cfi_offset 14, -4
 2629 0002 9AB0     		sub	sp, sp, #104
 2630              	.LCFI73:
 2631              		.cfi_def_cfa_offset 112
 2632 0004 00AF     		add	r7, sp, #0
 2633              	.LCFI74:
 2634              		.cfi_def_cfa_register 7
 2635 0006 F860     		str	r0, [r7, #12]
 2636 0008 B960     		str	r1, [r7, #8]
 2637 000a 7A60     		str	r2, [r7, #4]
2405:../MQXLITE/kernel/task.c ****     /* reserve memory in stack */
2406:../MQXLITE/kernel/task.c ****     volatile char dummy_stack_start_struct[sizeof(PSP_STACK_START_STRUCT)];
2407:../MQXLITE/kernel/task.c ****     dummy_stack_start_struct[0] = 0x00;
 2638              		.loc 1 2407 0
 2639 000c 3B1C     		mov	r3, r7
 2640 000e 1033     		add	r3, r3, #16
 2641 0010 0022     		mov	r2, #0
 2642 0012 1A70     		strb	r2, [r3]
2408:../MQXLITE/kernel/task.c **** 
2409:../MQXLITE/kernel/task.c ****     /* call the right _task_restart function */
2410:../MQXLITE/kernel/task.c ****     return(_task_restart_func(task_id, param_ptr, blocked));
 2643              		.loc 1 2410 0
 2644 0014 F968     		ldr	r1, [r7, #12]
 2645 0016 BA68     		ldr	r2, [r7, #8]
 2646 0018 7B68     		ldr	r3, [r7, #4]
 2647 001a 081C     		mov	r0, r1
 2648 001c 111C     		mov	r1, r2
 2649 001e 1A1C     		mov	r2, r3
 2650 0020 FFF7FEFF 		bl	_task_restart_func
 2651 0024 031C     		mov	r3, r0
2411:../MQXLITE/kernel/task.c **** }
 2652              		.loc 1 2411 0
 2653 0026 181C     		mov	r0, r3
 2654 0028 BD46     		mov	sp, r7
 2655 002a 1AB0     		add	sp, sp, #104
 2656              		@ sp needed for prologue
 2657 002c 80BD     		pop	{r7, pc}
 2658              		.cfi_endproc
 2659              	.LFE24:
 2661 002e C046     		.section	.text._task_stop_preemption,"ax",%progbits
 2662              		.align	2
 2663              		.global	_task_stop_preemption
 2664              		.code	16
 2665              		.thumb_func
 2667              	_task_stop_preemption:
 2668              	.LFB25:
2412:../MQXLITE/kernel/task.c **** 
2413:../MQXLITE/kernel/task.c **** #endif /* MQX_TD_HAS_TASK_TEMPLATE_PTR */
2414:../MQXLITE/kernel/task.c **** 
2415:../MQXLITE/kernel/task.c **** /*!
2416:../MQXLITE/kernel/task.c ****  * \brief Disables preemption of the current task.
2417:../MQXLITE/kernel/task.c ****  *
2418:../MQXLITE/kernel/task.c ****  * The _task_stop_preemption() function disables preemption of the active task
2419:../MQXLITE/kernel/task.c ****  * unless the task blocks explicitly (_task_block()) or calls _task_start_preemption().
2420:../MQXLITE/kernel/task.c ****  *
2421:../MQXLITE/kernel/task.c ****  * \warning Changes the preemption ability of tasks.
2422:../MQXLITE/kernel/task.c ****  * \warning Interrupts are still handled.
2423:../MQXLITE/kernel/task.c ****  *
2424:../MQXLITE/kernel/task.c ****  * \see _task_start_preemption
2425:../MQXLITE/kernel/task.c ****  * \see _task_ready
2426:../MQXLITE/kernel/task.c ****  * \see _task_block
2427:../MQXLITE/kernel/task.c ****  */
2428:../MQXLITE/kernel/task.c **** void _task_stop_preemption(void)
2429:../MQXLITE/kernel/task.c **** { /* Body */
 2669              		.loc 1 2429 0
 2670              		.cfi_startproc
 2671 0000 90B5     		push	{r4, r7, lr}
 2672              	.LCFI75:
 2673              		.cfi_def_cfa_offset 12
 2674              		.cfi_offset 4, -12
 2675              		.cfi_offset 7, -8
 2676              		.cfi_offset 14, -4
 2677 0002 83B0     		sub	sp, sp, #12
 2678              	.LCFI76:
 2679              		.cfi_def_cfa_offset 24
 2680 0004 00AF     		add	r7, sp, #0
 2681              	.LCFI77:
 2682              		.cfi_def_cfa_register 7
2430:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2431:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR                   td_ptr;
2432:../MQXLITE/kernel/task.c **** 
2433:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2683              		.loc 1 2433 0
 2684 0006 094B     		ldr	r3, .L147
 2685 0008 1C68     		ldr	r4, [r3]
2434:../MQXLITE/kernel/task.c ****     _KLOGE1(KLOG_task_stop_preemption);
2435:../MQXLITE/kernel/task.c **** 
2436:../MQXLITE/kernel/task.c ****     td_ptr      = kernel_data->ACTIVE_PTR;
 2686              		.loc 1 2436 0
 2687 000a E369     		ldr	r3, [r4, #28]
 2688 000c 7B60     		str	r3, [r7, #4]
2437:../MQXLITE/kernel/task.c ****     _int_disable();
 2689              		.loc 1 2437 0
 2690 000e FFF7FEFF 		bl	_int_disable
2438:../MQXLITE/kernel/task.c ****     td_ptr->FLAGS |= TASK_PREEMPTION_DISABLED;
 2691              		.loc 1 2438 0
 2692 0012 7B68     		ldr	r3, [r7, #4]
 2693 0014 9B6A     		ldr	r3, [r3, #40]
 2694 0016 8022     		mov	r2, #128
 2695 0018 5201     		lsl	r2, r2, #5
 2696 001a 1A43     		orr	r2, r3
 2697 001c 7B68     		ldr	r3, [r7, #4]
 2698 001e 9A62     		str	r2, [r3, #40]
2439:../MQXLITE/kernel/task.c ****     _int_enable();
 2699              		.loc 1 2439 0
 2700 0020 FFF7FEFF 		bl	_int_enable
2440:../MQXLITE/kernel/task.c ****     _KLOGX1(KLOG_task_stop_preemption);
2441:../MQXLITE/kernel/task.c **** 
2442:../MQXLITE/kernel/task.c **** } /* Endbody */
 2701              		.loc 1 2442 0
 2702 0024 BD46     		mov	sp, r7
 2703 0026 03B0     		add	sp, sp, #12
 2704              		@ sp needed for prologue
 2705 0028 90BD     		pop	{r4, r7, pc}
 2706              	.L148:
 2707 002a C046     		.align	2
 2708              	.L147:
 2709 002c 00000000 		.word	_mqx_kernel_data
 2710              		.cfi_endproc
 2711              	.LFE25:
 2713              		.section	.text._task_start_preemption,"ax",%progbits
 2714              		.align	2
 2715              		.global	_task_start_preemption
 2716              		.code	16
 2717              		.thumb_func
 2719              	_task_start_preemption:
 2720              	.LFB26:
2443:../MQXLITE/kernel/task.c **** 
2444:../MQXLITE/kernel/task.c **** /*!
2445:../MQXLITE/kernel/task.c ****  * \brief Enables preemption of the current task.
2446:../MQXLITE/kernel/task.c ****  *
2447:../MQXLITE/kernel/task.c ****  * The _task_start_preemption() function enables preemption of the active task
2448:../MQXLITE/kernel/task.c ****  * after _task_stop_preemption() was called.
2449:../MQXLITE/kernel/task.c ****  *
2450:../MQXLITE/kernel/task.c ****  * \warning Changes the preemption ability of tasks.
2451:../MQXLITE/kernel/task.c ****  * \warning Interrupts are still handled.
2452:../MQXLITE/kernel/task.c ****  *
2453:../MQXLITE/kernel/task.c ****  * \see _task_stop_preemption
2454:../MQXLITE/kernel/task.c ****  * \see _task_ready
2455:../MQXLITE/kernel/task.c ****  * \see _task_block
2456:../MQXLITE/kernel/task.c ****  */
2457:../MQXLITE/kernel/task.c **** void _task_start_preemption(void)
2458:../MQXLITE/kernel/task.c **** { /* Body */
 2721              		.loc 1 2458 0
 2722              		.cfi_startproc
 2723 0000 90B5     		push	{r4, r7, lr}
 2724              	.LCFI78:
 2725              		.cfi_def_cfa_offset 12
 2726              		.cfi_offset 4, -12
 2727              		.cfi_offset 7, -8
 2728              		.cfi_offset 14, -4
 2729 0002 83B0     		sub	sp, sp, #12
 2730              	.LCFI79:
 2731              		.cfi_def_cfa_offset 24
 2732 0004 00AF     		add	r7, sp, #0
 2733              	.LCFI80:
 2734              		.cfi_def_cfa_register 7
2459:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2460:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR                   td_ptr;
2461:../MQXLITE/kernel/task.c **** 
2462:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2735              		.loc 1 2462 0
 2736 0006 094B     		ldr	r3, .L150
 2737 0008 1C68     		ldr	r4, [r3]
2463:../MQXLITE/kernel/task.c ****     _KLOGE1(KLOG_task_start_preemption);
2464:../MQXLITE/kernel/task.c **** 
2465:../MQXLITE/kernel/task.c ****     td_ptr      = kernel_data->ACTIVE_PTR;
 2738              		.loc 1 2465 0
 2739 000a E369     		ldr	r3, [r4, #28]
 2740 000c 7B60     		str	r3, [r7, #4]
2466:../MQXLITE/kernel/task.c ****     _int_disable();
 2741              		.loc 1 2466 0
 2742 000e FFF7FEFF 		bl	_int_disable
2467:../MQXLITE/kernel/task.c ****     td_ptr->FLAGS &= ~TASK_PREEMPTION_DISABLED;
 2743              		.loc 1 2467 0
 2744 0012 7B68     		ldr	r3, [r7, #4]
 2745 0014 9A6A     		ldr	r2, [r3, #40]
 2746 0016 064B     		ldr	r3, .L150+4
 2747 0018 1A40     		and	r2, r3
 2748 001a 7B68     		ldr	r3, [r7, #4]
 2749 001c 9A62     		str	r2, [r3, #40]
2468:../MQXLITE/kernel/task.c ****     _CHECK_RUN_SCHEDULER(); /* Allow higher priority tasks to run */
 2750              		.loc 1 2468 0
 2751 001e FFF7FEFF 		bl	_sched_check_scheduler_internal
2469:../MQXLITE/kernel/task.c ****     _int_enable();
 2752              		.loc 1 2469 0
 2753 0022 FFF7FEFF 		bl	_int_enable
2470:../MQXLITE/kernel/task.c **** 
2471:../MQXLITE/kernel/task.c ****     _KLOGX1(KLOG_task_start_preemption);
2472:../MQXLITE/kernel/task.c **** 
2473:../MQXLITE/kernel/task.c **** } /* Endbody */
 2754              		.loc 1 2473 0
 2755 0026 BD46     		mov	sp, r7
 2756 0028 03B0     		add	sp, sp, #12
 2757              		@ sp needed for prologue
 2758 002a 90BD     		pop	{r4, r7, pc}
 2759              	.L151:
 2760              		.align	2
 2761              	.L150:
 2762 002c 00000000 		.word	_mqx_kernel_data
 2763 0030 FFEFFFFF 		.word	-4097
 2764              		.cfi_endproc
 2765              	.LFE26:
 2767              		.section	.text._task_check_stack,"ax",%progbits
 2768              		.align	2
 2769              		.global	_task_check_stack
 2770              		.code	16
 2771              		.thumb_func
 2773              	_task_check_stack:
 2774              	.LFB27:
2474:../MQXLITE/kernel/task.c **** 
2475:../MQXLITE/kernel/task.c **** /*!
2476:../MQXLITE/kernel/task.c ****  * \brief Determines whether the active task's stack is currently overflowed.
2477:../MQXLITE/kernel/task.c ****  *
2478:../MQXLITE/kernel/task.c ****  * This function indicates whether the stack is currently past its limit. The
2479:../MQXLITE/kernel/task.c ****  * function does not indicate whether the stack previously passed its limit.
2480:../MQXLITE/kernel/task.c ****  *
2481:../MQXLITE/kernel/task.c ****  * \return TRUE (Stack is out of bounds.)
2482:../MQXLITE/kernel/task.c ****  * \return FALSE (Stack is not out of bounds.)
2483:../MQXLITE/kernel/task.c ****  *
2484:../MQXLITE/kernel/task.c ****  * \see _task_set_error
2485:../MQXLITE/kernel/task.c ****  */
2486:../MQXLITE/kernel/task.c **** boolean _task_check_stack(void)
2487:../MQXLITE/kernel/task.c **** { /* Body */
 2775              		.loc 1 2487 0
 2776              		.cfi_startproc
 2777 0000 90B5     		push	{r4, r7, lr}
 2778              	.LCFI81:
 2779              		.cfi_def_cfa_offset 12
 2780              		.cfi_offset 4, -12
 2781              		.cfi_offset 7, -8
 2782              		.cfi_offset 14, -4
 2783 0002 83B0     		sub	sp, sp, #12
 2784              	.LCFI82:
 2785              		.cfi_def_cfa_offset 24
 2786 0004 00AF     		add	r7, sp, #0
 2787              	.LCFI83:
 2788              		.cfi_def_cfa_register 7
2488:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_STACK_LIMIT
2489:../MQXLITE/kernel/task.c ****     register  KERNEL_DATA_STRUCT_PTR kernel_data;
2490:../MQXLITE/kernel/task.c ****     volatile  char                   loc = (char)0;
 2789              		.loc 1 2490 0
 2790 0006 FB1D     		add	r3, r7, #7
 2791 0008 0022     		mov	r2, #0
 2792 000a 1A70     		strb	r2, [r3]
2491:../MQXLITE/kernel/task.c **** 
2492:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2793              		.loc 1 2492 0
 2794 000c 064B     		ldr	r3, .L155
 2795 000e 1C68     		ldr	r4, [r3]
2493:../MQXLITE/kernel/task.c **** 
2494:../MQXLITE/kernel/task.c **** #if PSP_STACK_GROWS_TO_LOWER_MEM
2495:../MQXLITE/kernel/task.c ****     if ( &loc < ((char_ptr)kernel_data->ACTIVE_PTR->STACK_LIMIT) )
 2796              		.loc 1 2495 0
 2797 0010 E369     		ldr	r3, [r4, #28]
 2798 0012 9A69     		ldr	r2, [r3, #24]
 2799 0014 FB1D     		add	r3, r7, #7
 2800 0016 9A42     		cmp	r2, r3
 2801 0018 01D9     		bls	.L153
2496:../MQXLITE/kernel/task.c ****     {
2497:../MQXLITE/kernel/task.c **** #else
2498:../MQXLITE/kernel/task.c ****         if ( &loc > ((char_ptr)kernel_data->ACTIVE_PTR->STACK_LIMIT) )
2499:../MQXLITE/kernel/task.c ****         {
2500:../MQXLITE/kernel/task.c **** #endif
2501:../MQXLITE/kernel/task.c ****             return (TRUE);
 2802              		.loc 1 2501 0
 2803 001a 0123     		mov	r3, #1
 2804 001c 00E0     		b	.L154
 2805              	.L153:
2502:../MQXLITE/kernel/task.c ****         }
2503:../MQXLITE/kernel/task.c ****         else
2504:../MQXLITE/kernel/task.c ****         {
2505:../MQXLITE/kernel/task.c ****             return (FALSE);
 2806              		.loc 1 2505 0
 2807 001e 0023     		mov	r3, #0
 2808              	.L154:
2506:../MQXLITE/kernel/task.c ****         } /* Endif */
2507:../MQXLITE/kernel/task.c **** #else
2508:../MQXLITE/kernel/task.c ****         return (FALSE);
2509:../MQXLITE/kernel/task.c **** #endif
2510:../MQXLITE/kernel/task.c **** } /* Endbody */
 2809              		.loc 1 2510 0
 2810 0020 181C     		mov	r0, r3
 2811 0022 BD46     		mov	sp, r7
 2812 0024 03B0     		add	sp, sp, #12
 2813              		@ sp needed for prologue
 2814 0026 90BD     		pop	{r4, r7, pc}
 2815              	.L156:
 2816              		.align	2
 2817              	.L155:
 2818 0028 00000000 		.word	_mqx_kernel_data
 2819              		.cfi_endproc
 2820              	.LFE27:
 2822              		.section	.text._task_get_creator,"ax",%progbits
 2823              		.align	2
 2824              		.global	_task_get_creator
 2825              		.code	16
 2826              		.thumb_func
 2828              	_task_get_creator:
 2829              	.LFB28:
2511:../MQXLITE/kernel/task.c **** 
2512:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
2513:../MQXLITE/kernel/task.c **** 
2514:../MQXLITE/kernel/task.c **** /*!
2515:../MQXLITE/kernel/task.c ****  * \brief Gets the processor number of the task's home processor.
2516:../MQXLITE/kernel/task.c ****  *
2517:../MQXLITE/kernel/task.c ****  * This function returns the processor-number portion of task_id. It cannot check
2518:../MQXLITE/kernel/task.c ****  * the validity of task_id because MQX on one processor is unaware of which tasks
2519:../MQXLITE/kernel/task.c ****  * might reside on another processor.
2520:../MQXLITE/kernel/task.c ****  *
2521:../MQXLITE/kernel/task.c ****  * \param[in] task_id Task ID of the task for which to get info.
2522:../MQXLITE/kernel/task.c ****  *
2523:../MQXLITE/kernel/task.c ****  * \return Processor number of the processor where the task resides.
2524:../MQXLITE/kernel/task.c ****  *
2525:../MQXLITE/kernel/task.c ****  * \see _task_get_id
2526:../MQXLITE/kernel/task.c ****  */
2527:../MQXLITE/kernel/task.c **** _processor_number _task_get_processor
2528:../MQXLITE/kernel/task.c **** (
2529:../MQXLITE/kernel/task.c ****     _task_id task_id
2530:../MQXLITE/kernel/task.c **** )
2531:../MQXLITE/kernel/task.c **** { /* Body */
2532:../MQXLITE/kernel/task.c **** 
2533:../MQXLITE/kernel/task.c ****     return PROC_NUMBER_FROM_TASKID(task_id);
2534:../MQXLITE/kernel/task.c **** 
2535:../MQXLITE/kernel/task.c **** } /* Endbody */
2536:../MQXLITE/kernel/task.c **** 
2537:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
2538:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_PARENT
2539:../MQXLITE/kernel/task.c **** 
2540:../MQXLITE/kernel/task.c **** /*!
2541:../MQXLITE/kernel/task.c ****  * \brief Gets parent's task ID to the calling task.
2542:../MQXLITE/kernel/task.c ****  *
2543:../MQXLITE/kernel/task.c ****  * \return Task ID of the parent task.
2544:../MQXLITE/kernel/task.c ****  *
2545:../MQXLITE/kernel/task.c ****  * \see _task_get_processor
2546:../MQXLITE/kernel/task.c ****  * \see _task_get_id
2547:../MQXLITE/kernel/task.c ****  */
2548:../MQXLITE/kernel/task.c **** _task_id _task_get_creator(void)
2549:../MQXLITE/kernel/task.c **** { /* Body */
 2830              		.loc 1 2549 0
 2831              		.cfi_startproc
 2832 0000 90B5     		push	{r4, r7, lr}
 2833              	.LCFI84:
 2834              		.cfi_def_cfa_offset 12
 2835              		.cfi_offset 4, -12
 2836              		.cfi_offset 7, -8
 2837              		.cfi_offset 14, -4
 2838 0002 00AF     		add	r7, sp, #0
 2839              	.LCFI85:
 2840              		.cfi_def_cfa_register 7
2550:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2551:../MQXLITE/kernel/task.c **** 
2552:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2841              		.loc 1 2552 0
 2842 0004 034B     		ldr	r3, .L158
 2843 0006 1C68     		ldr	r4, [r3]
2553:../MQXLITE/kernel/task.c ****     return( kernel_data->ACTIVE_PTR->PARENT );
 2844              		.loc 1 2553 0
 2845 0008 E369     		ldr	r3, [r4, #28]
 2846 000a 1B6D     		ldr	r3, [r3, #80]
2554:../MQXLITE/kernel/task.c **** 
2555:../MQXLITE/kernel/task.c **** } /* Endbody */
 2847              		.loc 1 2555 0
 2848 000c 181C     		mov	r0, r3
 2849 000e BD46     		mov	sp, r7
 2850              		@ sp needed for prologue
 2851 0010 90BD     		pop	{r4, r7, pc}
 2852              	.L159:
 2853 0012 C046     		.align	2
 2854              	.L158:
 2855 0014 00000000 		.word	_mqx_kernel_data
 2856              		.cfi_endproc
 2857              	.LFE28:
 2859              		.section	.text._task_get_error,"ax",%progbits
 2860              		.align	2
 2861              		.global	_task_get_error
 2862              		.code	16
 2863              		.thumb_func
 2865              	_task_get_error:
 2866              	.LFB29:
2556:../MQXLITE/kernel/task.c **** #endif /* MQX_TD_HAS_PARENT */
2557:../MQXLITE/kernel/task.c **** 
2558:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_ERROR_CODE
2559:../MQXLITE/kernel/task.c **** 
2560:../MQXLITE/kernel/task.c **** /*!
2561:../MQXLITE/kernel/task.c ****  * \brief Gets the task error code.
2562:../MQXLITE/kernel/task.c ****  *
2563:../MQXLITE/kernel/task.c ****  * \return Task error code for the active task.
2564:../MQXLITE/kernel/task.c ****  *
2565:../MQXLITE/kernel/task.c ****  * \see _task_get_error_ptr
2566:../MQXLITE/kernel/task.c ****  * \see _task_set_error
2567:../MQXLITE/kernel/task.c ****  * \see _task_errno
2568:../MQXLITE/kernel/task.c ****  */
2569:../MQXLITE/kernel/task.c **** _mqx_uint _task_get_error(void)
2570:../MQXLITE/kernel/task.c **** { /* Body */
 2867              		.loc 1 2570 0
 2868              		.cfi_startproc
 2869 0000 90B5     		push	{r4, r7, lr}
 2870              	.LCFI86:
 2871              		.cfi_def_cfa_offset 12
 2872              		.cfi_offset 4, -12
 2873              		.cfi_offset 7, -8
 2874              		.cfi_offset 14, -4
 2875 0002 00AF     		add	r7, sp, #0
 2876              	.LCFI87:
 2877              		.cfi_def_cfa_register 7
2571:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2572:../MQXLITE/kernel/task.c **** 
2573:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2878              		.loc 1 2573 0
 2879 0004 064B     		ldr	r3, .L163
 2880 0006 1C68     		ldr	r4, [r3]
2574:../MQXLITE/kernel/task.c **** 
2575:../MQXLITE/kernel/task.c ****     if (kernel_data->IN_ISR)
 2881              		.loc 1 2575 0
 2882 0008 238B     		ldrh	r3, [r4, #24]
 2883 000a 002B     		cmp	r3, #0
 2884 000c 02D0     		beq	.L161
2576:../MQXLITE/kernel/task.c ****     {
2577:../MQXLITE/kernel/task.c ****         return( kernel_data->INTERRUPT_CONTEXT_PTR->ERROR_CODE );
 2885              		.loc 1 2577 0
 2886 000e 636B     		ldr	r3, [r4, #52]
 2887 0010 DB68     		ldr	r3, [r3, #12]
 2888 0012 01E0     		b	.L162
 2889              	.L161:
2578:../MQXLITE/kernel/task.c ****     }
2579:../MQXLITE/kernel/task.c ****     else
2580:../MQXLITE/kernel/task.c ****     {
2581:../MQXLITE/kernel/task.c ****         return( kernel_data->ACTIVE_PTR->TASK_ERROR_CODE );
 2890              		.loc 1 2581 0
 2891 0014 E369     		ldr	r3, [r4, #28]
 2892 0016 DB6C     		ldr	r3, [r3, #76]
 2893              	.L162:
2582:../MQXLITE/kernel/task.c ****     } /* Endif */
2583:../MQXLITE/kernel/task.c **** } /* Endbody */
 2894              		.loc 1 2583 0
 2895 0018 181C     		mov	r0, r3
 2896 001a BD46     		mov	sp, r7
 2897              		@ sp needed for prologue
 2898 001c 90BD     		pop	{r4, r7, pc}
 2899              	.L164:
 2900 001e C046     		.align	2
 2901              	.L163:
 2902 0020 00000000 		.word	_mqx_kernel_data
 2903              		.cfi_endproc
 2904              	.LFE29:
 2906              		.section	.text._task_get_error_ptr,"ax",%progbits
 2907              		.align	2
 2908              		.global	_task_get_error_ptr
 2909              		.code	16
 2910              		.thumb_func
 2912              	_task_get_error_ptr:
 2913              	.LFB30:
2584:../MQXLITE/kernel/task.c **** 
2585:../MQXLITE/kernel/task.c **** /*!
2586:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the task error code.
2587:../MQXLITE/kernel/task.c ****  *
2588:../MQXLITE/kernel/task.c ****  * \return Pointer to the task error code.
2589:../MQXLITE/kernel/task.c ****  *
2590:../MQXLITE/kernel/task.c ****  * \warning If a task writes to the pointer that _task_get_error_ptr() returns,
2591:../MQXLITE/kernel/task.c ****  * the task error code is changed to the value, overwriting any previous error code. To
2592:../MQXLITE/kernel/task.c ****  * avoid overwriting a previous error code, a task should use _task_set_error().
2593:../MQXLITE/kernel/task.c ****  *
2594:../MQXLITE/kernel/task.c ****  * \see _task_get_error
2595:../MQXLITE/kernel/task.c ****  * \see _task_set_error
2596:../MQXLITE/kernel/task.c ****  * \see _task_errno
2597:../MQXLITE/kernel/task.c ****  */
2598:../MQXLITE/kernel/task.c **** _mqx_uint _PTR_ _task_get_error_ptr(void)
2599:../MQXLITE/kernel/task.c **** { /* Body */
 2914              		.loc 1 2599 0
 2915              		.cfi_startproc
 2916 0000 90B5     		push	{r4, r7, lr}
 2917              	.LCFI88:
 2918              		.cfi_def_cfa_offset 12
 2919              		.cfi_offset 4, -12
 2920              		.cfi_offset 7, -8
 2921              		.cfi_offset 14, -4
 2922 0002 00AF     		add	r7, sp, #0
 2923              	.LCFI89:
 2924              		.cfi_def_cfa_register 7
2600:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2601:../MQXLITE/kernel/task.c **** 
2602:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2925              		.loc 1 2602 0
 2926 0004 064B     		ldr	r3, .L168
 2927 0006 1C68     		ldr	r4, [r3]
2603:../MQXLITE/kernel/task.c ****     if (kernel_data->IN_ISR)
 2928              		.loc 1 2603 0
 2929 0008 238B     		ldrh	r3, [r4, #24]
 2930 000a 002B     		cmp	r3, #0
 2931 000c 02D0     		beq	.L166
2604:../MQXLITE/kernel/task.c ****     {
2605:../MQXLITE/kernel/task.c ****         return( &kernel_data->INTERRUPT_CONTEXT_PTR->ERROR_CODE );
 2932              		.loc 1 2605 0
 2933 000e 636B     		ldr	r3, [r4, #52]
 2934 0010 0C33     		add	r3, r3, #12
 2935 0012 01E0     		b	.L167
 2936              	.L166:
2606:../MQXLITE/kernel/task.c ****     }
2607:../MQXLITE/kernel/task.c ****     else
2608:../MQXLITE/kernel/task.c ****     {
2609:../MQXLITE/kernel/task.c ****         return( &kernel_data->ACTIVE_PTR->TASK_ERROR_CODE );
 2937              		.loc 1 2609 0
 2938 0014 E369     		ldr	r3, [r4, #28]
 2939 0016 4C33     		add	r3, r3, #76
 2940              	.L167:
2610:../MQXLITE/kernel/task.c ****     } /* Endif */
2611:../MQXLITE/kernel/task.c **** } /* Endbody */
 2941              		.loc 1 2611 0
 2942 0018 181C     		mov	r0, r3
 2943 001a BD46     		mov	sp, r7
 2944              		@ sp needed for prologue
 2945 001c 90BD     		pop	{r4, r7, pc}
 2946              	.L169:
 2947 001e C046     		.align	2
 2948              	.L168:
 2949 0020 00000000 		.word	_mqx_kernel_data
 2950              		.cfi_endproc
 2951              	.LFE30:
 2953              		.section	.text._task_get_id,"ax",%progbits
 2954              		.align	2
 2955              		.global	_task_get_id
 2956              		.code	16
 2957              		.thumb_func
 2959              	_task_get_id:
 2960              	.LFB31:
2612:../MQXLITE/kernel/task.c **** #endif /* MQX_TD_HAS_ERROR_CODE */
2613:../MQXLITE/kernel/task.c **** 
2614:../MQXLITE/kernel/task.c **** /*!
2615:../MQXLITE/kernel/task.c ****  * \brief Gets the task ID of the active task.
2616:../MQXLITE/kernel/task.c ****  *
2617:../MQXLITE/kernel/task.c ****  * \return Task ID of the active task.
2618:../MQXLITE/kernel/task.c ****  *
2619:../MQXLITE/kernel/task.c ****  * \see _task_get_creator
2620:../MQXLITE/kernel/task.c ****  * \see _task_get_processor
2621:../MQXLITE/kernel/task.c ****  * \see _task_get_id_from_name
2622:../MQXLITE/kernel/task.c ****  */
2623:../MQXLITE/kernel/task.c **** _task_id _task_get_id(void)
2624:../MQXLITE/kernel/task.c **** { /* Body */
 2961              		.loc 1 2624 0
 2962              		.cfi_startproc
 2963 0000 90B5     		push	{r4, r7, lr}
 2964              	.LCFI90:
 2965              		.cfi_def_cfa_offset 12
 2966              		.cfi_offset 4, -12
 2967              		.cfi_offset 7, -8
 2968              		.cfi_offset 14, -4
 2969 0002 00AF     		add	r7, sp, #0
 2970              	.LCFI91:
 2971              		.cfi_def_cfa_register 7
2625:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR kernel_data;
2626:../MQXLITE/kernel/task.c **** 
2627:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 2972              		.loc 1 2627 0
 2973 0004 034B     		ldr	r3, .L171
 2974 0006 1C68     		ldr	r4, [r3]
2628:../MQXLITE/kernel/task.c ****     return( kernel_data->ACTIVE_PTR->TASK_ID );
 2975              		.loc 1 2628 0
 2976 0008 E369     		ldr	r3, [r4, #28]
 2977 000a DB68     		ldr	r3, [r3, #12]
2629:../MQXLITE/kernel/task.c **** } /* Endbody */
 2978              		.loc 1 2629 0
 2979 000c 181C     		mov	r0, r3
 2980 000e BD46     		mov	sp, r7
 2981              		@ sp needed for prologue
 2982 0010 90BD     		pop	{r4, r7, pc}
 2983              	.L172:
 2984 0012 C046     		.align	2
 2985              	.L171:
 2986 0014 00000000 		.word	_mqx_kernel_data
 2987              		.cfi_endproc
 2988              	.LFE31:
 2990              		.section	.text._task_get_td,"ax",%progbits
 2991              		.align	2
 2992              		.global	_task_get_td
 2993              		.code	16
 2994              		.thumb_func
 2996              	_task_get_td:
 2997              	.LFB32:
2630:../MQXLITE/kernel/task.c **** 
2631:../MQXLITE/kernel/task.c **** /*!
2632:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the task descriptor for the task ID.
2633:../MQXLITE/kernel/task.c ****  *
2634:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of:
2635:../MQXLITE/kernel/task.c ****  * \n - Task ID for a task on this processor.
2636:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Use the current task.)
2637:../MQXLITE/kernel/task.c ****  *
2638:../MQXLITE/kernel/task.c ****  * \return Pointer to the task descriptor for task_id.
2639:../MQXLITE/kernel/task.c ****  * \return NULL (Task_id is not valid for this processor.)
2640:../MQXLITE/kernel/task.c ****  *
2641:../MQXLITE/kernel/task.c ****  * \see _task_ready
2642:../MQXLITE/kernel/task.c ****  */
2643:../MQXLITE/kernel/task.c **** pointer _task_get_td
2644:../MQXLITE/kernel/task.c **** (
2645:../MQXLITE/kernel/task.c ****     _task_id task_id
2646:../MQXLITE/kernel/task.c **** )
2647:../MQXLITE/kernel/task.c **** {
 2998              		.loc 1 2647 0
 2999              		.cfi_startproc
 3000 0000 80B5     		push	{r7, lr}
 3001              	.LCFI92:
 3002              		.cfi_def_cfa_offset 8
 3003              		.cfi_offset 7, -8
 3004              		.cfi_offset 14, -4
 3005 0002 86B0     		sub	sp, sp, #24
 3006              	.LCFI93:
 3007              		.cfi_def_cfa_offset 32
 3008 0004 00AF     		add	r7, sp, #0
 3009              	.LCFI94:
 3010              		.cfi_def_cfa_register 7
 3011 0006 7860     		str	r0, [r7, #4]
2648:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR  kernel_data;
2649:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR           td_ptr;
2650:../MQXLITE/kernel/task.c ****     _mqx_uint               size;
2651:../MQXLITE/kernel/task.c **** 
2652:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE && MQX_ENABLE_USER_STDAPI
2653:../MQXLITE/kernel/task.c ****     if (MQX_RUN_IN_USER_MODE)
2654:../MQXLITE/kernel/task.c ****     {
2655:../MQXLITE/kernel/task.c ****         return _usr_task_get_td(task_id);
2656:../MQXLITE/kernel/task.c ****     }
2657:../MQXLITE/kernel/task.c **** #endif
2658:../MQXLITE/kernel/task.c **** 
2659:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3012              		.loc 1 2659 0
 3013 0008 2A4B     		ldr	r3, .L183
 3014 000a 1B68     		ldr	r3, [r3]
 3015 000c FB60     		str	r3, [r7, #12]
2660:../MQXLITE/kernel/task.c ****     if (task_id == MQX_NULL_TASK_ID)
 3016              		.loc 1 2660 0
 3017 000e 7B68     		ldr	r3, [r7, #4]
 3018 0010 002B     		cmp	r3, #0
 3019 0012 02D1     		bne	.L174
2661:../MQXLITE/kernel/task.c ****     {
2662:../MQXLITE/kernel/task.c ****         return((pointer)kernel_data->ACTIVE_PTR);
 3020              		.loc 1 2662 0
 3021 0014 FB68     		ldr	r3, [r7, #12]
 3022 0016 DB69     		ldr	r3, [r3, #28]
 3023 0018 47E0     		b	.L175
 3024              	.L174:
2663:../MQXLITE/kernel/task.c ****     }
2664:../MQXLITE/kernel/task.c **** 
2665:../MQXLITE/kernel/task.c ****     /* check task_id for SYSTEM_TASK_ID */
2666:../MQXLITE/kernel/task.c ****     if (task_id == kernel_data->SYSTEM_TD.TASK_ID)
 3025              		.loc 1 2666 0
 3026 001a FB68     		ldr	r3, [r7, #12]
 3027 001c 5A6D     		ldr	r2, [r3, #84]
 3028 001e 7B68     		ldr	r3, [r7, #4]
 3029 0020 9A42     		cmp	r2, r3
 3030 0022 02D1     		bne	.L176
2667:../MQXLITE/kernel/task.c ****     {
2668:../MQXLITE/kernel/task.c ****         return((pointer)&(kernel_data->SYSTEM_TD));
 3031              		.loc 1 2668 0
 3032 0024 FB68     		ldr	r3, [r7, #12]
 3033 0026 4833     		add	r3, r3, #72
 3034 0028 3FE0     		b	.L175
 3035              	.L176:
2669:../MQXLITE/kernel/task.c ****     }
2670:../MQXLITE/kernel/task.c **** 
2671:../MQXLITE/kernel/task.c ****     /* SPR P171-0022-01 Use int disable, not a semaphore */
2672:../MQXLITE/kernel/task.c ****     _INT_DISABLE();
 3036              		.loc 1 2672 0
 3037 002a FB68     		ldr	r3, [r7, #12]
 3038 002c DB69     		ldr	r3, [r3, #28]
 3039 002e 9B6C     		ldr	r3, [r3, #72]
 3040 0030 002B     		cmp	r3, #0
 3041 0032 00D1     		bne	.L177
 3042              		.loc 1 2672 0 is_stmt 0 discriminator 1
 3043              	@ 2672 "../MQXLITE/kernel/task.c" 1
 3044 0034 72B6     		cpsid i
 3045              	@ 0 "" 2
 3046              		.code	16
 3047              	.L177:
 3048              		.loc 1 2672 0 discriminator 2
 3049 0036 FB68     		ldr	r3, [r7, #12]
 3050 0038 DB69     		ldr	r3, [r3, #28]
 3051 003a 9A6C     		ldr	r2, [r3, #72]
 3052 003c 0132     		add	r2, r2, #1
 3053 003e 9A64     		str	r2, [r3, #72]
2673:../MQXLITE/kernel/task.c ****     /* END SPR */
2674:../MQXLITE/kernel/task.c **** 
2675:../MQXLITE/kernel/task.c ****     td_ptr = (TD_STRUCT_PTR)((uchar_ptr)kernel_data->TD_LIST.NEXT - FIELD_OFFSET(TD_STRUCT,TD_LIST_
 3054              		.loc 1 2675 0 is_stmt 1 discriminator 2
 3055 0040 FA68     		ldr	r2, [r7, #12]
 3056 0042 C823     		mov	r3, #200
 3057 0044 D358     		ldr	r3, [r2, r3]
 3058 0046 5C3B     		sub	r3, r3, #92
 3059 0048 7B61     		str	r3, [r7, #20]
2676:../MQXLITE/kernel/task.c **** 
2677:../MQXLITE/kernel/task.c ****     size   = _QUEUE_GET_SIZE(&kernel_data->TD_LIST);
 3060              		.loc 1 2677 0 discriminator 2
 3061 004a FB68     		ldr	r3, [r7, #12]
 3062 004c C833     		add	r3, r3, #200
 3063 004e 1B89     		ldrh	r3, [r3, #8]
 3064 0050 3B61     		str	r3, [r7, #16]
2678:../MQXLITE/kernel/task.c ****     while (size--)
 3065              		.loc 1 2678 0 discriminator 2
 3066 0052 1EE0     		b	.L178
 3067              	.L182:
2679:../MQXLITE/kernel/task.c ****     {
2680:../MQXLITE/kernel/task.c ****         /* END SPR */
2681:../MQXLITE/kernel/task.c ****         if (td_ptr->TASK_ID == task_id)
 3068              		.loc 1 2681 0
 3069 0054 7B69     		ldr	r3, [r7, #20]
 3070 0056 DA68     		ldr	r2, [r3, #12]
 3071 0058 7B68     		ldr	r3, [r7, #4]
 3072 005a 9A42     		cmp	r2, r3
 3073 005c 15D1     		bne	.L179
2682:../MQXLITE/kernel/task.c ****         {
2683:../MQXLITE/kernel/task.c ****             /* SPR P171-0022-01 Use int disable, not a semaphore */
2684:../MQXLITE/kernel/task.c ****             _INT_ENABLE();
 3074              		.loc 1 2684 0
 3075 005e FB68     		ldr	r3, [r7, #12]
 3076 0060 DB69     		ldr	r3, [r3, #28]
 3077 0062 9B6C     		ldr	r3, [r3, #72]
 3078 0064 002B     		cmp	r3, #0
 3079 0066 0ED0     		beq	.L180
 3080              		.loc 1 2684 0 is_stmt 0 discriminator 1
 3081 0068 FB68     		ldr	r3, [r7, #12]
 3082 006a DB69     		ldr	r3, [r3, #28]
 3083 006c 9A6C     		ldr	r2, [r3, #72]
 3084 006e 013A     		sub	r2, r2, #1
 3085 0070 9A64     		str	r2, [r3, #72]
 3086 0072 9B6C     		ldr	r3, [r3, #72]
 3087 0074 002B     		cmp	r3, #0
 3088 0076 06D1     		bne	.L180
 3089              		.loc 1 2684 0 discriminator 2
 3090 0078 FB68     		ldr	r3, [r7, #12]
 3091 007a 1B8B     		ldrh	r3, [r3, #24]
 3092 007c 002B     		cmp	r3, #0
 3093 007e 01D0     		beq	.L181
 3094              		.loc 1 2684 0 discriminator 3
 3095              	@ 2684 "../MQXLITE/kernel/task.c" 1
 3096 0080 62B6     		cpsie i
 3097              	@ 0 "" 2
 3098              		.code	16
 3099 0082 00E0     		b	.L180
 3100              	.L181:
 3101              		.loc 1 2684 0 discriminator 4
 3102              	@ 2684 "../MQXLITE/kernel/task.c" 1
 3103 0084 62B6     		cpsie i
 3104              	@ 0 "" 2
 3105              		.code	16
 3106              	.L180:
2685:../MQXLITE/kernel/task.c ****             /* END SPR */
2686:../MQXLITE/kernel/task.c ****             return (pointer)td_ptr;
 3107              		.loc 1 2686 0 is_stmt 1
 3108 0086 7B69     		ldr	r3, [r7, #20]
 3109 0088 0FE0     		b	.L175
 3110              	.L179:
2687:../MQXLITE/kernel/task.c ****         } /* Endif */
2688:../MQXLITE/kernel/task.c ****         td_ptr = (TD_STRUCT_PTR)((uchar_ptr)td_ptr->TD_LIST_INFO.NEXT - FIELD_OFFSET(TD_STRUCT,TD_L
 3111              		.loc 1 2688 0
 3112 008a 7B69     		ldr	r3, [r7, #20]
 3113 008c DB6D     		ldr	r3, [r3, #92]
 3114 008e 5C3B     		sub	r3, r3, #92
 3115 0090 7B61     		str	r3, [r7, #20]
 3116              	.L178:
2678:../MQXLITE/kernel/task.c ****     while (size--)
 3117              		.loc 1 2678 0 discriminator 1
 3118 0092 3B69     		ldr	r3, [r7, #16]
 3119 0094 5A1E     		sub	r2, r3, #1
 3120 0096 9341     		sbc	r3, r3, r2
 3121 0098 DBB2     		uxtb	r3, r3
 3122 009a 3A69     		ldr	r2, [r7, #16]
 3123 009c 013A     		sub	r2, r2, #1
 3124 009e 3A61     		str	r2, [r7, #16]
 3125 00a0 002B     		cmp	r3, #0
 3126 00a2 D7D1     		bne	.L182
2689:../MQXLITE/kernel/task.c ****     } /* Endwhile */
2690:../MQXLITE/kernel/task.c **** 
2691:../MQXLITE/kernel/task.c ****     /* SPR P171-0022-01 Use int disable, not a semaphore */
2692:../MQXLITE/kernel/task.c ****     _int_enable();
 3127              		.loc 1 2692 0
 3128 00a4 FFF7FEFF 		bl	_int_enable
2693:../MQXLITE/kernel/task.c ****     /* END SPR */
2694:../MQXLITE/kernel/task.c **** 
2695:../MQXLITE/kernel/task.c ****     return NULL;
 3129              		.loc 1 2695 0
 3130 00a8 0023     		mov	r3, #0
 3131              	.L175:
2696:../MQXLITE/kernel/task.c **** }
 3132              		.loc 1 2696 0
 3133 00aa 181C     		mov	r0, r3
 3134 00ac BD46     		mov	sp, r7
 3135 00ae 06B0     		add	sp, sp, #24
 3136              		@ sp needed for prologue
 3137 00b0 80BD     		pop	{r7, pc}
 3138              	.L184:
 3139 00b2 C046     		.align	2
 3140              	.L183:
 3141 00b4 00000000 		.word	_mqx_kernel_data
 3142              		.cfi_endproc
 3143              	.LFE32:
 3145              		.section	.text._task_set_error,"ax",%progbits
 3146              		.align	2
 3147              		.global	_task_set_error
 3148              		.code	16
 3149              		.thumb_func
 3151              	_task_set_error:
 3152              	.LFB33:
2697:../MQXLITE/kernel/task.c **** 
2698:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
2699:../MQXLITE/kernel/task.c **** 
2700:../MQXLITE/kernel/task.c **** /*!
2701:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to the task descriptor for the task ID.
2702:../MQXLITE/kernel/task.c ****  *
2703:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_get_td() API call but it can be
2704:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
2705:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
2706:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
2707:../MQXLITE/kernel/task.c ****  *
2708:../MQXLITE/kernel/task.c ****  * \param[in] task_id One of:
2709:../MQXLITE/kernel/task.c ****  * \n - Task ID for a task on this processor.
2710:../MQXLITE/kernel/task.c ****  * \n - MQX_NULL_TASK_ID (Use the current task.)
2711:../MQXLITE/kernel/task.c ****  *
2712:../MQXLITE/kernel/task.c ****  * \return Pointer to the task descriptor for task_id.
2713:../MQXLITE/kernel/task.c ****  * \return NULL (Task_id is not valid for this processor.)
2714:../MQXLITE/kernel/task.c ****  *
2715:../MQXLITE/kernel/task.c ****  * \see _task_get_td
2716:../MQXLITE/kernel/task.c ****  * \see _usr_task_ready
2717:../MQXLITE/kernel/task.c ****  */
2718:../MQXLITE/kernel/task.c **** pointer _usr_task_get_td
2719:../MQXLITE/kernel/task.c **** (
2720:../MQXLITE/kernel/task.c ****     _task_id task_id
2721:../MQXLITE/kernel/task.c **** )
2722:../MQXLITE/kernel/task.c **** {
2723:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params = {(uint_32)task_id, 0, 0, 0, 0};
2724:../MQXLITE/kernel/task.c ****     return (pointer)_mqx_api_call(MQX_API_TASK_GET_TD, &params);
2725:../MQXLITE/kernel/task.c **** }
2726:../MQXLITE/kernel/task.c **** 
2727:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
2728:../MQXLITE/kernel/task.c **** /*!
2729:../MQXLITE/kernel/task.c ****  * \brief Sets the task error code.
2730:../MQXLITE/kernel/task.c ****  *
2731:../MQXLITE/kernel/task.c ****  * MQX uses this function to indicate an error. MQX never sets the task error code
2732:../MQXLITE/kernel/task.c ****  * to MQX_OK; that is, MQX does not reset the task error code. It is the responsibility
2733:../MQXLITE/kernel/task.c ****  * of the application to reset the task error code. As a result, when an application
2734:../MQXLITE/kernel/task.c ****  * calls _task_get_error(), it gets the first error that MQX detected since the
2735:../MQXLITE/kernel/task.c ****  * last time the application reset the task error code.
2736:../MQXLITE/kernel/task.c ****  *
2737:../MQXLITE/kernel/task.c ****  * <table>
2738:../MQXLITE/kernel/task.c ****  *  <tr>
2739:../MQXLITE/kernel/task.c ****  *      <td><b> If the current task error code is: </b></td>
2740:../MQXLITE/kernel/task.c ****  *      <td><b> Function changes the task error code: </b></td>
2741:../MQXLITE/kernel/task.c ****  *  </tr>
2742:../MQXLITE/kernel/task.c ****  *  <tr>
2743:../MQXLITE/kernel/task.c ****  *      <td> MQX_OK </td>
2744:../MQXLITE/kernel/task.c ****  *      <td> To new_error_code. </td>
2745:../MQXLITE/kernel/task.c ****  *  </tr>
2746:../MQXLITE/kernel/task.c ****  *  <tr>
2747:../MQXLITE/kernel/task.c ****  *      <td> Not MQX_OK </td>
2748:../MQXLITE/kernel/task.c ****  *      <td> To new_error_code if new_error_code is MQX_OK. </td>
2749:../MQXLITE/kernel/task.c ****  *  </tr>
2750:../MQXLITE/kernel/task.c ****  * </table>
2751:../MQXLITE/kernel/task.c ****  *
2752:../MQXLITE/kernel/task.c ****  * \n If this function is called from an ISR, the function sets the interrupt error code.
2753:../MQXLITE/kernel/task.c ****  *
2754:../MQXLITE/kernel/task.c ****  * \param[in] new_error_code New task error code.
2755:../MQXLITE/kernel/task.c ****  *
2756:../MQXLITE/kernel/task.c ****  * \return Previous task error code.
2757:../MQXLITE/kernel/task.c ****  *
2758:../MQXLITE/kernel/task.c ****  * \see _task_check_stack
2759:../MQXLITE/kernel/task.c ****  * \see _task_get_error
2760:../MQXLITE/kernel/task.c ****  * \see _task_get_error_ptr
2761:../MQXLITE/kernel/task.c ****  * \see _task_errno
2762:../MQXLITE/kernel/task.c ****  */
2763:../MQXLITE/kernel/task.c **** _mqx_uint _task_set_error
2764:../MQXLITE/kernel/task.c **** (
2765:../MQXLITE/kernel/task.c ****     _mqx_uint new_error_code
2766:../MQXLITE/kernel/task.c **** )
2767:../MQXLITE/kernel/task.c **** { /* Body */
 3153              		.loc 1 2767 0
 3154              		.cfi_startproc
 3155 0000 B0B5     		push	{r4, r5, r7, lr}
 3156              	.LCFI95:
 3157              		.cfi_def_cfa_offset 16
 3158              		.cfi_offset 4, -16
 3159              		.cfi_offset 5, -12
 3160              		.cfi_offset 7, -8
 3161              		.cfi_offset 14, -4
 3162 0002 82B0     		sub	sp, sp, #8
 3163              	.LCFI96:
 3164              		.cfi_def_cfa_offset 24
 3165 0004 00AF     		add	r7, sp, #0
 3166              	.LCFI97:
 3167              		.cfi_def_cfa_register 7
 3168 0006 7860     		str	r0, [r7, #4]
2768:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_ERROR_CODE
2769:../MQXLITE/kernel/task.c ****     register KERNEL_DATA_STRUCT_PTR  kernel_data;
2770:../MQXLITE/kernel/task.c ****     register _mqx_uint               old_error_code;
2771:../MQXLITE/kernel/task.c **** 
2772:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3169              		.loc 1 2772 0
 3170 0008 0E4B     		ldr	r3, .L191
 3171 000a 1C68     		ldr	r4, [r3]
2773:../MQXLITE/kernel/task.c **** 
2774:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_set_error, new_error_code);
2775:../MQXLITE/kernel/task.c **** 
2776:../MQXLITE/kernel/task.c ****     /* get the old value */
2777:../MQXLITE/kernel/task.c ****     if (kernel_data->IN_ISR)
 3172              		.loc 1 2777 0
 3173 000c 238B     		ldrh	r3, [r4, #24]
 3174 000e 002B     		cmp	r3, #0
 3175 0010 02D0     		beq	.L186
2778:../MQXLITE/kernel/task.c ****     {
2779:../MQXLITE/kernel/task.c ****         old_error_code = kernel_data->INTERRUPT_CONTEXT_PTR->ERROR_CODE;
 3176              		.loc 1 2779 0
 3177 0012 636B     		ldr	r3, [r4, #52]
 3178 0014 DD68     		ldr	r5, [r3, #12]
 3179 0016 01E0     		b	.L187
 3180              	.L186:
2780:../MQXLITE/kernel/task.c ****     }
2781:../MQXLITE/kernel/task.c ****     else
2782:../MQXLITE/kernel/task.c ****     {
2783:../MQXLITE/kernel/task.c ****         old_error_code = kernel_data->ACTIVE_PTR->TASK_ERROR_CODE;
 3181              		.loc 1 2783 0
 3182 0018 E369     		ldr	r3, [r4, #28]
 3183 001a DD6C     		ldr	r5, [r3, #76]
 3184              	.L187:
2784:../MQXLITE/kernel/task.c ****     } /* Endif */
2785:../MQXLITE/kernel/task.c **** 
2786:../MQXLITE/kernel/task.c ****     if (( new_error_code == MQX_OK ) || ( old_error_code == MQX_OK ))
 3185              		.loc 1 2786 0
 3186 001c 7B68     		ldr	r3, [r7, #4]
 3187 001e 002B     		cmp	r3, #0
 3188 0020 01D0     		beq	.L188
 3189              		.loc 1 2786 0 is_stmt 0 discriminator 1
 3190 0022 002D     		cmp	r5, #0
 3191 0024 09D1     		bne	.L189
 3192              	.L188:
2787:../MQXLITE/kernel/task.c ****     {
2788:../MQXLITE/kernel/task.c ****         if (kernel_data->IN_ISR)
 3193              		.loc 1 2788 0 is_stmt 1
 3194 0026 238B     		ldrh	r3, [r4, #24]
 3195 0028 002B     		cmp	r3, #0
 3196 002a 03D0     		beq	.L190
2789:../MQXLITE/kernel/task.c ****         {
2790:../MQXLITE/kernel/task.c ****             kernel_data->INTERRUPT_CONTEXT_PTR->ERROR_CODE = new_error_code;
 3197              		.loc 1 2790 0
 3198 002c 636B     		ldr	r3, [r4, #52]
 3199 002e 7A68     		ldr	r2, [r7, #4]
 3200 0030 DA60     		str	r2, [r3, #12]
 3201 0032 02E0     		b	.L189
 3202              	.L190:
2791:../MQXLITE/kernel/task.c ****         }
2792:../MQXLITE/kernel/task.c ****         else
2793:../MQXLITE/kernel/task.c ****         {
2794:../MQXLITE/kernel/task.c ****             kernel_data->ACTIVE_PTR->TASK_ERROR_CODE = new_error_code;
 3203              		.loc 1 2794 0
 3204 0034 E369     		ldr	r3, [r4, #28]
 3205 0036 7A68     		ldr	r2, [r7, #4]
 3206 0038 DA64     		str	r2, [r3, #76]
 3207              	.L189:
2795:../MQXLITE/kernel/task.c ****         } /* Endif */
2796:../MQXLITE/kernel/task.c ****     } /* Endif */
2797:../MQXLITE/kernel/task.c **** 
2798:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_error, old_error_code);
2799:../MQXLITE/kernel/task.c ****     return( old_error_code );
 3208              		.loc 1 2799 0
 3209 003a 2B1C     		mov	r3, r5
2800:../MQXLITE/kernel/task.c **** #else
2801:../MQXLITE/kernel/task.c ****     return MQX_OK;
2802:../MQXLITE/kernel/task.c **** #endif
2803:../MQXLITE/kernel/task.c **** 
2804:../MQXLITE/kernel/task.c **** }
 3210              		.loc 1 2804 0
 3211 003c 181C     		mov	r0, r3
 3212 003e BD46     		mov	sp, r7
 3213 0040 02B0     		add	sp, sp, #8
 3214              		@ sp needed for prologue
 3215 0042 B0BD     		pop	{r4, r5, r7, pc}
 3216              	.L192:
 3217              		.align	2
 3218              	.L191:
 3219 0044 00000000 		.word	_mqx_kernel_data
 3220              		.cfi_endproc
 3221              	.LFE33:
 3223              		.section	.text._task_build_internal,"ax",%progbits
 3224              		.align	2
 3225              		.global	_task_build_internal
 3226              		.code	16
 3227              		.thumb_func
 3229              	_task_build_internal:
 3230              	.LFB34:
2805:../MQXLITE/kernel/task.c **** 
2806:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
2807:../MQXLITE/kernel/task.c **** 
2808:../MQXLITE/kernel/task.c **** /*!
2809:../MQXLITE/kernel/task.c ****  * \brief Sets the task error code.
2810:../MQXLITE/kernel/task.c ****  *
2811:../MQXLITE/kernel/task.c ****  * This function is an equivalent to the _task_set_error() API call but it can be
2812:../MQXLITE/kernel/task.c ****  * executed from within the User task or other code running in the CPU User mode.
2813:../MQXLITE/kernel/task.c ****  * Parameters passed to this function by pointer are required to meet the memory
2814:../MQXLITE/kernel/task.c ****  * protection requirements as described in the parameter list below.
2815:../MQXLITE/kernel/task.c ****  *
2816:../MQXLITE/kernel/task.c ****  * \param[in] new_error_code New task error code.
2817:../MQXLITE/kernel/task.c ****  *
2818:../MQXLITE/kernel/task.c ****  * \return Previous task error code.
2819:../MQXLITE/kernel/task.c ****  *
2820:../MQXLITE/kernel/task.c ****  * \see _task_set_error
2821:../MQXLITE/kernel/task.c ****  */
2822:../MQXLITE/kernel/task.c **** _task_id _usr_task_set_error
2823:../MQXLITE/kernel/task.c **** (
2824:../MQXLITE/kernel/task.c ****     _mqx_uint new_error_code
2825:../MQXLITE/kernel/task.c **** )
2826:../MQXLITE/kernel/task.c **** {
2827:../MQXLITE/kernel/task.c ****     MQX_API_CALL_PARAMS params = {(uint_32)new_error_code, 0, 0, 0, 0};
2828:../MQXLITE/kernel/task.c ****     return _mqx_api_call(MQX_API_TASK_SET_ERROR, &params);
2829:../MQXLITE/kernel/task.c **** }
2830:../MQXLITE/kernel/task.c **** 
2831:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
2832:../MQXLITE/kernel/task.c **** /*!
2833:../MQXLITE/kernel/task.c ****  * \private
2834:../MQXLITE/kernel/task.c ****  *
2835:../MQXLITE/kernel/task.c ****  * \brief Creates a new task of the type specified by the task template number,
2836:../MQXLITE/kernel/task.c ****  * but not make it ready to run.
2837:../MQXLITE/kernel/task.c ****  *
2838:../MQXLITE/kernel/task.c ****  * \param[in] template_index Task template index number for this task.
2839:../MQXLITE/kernel/task.c ****  * \param[in] parameter      The parameter to pass to the newly created task.
2840:../MQXLITE/kernel/task.c ****  * \param[in] stack_ptr      Pointer to the stack (if not NULL).
2841:../MQXLITE/kernel/task.c ****  * \param[in] stack_size     Stack size if provided by the application.
2842:../MQXLITE/kernel/task.c ****  * \param[in] user           User mode functionality.
2843:../MQXLITE/kernel/task.c ****  *
2844:../MQXLITE/kernel/task.c ****  * \return Pointer to the task descriptor for created task.
2845:../MQXLITE/kernel/task.c ****  * \return NULL
2846:../MQXLITE/kernel/task.c ****  *
2847:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
2848:../MQXLITE/kernel/task.c ****  */
2849:../MQXLITE/kernel/task.c **** TD_STRUCT_PTR _task_build_internal
2850:../MQXLITE/kernel/task.c **** (
2851:../MQXLITE/kernel/task.c ****     _mqx_uint     template_index,
2852:../MQXLITE/kernel/task.c ****     uint_32       parameter,
2853:../MQXLITE/kernel/task.c ****     pointer       stack_ptr,
2854:../MQXLITE/kernel/task.c ****     _mqx_uint     stack_size,
2855:../MQXLITE/kernel/task.c ****     boolean       user
2856:../MQXLITE/kernel/task.c **** )
2857:../MQXLITE/kernel/task.c **** {
 3231              		.loc 1 2857 0
 3232              		.cfi_startproc
 3233 0000 90B5     		push	{r4, r7, lr}
 3234              	.LCFI98:
 3235              		.cfi_def_cfa_offset 12
 3236              		.cfi_offset 4, -12
 3237              		.cfi_offset 7, -8
 3238              		.cfi_offset 14, -4
 3239 0002 8DB0     		sub	sp, sp, #52
 3240              	.LCFI99:
 3241              		.cfi_def_cfa_offset 64
 3242 0004 02AF     		add	r7, sp, #8
 3243              	.LCFI100:
 3244              		.cfi_def_cfa 7, 56
 3245 0006 F860     		str	r0, [r7, #12]
 3246 0008 B960     		str	r1, [r7, #8]
 3247 000a 7A60     		str	r2, [r7, #4]
 3248 000c 3B60     		str	r3, [r7]
2858:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
2859:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            td_ptr;
2860:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR task_template_ptr;
2861:../MQXLITE/kernel/task.c ****     boolean                  dynamic;
2862:../MQXLITE/kernel/task.c ****     uint_32                  create_parameter;
2863:../MQXLITE/kernel/task.c **** 
2864:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3249              		.loc 1 2864 0
 3250 000e 274B     		ldr	r3, .L201
 3251 0010 1B68     		ldr	r3, [r3]
 3252 0012 BB61     		str	r3, [r7, #24]
2865:../MQXLITE/kernel/task.c **** 
2866:../MQXLITE/kernel/task.c ****     if ( template_index )
 3253              		.loc 1 2866 0
 3254 0014 FB68     		ldr	r3, [r7, #12]
 3255 0016 002B     		cmp	r3, #0
 3256 0018 1CD0     		beq	.L194
2867:../MQXLITE/kernel/task.c ****     {
2868:../MQXLITE/kernel/task.c ****         dynamic = FALSE;
 3257              		.loc 1 2868 0
 3258 001a 0023     		mov	r3, #0
 3259 001c 3B62     		str	r3, [r7, #32]
2869:../MQXLITE/kernel/task.c ****         create_parameter = parameter;
 3260              		.loc 1 2869 0
 3261 001e BB68     		ldr	r3, [r7, #8]
 3262 0020 FB61     		str	r3, [r7, #28]
2870:../MQXLITE/kernel/task.c **** 
2871:../MQXLITE/kernel/task.c ****         /* Search all the local task templates for one whose index matches */
2872:../MQXLITE/kernel/task.c ****         task_template_ptr = kernel_data->INIT.TASK_TEMPLATE_LIST;
 3263              		.loc 1 2872 0
 3264 0022 BA69     		ldr	r2, [r7, #24]
 3265 0024 B823     		mov	r3, #184
 3266 0026 5B00     		lsl	r3, r3, #1
 3267 0028 D358     		ldr	r3, [r2, r3]
 3268 002a 7B62     		str	r3, [r7, #36]
2873:../MQXLITE/kernel/task.c **** 
2874:../MQXLITE/kernel/task.c ****         while ( task_template_ptr->TASK_TEMPLATE_INDEX &&
 3269              		.loc 1 2874 0
 3270 002c 02E0     		b	.L195
 3271              	.L197:
2875:../MQXLITE/kernel/task.c ****                         (task_template_ptr->TASK_TEMPLATE_INDEX != template_index) )
2876:../MQXLITE/kernel/task.c ****         {
2877:../MQXLITE/kernel/task.c ****             ++task_template_ptr;
 3272              		.loc 1 2877 0
 3273 002e 7B6A     		ldr	r3, [r7, #36]
 3274 0030 1C33     		add	r3, r3, #28
 3275 0032 7B62     		str	r3, [r7, #36]
 3276              	.L195:
2874:../MQXLITE/kernel/task.c ****         while ( task_template_ptr->TASK_TEMPLATE_INDEX &&
 3277              		.loc 1 2874 0 discriminator 1
 3278 0034 7B6A     		ldr	r3, [r7, #36]
 3279 0036 1B68     		ldr	r3, [r3]
 3280 0038 002B     		cmp	r3, #0
 3281 003a 04D0     		beq	.L196
2875:../MQXLITE/kernel/task.c ****                         (task_template_ptr->TASK_TEMPLATE_INDEX != template_index) )
 3282              		.loc 1 2875 0 discriminator 2
 3283 003c 7B6A     		ldr	r3, [r7, #36]
 3284 003e 1A68     		ldr	r2, [r3]
2874:../MQXLITE/kernel/task.c ****         while ( task_template_ptr->TASK_TEMPLATE_INDEX &&
 3285              		.loc 1 2874 0 discriminator 2
 3286 0040 FB68     		ldr	r3, [r7, #12]
 3287 0042 9A42     		cmp	r2, r3
 3288 0044 F3D1     		bne	.L197
 3289              	.L196:
2878:../MQXLITE/kernel/task.c ****         } /* Endwhile */
2879:../MQXLITE/kernel/task.c ****         if (task_template_ptr->TASK_TEMPLATE_INDEX == 0)
 3290              		.loc 1 2879 0
 3291 0046 7B6A     		ldr	r3, [r7, #36]
 3292 0048 1B68     		ldr	r3, [r3]
 3293 004a 002B     		cmp	r3, #0
 3294 004c 09D1     		bne	.L198
2880:../MQXLITE/kernel/task.c ****         {
2881:../MQXLITE/kernel/task.c ****             /* Task not found */
2882:../MQXLITE/kernel/task.c ****             task_template_ptr = NULL;
 3295              		.loc 1 2882 0
 3296 004e 0023     		mov	r3, #0
 3297 0050 7B62     		str	r3, [r7, #36]
 3298 0052 06E0     		b	.L198
 3299              	.L194:
2883:../MQXLITE/kernel/task.c ****         } /* Endif */
2884:../MQXLITE/kernel/task.c ****     }
2885:../MQXLITE/kernel/task.c ****     else
2886:../MQXLITE/kernel/task.c ****     {
2887:../MQXLITE/kernel/task.c ****         task_template_ptr = (TASK_TEMPLATE_STRUCT_PTR)parameter;
 3300              		.loc 1 2887 0
 3301 0054 BB68     		ldr	r3, [r7, #8]
 3302 0056 7B62     		str	r3, [r7, #36]
2888:../MQXLITE/kernel/task.c ****         create_parameter  = task_template_ptr->CREATION_PARAMETER;
 3303              		.loc 1 2888 0
 3304 0058 7B6A     		ldr	r3, [r7, #36]
 3305 005a 9B69     		ldr	r3, [r3, #24]
 3306 005c FB61     		str	r3, [r7, #28]
2889:../MQXLITE/kernel/task.c ****         dynamic = TRUE;
 3307              		.loc 1 2889 0
 3308 005e 0123     		mov	r3, #1
 3309 0060 3B62     		str	r3, [r7, #32]
 3310              	.L198:
2890:../MQXLITE/kernel/task.c ****     } /* Endif */
2891:../MQXLITE/kernel/task.c **** 
2892:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
2893:../MQXLITE/kernel/task.c ****     if (task_template_ptr == NULL)
 3311              		.loc 1 2893 0
 3312 0062 7B6A     		ldr	r3, [r7, #36]
 3313 0064 002B     		cmp	r3, #0
 3314 0066 04D1     		bne	.L199
2894:../MQXLITE/kernel/task.c ****     {
2895:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_NO_TASK_TEMPLATE);
 3315              		.loc 1 2895 0
 3316 0068 1020     		mov	r0, #16
 3317 006a FFF7FEFF 		bl	_task_set_error
2896:../MQXLITE/kernel/task.c ****         return NULL;
 3318              		.loc 1 2896 0
 3319 006e 0023     		mov	r3, #0
 3320 0070 18E0     		b	.L200
 3321              	.L199:
2897:../MQXLITE/kernel/task.c ****     } /* Endif */
2898:../MQXLITE/kernel/task.c **** #endif
2899:../MQXLITE/kernel/task.c **** 
2900:../MQXLITE/kernel/task.c **** 
2901:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
2902:../MQXLITE/kernel/task.c ****     /* check template for correct user task parameters */
2903:../MQXLITE/kernel/task.c ****     if (user)
2904:../MQXLITE/kernel/task.c ****     {
2905:../MQXLITE/kernel/task.c ****         if (!(task_template_ptr->TASK_ATTRIBUTES & MQX_USER_TASK))
2906:../MQXLITE/kernel/task.c ****         {
2907:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_INVALID_PARAMETER);
2908:../MQXLITE/kernel/task.c ****             return NULL;
2909:../MQXLITE/kernel/task.c ****         }
2910:../MQXLITE/kernel/task.c **** 
2911:../MQXLITE/kernel/task.c ****         if (kernel_data->INIT.MAX_USER_TASK_PRIORITY && kernel_data->INIT.MAX_USER_TASK_PRIORITY > 
2912:../MQXLITE/kernel/task.c ****         {
2913:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_INVALID_TASK_PRIORITY);
2914:../MQXLITE/kernel/task.c ****             return NULL;
2915:../MQXLITE/kernel/task.c ****         }
2916:../MQXLITE/kernel/task.c ****     }
2917:../MQXLITE/kernel/task.c **** #endif
2918:../MQXLITE/kernel/task.c **** 
2919:../MQXLITE/kernel/task.c ****     /* serialize task creation/destruction */
2920:../MQXLITE/kernel/task.c ****     _lwsem_wait((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 3322              		.loc 1 2920 0
 3323 0072 BB69     		ldr	r3, [r7, #24]
 3324 0074 F433     		add	r3, r3, #244
 3325 0076 181C     		mov	r0, r3
 3326 0078 FFF7FEFF 		bl	_lwsem_wait
2921:../MQXLITE/kernel/task.c **** 
2922:../MQXLITE/kernel/task.c ****     /* Create the task, but do not ready it */
2923:../MQXLITE/kernel/task.c ****     td_ptr = _task_init_internal(task_template_ptr, kernel_data->ACTIVE_PTR->TASK_ID, \
 3327              		.loc 1 2923 0
 3328 007c BB69     		ldr	r3, [r7, #24]
 3329 007e DB69     		ldr	r3, [r3, #28]
 3330 0080 D968     		ldr	r1, [r3, #12]
 3331 0082 786A     		ldr	r0, [r7, #36]
 3332 0084 FA69     		ldr	r2, [r7, #28]
 3333 0086 3B6A     		ldr	r3, [r7, #32]
 3334 0088 7C68     		ldr	r4, [r7, #4]
 3335 008a 0094     		str	r4, [sp]
 3336 008c 3C68     		ldr	r4, [r7]
 3337 008e 0194     		str	r4, [sp, #4]
 3338 0090 FFF7FEFF 		bl	_task_init_internal
 3339 0094 031C     		mov	r3, r0
 3340 0096 7B61     		str	r3, [r7, #20]
2924:../MQXLITE/kernel/task.c ****                     create_parameter, dynamic, stack_ptr, stack_size);
2925:../MQXLITE/kernel/task.c **** 
2926:../MQXLITE/kernel/task.c ****     /* Allow other tasks to create */
2927:../MQXLITE/kernel/task.c ****     _lwsem_post((LWSEM_STRUCT_PTR)&kernel_data->TASK_CREATE_LWSEM);
 3341              		.loc 1 2927 0
 3342 0098 BB69     		ldr	r3, [r7, #24]
 3343 009a F433     		add	r3, r3, #244
 3344 009c 181C     		mov	r0, r3
 3345 009e FFF7FEFF 		bl	_lwsem_post
2928:../MQXLITE/kernel/task.c **** 
2929:../MQXLITE/kernel/task.c ****     return(td_ptr);
 3346              		.loc 1 2929 0
 3347 00a2 7B69     		ldr	r3, [r7, #20]
 3348              	.L200:
2930:../MQXLITE/kernel/task.c **** 
2931:../MQXLITE/kernel/task.c **** } /* Endbody */
 3349              		.loc 1 2931 0
 3350 00a4 181C     		mov	r0, r3
 3351 00a6 BD46     		mov	sp, r7
 3352 00a8 0BB0     		add	sp, sp, #44
 3353              		@ sp needed for prologue
 3354 00aa 90BD     		pop	{r4, r7, pc}
 3355              	.L202:
 3356              		.align	2
 3357              	.L201:
 3358 00ac 00000000 		.word	_mqx_kernel_data
 3359              		.cfi_endproc
 3360              	.LFE34:
 3362              		.section	.text._task_exiting_function_internal,"ax",%progbits
 3363              		.align	2
 3364              		.global	_task_exiting_function_internal
 3365              		.code	16
 3366              		.thumb_func
 3368              	_task_exiting_function_internal:
 3369              	.LFB35:
2932:../MQXLITE/kernel/task.c **** 
2933:../MQXLITE/kernel/task.c **** 
2934:../MQXLITE/kernel/task.c **** /*! \private */
2935:../MQXLITE/kernel/task.c **** extern void _task_exiting_function_internal(void);  /* Dummy prototype */
2936:../MQXLITE/kernel/task.c **** /*!
2937:../MQXLITE/kernel/task.c ****  * \private
2938:../MQXLITE/kernel/task.c ****  *
2939:../MQXLITE/kernel/task.c ****  * \brief Dummy function so debuggers will display stack correctly.
2940:../MQXLITE/kernel/task.c ****  */
2941:../MQXLITE/kernel/task.c **** void _task_exiting_function_internal(void){}
 3370              		.loc 1 2941 0
 3371              		.cfi_startproc
 3372 0000 80B5     		push	{r7, lr}
 3373              	.LCFI101:
 3374              		.cfi_def_cfa_offset 8
 3375              		.cfi_offset 7, -8
 3376              		.cfi_offset 14, -4
 3377 0002 00AF     		add	r7, sp, #0
 3378              	.LCFI102:
 3379              		.cfi_def_cfa_register 7
 3380              		.loc 1 2941 0
 3381 0004 BD46     		mov	sp, r7
 3382              		@ sp needed for prologue
 3383 0006 80BD     		pop	{r7, pc}
 3384              		.cfi_endproc
 3385              	.LFE35:
 3387              		.section	.text._task_exit_function_internal,"ax",%progbits
 3388              		.align	2
 3389              		.global	_task_exit_function_internal
 3390              		.code	16
 3391              		.thumb_func
 3393              	_task_exit_function_internal:
 3394              	.LFB36:
2942:../MQXLITE/kernel/task.c **** 
2943:../MQXLITE/kernel/task.c **** /*!
2944:../MQXLITE/kernel/task.c ****  * \private
2945:../MQXLITE/kernel/task.c ****  *
2946:../MQXLITE/kernel/task.c ****  * \brief Executes the exit handler for the current task, then destroys the current task.
2947:../MQXLITE/kernel/task.c ****  */
2948:../MQXLITE/kernel/task.c **** void _task_exit_function_internal(void)
2949:../MQXLITE/kernel/task.c **** {
 3395              		.loc 1 2949 0
 3396              		.cfi_startproc
 3397 0000 80B5     		push	{r7, lr}
 3398              	.LCFI103:
 3399              		.cfi_def_cfa_offset 8
 3400              		.cfi_offset 7, -8
 3401              		.cfi_offset 14, -4
 3402 0002 82B0     		sub	sp, sp, #8
 3403              	.LCFI104:
 3404              		.cfi_def_cfa_offset 16
 3405 0004 00AF     		add	r7, sp, #0
 3406              	.LCFI105:
 3407              		.cfi_def_cfa_register 7
2950:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR kernel_data;
2951:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR          td_ptr;
2952:../MQXLITE/kernel/task.c **** 
2953:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3408              		.loc 1 2953 0
 3409 0006 094B     		ldr	r3, .L206
 3410 0008 1B68     		ldr	r3, [r3]
 3411 000a 7B60     		str	r3, [r7, #4]
2954:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_exit_function, kernel_data->ACTIVE_PTR->TASK_ID);
2955:../MQXLITE/kernel/task.c **** 
2956:../MQXLITE/kernel/task.c ****     td_ptr = kernel_data->ACTIVE_PTR;
 3412              		.loc 1 2956 0
 3413 000c 7B68     		ldr	r3, [r7, #4]
 3414 000e DB69     		ldr	r3, [r3, #28]
 3415 0010 3B60     		str	r3, [r7]
2957:../MQXLITE/kernel/task.c **** #if MQX_TASK_DESTRUCTION
2958:../MQXLITE/kernel/task.c **** 
2959:../MQXLITE/kernel/task.c **** #if MQX_HAS_EXIT_HANDLER
2960:../MQXLITE/kernel/task.c ****     if (td_ptr->EXIT_HANDLER_PTR != NULL)
 3416              		.loc 1 2960 0
 3417 0012 3B68     		ldr	r3, [r7]
 3418 0014 5B6E     		ldr	r3, [r3, #100]
 3419 0016 002B     		cmp	r3, #0
 3420 0018 02D0     		beq	.L205
2961:../MQXLITE/kernel/task.c ****     {
2962:../MQXLITE/kernel/task.c ****         (*td_ptr->EXIT_HANDLER_PTR)();
 3421              		.loc 1 2962 0
 3422 001a 3B68     		ldr	r3, [r7]
 3423 001c 5B6E     		ldr	r3, [r3, #100]
 3424 001e 9847     		blx	r3
 3425              	.L205:
2963:../MQXLITE/kernel/task.c ****     }
2964:../MQXLITE/kernel/task.c **** #endif
2965:../MQXLITE/kernel/task.c ****     (void)_task_destroy(MQX_NULL_TASK_ID); /* Never returns */
 3426              		.loc 1 2965 0
 3427 0020 0020     		mov	r0, #0
 3428 0022 FFF7FEFF 		bl	_task_destroy
2966:../MQXLITE/kernel/task.c **** #else
2967:../MQXLITE/kernel/task.c ****     td_ptr->STATE = DYING;
2968:../MQXLITE/kernel/task.c ****     while(TRUE)
2969:../MQXLITE/kernel/task.c ****     {
2970:../MQXLITE/kernel/task.c ****         _task_block();
2971:../MQXLITE/kernel/task.c ****     }
2972:../MQXLITE/kernel/task.c **** #endif /* MQX_TASK_DESTRUCTION */
2973:../MQXLITE/kernel/task.c **** }
 3429              		.loc 1 2973 0
 3430 0026 BD46     		mov	sp, r7
 3431 0028 02B0     		add	sp, sp, #8
 3432              		@ sp needed for prologue
 3433 002a 80BD     		pop	{r7, pc}
 3434              	.L207:
 3435              		.align	2
 3436              	.L206:
 3437 002c 00000000 		.word	_mqx_kernel_data
 3438              		.cfi_endproc
 3439              	.LFE36:
 3441              		.section	.text._task_init_internal,"ax",%progbits
 3442              		.align	2
 3443              		.global	_task_init_internal
 3444              		.code	16
 3445              		.thumb_func
 3447              	_task_init_internal:
 3448              	.LFB37:
2974:../MQXLITE/kernel/task.c **** 
2975:../MQXLITE/kernel/task.c **** #if MQX_EXTRA_TASK_STACK_ENABLE
2976:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
2977:../MQXLITE/kernel/task.c **** /*!
2978:../MQXLITE/kernel/task.c ****  * \brief Gets the base address of the space reserved for the active task.
2979:../MQXLITE/kernel/task.c ****  *
2980:../MQXLITE/kernel/task.c ****  * \return TD_STRUCT.TOS_RESERVED
2981:../MQXLITE/kernel/task.c ****  * \return 0 (MQX is currently in ISR.)
2982:../MQXLITE/kernel/task.c ****  *
2983:../MQXLITE/kernel/task.c ****  * \see _task_reserve_space
2984:../MQXLITE/kernel/task.c ****  */
2985:../MQXLITE/kernel/task.c **** pointer _task_get_reserved_base(void)
2986:../MQXLITE/kernel/task.c **** { /* Body */
2987:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR kernel_data;
2988:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
2989:../MQXLITE/kernel/task.c **** 
2990:../MQXLITE/kernel/task.c ****     if (kernel_data->IN_ISR)
2991:../MQXLITE/kernel/task.c ****     {
2992:../MQXLITE/kernel/task.c ****         return 0;
2993:../MQXLITE/kernel/task.c ****     } /* Endif */
2994:../MQXLITE/kernel/task.c **** 
2995:../MQXLITE/kernel/task.c ****     return kernel_data->ACTIVE_PTR->TOS_RESERVED;
2996:../MQXLITE/kernel/task.c **** 
2997:../MQXLITE/kernel/task.c **** } /* Endbody */
2998:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
2999:../MQXLITE/kernel/task.c **** #endif /* MQX_EXTRA_TASK_STACK_ENABLE */
3000:../MQXLITE/kernel/task.c **** 
3001:../MQXLITE/kernel/task.c **** /*!
3002:../MQXLITE/kernel/task.c ****  * \private
3003:../MQXLITE/kernel/task.c ****  *
3004:../MQXLITE/kernel/task.c ****  * \brief Creates task for given task template.
3005:../MQXLITE/kernel/task.c ****  *
3006:../MQXLITE/kernel/task.c ****  * \param[in] template_ptr     Task template for the new task.
3007:../MQXLITE/kernel/task.c ****  * \param[in] creator_task_id  Task ID of the creating task.
3008:../MQXLITE/kernel/task.c ****  * \param[in] create_parameter Creation parameter for the task.
3009:../MQXLITE/kernel/task.c ****  * \param[in] dynamic          TRUE (Template_ptr is a dynamic template.), FALSE
3010:../MQXLITE/kernel/task.c ****  * (Template_ptr is not a dynamic template.)
3011:../MQXLITE/kernel/task.c ****  * \param[in] input_stack_ptr  If not NULL, the location of the stack if provided.
3012:../MQXLITE/kernel/task.c ****  * \param[in] input_stack_size Input stack size if provided by the application.
3013:../MQXLITE/kernel/task.c ****  *
3014:../MQXLITE/kernel/task.c ****  * \return Pointer to the created task's descriptor.
3015:../MQXLITE/kernel/task.c ****  * \return NULL (Failure)
3016:../MQXLITE/kernel/task.c ****  *
3017:../MQXLITE/kernel/task.c ****  * \see TASK_TEMPLATE_STRUCT
3018:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
3019:../MQXLITE/kernel/task.c ****  */
3020:../MQXLITE/kernel/task.c **** TD_STRUCT_PTR _task_init_internal
3021:../MQXLITE/kernel/task.c **** (
3022:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR template_ptr,
3023:../MQXLITE/kernel/task.c ****     _task_id                 creator_task_id,
3024:../MQXLITE/kernel/task.c ****     uint_32                  create_parameter,
3025:../MQXLITE/kernel/task.c ****     boolean                  dynamic,
3026:../MQXLITE/kernel/task.c ****     pointer                  input_stack_ptr,
3027:../MQXLITE/kernel/task.c ****     _mem_size                input_stack_size
3028:../MQXLITE/kernel/task.c **** )
3029:../MQXLITE/kernel/task.c **** { /* Body */
 3449              		.loc 1 3029 0
 3450              		.cfi_startproc
 3451 0000 90B5     		push	{r4, r7, lr}
 3452              	.LCFI106:
 3453              		.cfi_def_cfa_offset 12
 3454              		.cfi_offset 4, -12
 3455              		.cfi_offset 7, -8
 3456              		.cfi_offset 14, -4
 3457 0002 8FB0     		sub	sp, sp, #60
 3458              	.LCFI107:
 3459              		.cfi_def_cfa_offset 72
 3460 0004 02AF     		add	r7, sp, #8
 3461              	.LCFI108:
 3462              		.cfi_def_cfa 7, 64
 3463 0006 F860     		str	r0, [r7, #12]
 3464 0008 B960     		str	r1, [r7, #8]
 3465 000a 7A60     		str	r2, [r7, #4]
 3466 000c 3B60     		str	r3, [r7]
3030:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR   kernel_data;
3031:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR            td_ptr;
3032:../MQXLITE/kernel/task.c ****     READY_Q_STRUCT_PTR       ready_q_ptr;
3033:../MQXLITE/kernel/task.c ****     TASK_TEMPLATE_STRUCT_PTR new_template_ptr;
3034:../MQXLITE/kernel/task.c **** #if MQX_USE_LWMEM_ALLOCATOR == 0 && !MQX_LITE_VERSION_NUMBER
3035:../MQXLITE/kernel/task.c ****     STOREBLOCK_STRUCT_PTR    block_ptr;
3036:../MQXLITE/kernel/task.c **** #endif
3037:../MQXLITE/kernel/task.c **** 
3038:../MQXLITE/kernel/task.c ****     char_ptr                 stack_ptr;
3039:../MQXLITE/kernel/task.c ****     _mqx_uint                stack_size;
3040:../MQXLITE/kernel/task.c ****     _mqx_uint                td_size;
3041:../MQXLITE/kernel/task.c **** 
3042:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3467              		.loc 1 3042 0
 3468 000e 634B     		ldr	r3, .L222
 3469 0010 1B68     		ldr	r3, [r3]
 3470 0012 3B62     		str	r3, [r7, #32]
3043:../MQXLITE/kernel/task.c **** 
3044:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
3045:../MQXLITE/kernel/task.c ****     if (template_ptr->TASK_PRIORITY > kernel_data->LOWEST_TASK_PRIORITY)
 3471              		.loc 1 3045 0
 3472 0014 FB68     		ldr	r3, [r7, #12]
 3473 0016 DA68     		ldr	r2, [r3, #12]
 3474 0018 396A     		ldr	r1, [r7, #32]
 3475 001a C423     		mov	r3, #196
 3476 001c CB58     		ldr	r3, [r1, r3]
 3477 001e 9A42     		cmp	r2, r3
 3478 0020 0BD9     		bls	.L209
3046:../MQXLITE/kernel/task.c ****     {
3047:../MQXLITE/kernel/task.c **** #if MQX_USE_IDLE_TASK
3048:../MQXLITE/kernel/task.c ****         if (template_ptr != &kernel_data->IDLE_TASK_TEMPLATE)
 3479              		.loc 1 3048 0
 3480 0022 3B6A     		ldr	r3, [r7, #32]
 3481 0024 8420     		mov	r0, #132
 3482 0026 8000     		lsl	r0, r0, #2
 3483 0028 1A18     		add	r2, r3, r0
 3484 002a FB68     		ldr	r3, [r7, #12]
 3485 002c 9A42     		cmp	r2, r3
 3486 002e 04D0     		beq	.L209
3049:../MQXLITE/kernel/task.c ****         {
3050:../MQXLITE/kernel/task.c **** #endif /* MQX_USE_IDLE_TASK */
3051:../MQXLITE/kernel/task.c **** 
3052:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_INVALID_TASK_PRIORITY);
 3487              		.loc 1 3052 0
 3488 0030 0E20     		mov	r0, #14
 3489 0032 FFF7FEFF 		bl	_task_set_error
3053:../MQXLITE/kernel/task.c ****             return (NULL);
 3490              		.loc 1 3053 0
 3491 0036 0023     		mov	r3, #0
 3492 0038 ABE0     		b	.L210
 3493              	.L209:
3054:../MQXLITE/kernel/task.c **** 
3055:../MQXLITE/kernel/task.c **** #if MQX_USE_IDLE_TASK
3056:../MQXLITE/kernel/task.c ****         }
3057:../MQXLITE/kernel/task.c **** #endif /* MQX_USE_IDLE_TASK */
3058:../MQXLITE/kernel/task.c ****     }
3059:../MQXLITE/kernel/task.c **** #endif /* MQX_CHECK_ERRORS */
3060:../MQXLITE/kernel/task.c **** 
3061:../MQXLITE/kernel/task.c **** 
3062:../MQXLITE/kernel/task.c ****     /*
3063:../MQXLITE/kernel/task.c ****      * Calculate space for the stack. Note that the stack size
3064:../MQXLITE/kernel/task.c ****      * must be no smaller than a specified minimum, and it
3065:../MQXLITE/kernel/task.c ****      * is made to be a multiple of longwords. The space allocated
3066:../MQXLITE/kernel/task.c ****      * for the stack includes the specified stacksize and the
3067:../MQXLITE/kernel/task.c ****      * overhead required by the kernel.
3068:../MQXLITE/kernel/task.c ****      */
3069:../MQXLITE/kernel/task.c ****     if (input_stack_ptr)
 3494              		.loc 1 3069 0
 3495 003a 3B6C     		ldr	r3, [r7, #64]
 3496 003c 002B     		cmp	r3, #0
 3497 003e 22D0     		beq	.L211
3070:../MQXLITE/kernel/task.c ****     {
3071:../MQXLITE/kernel/task.c ****         /* force stack size, ignore stack size from template */
3072:../MQXLITE/kernel/task.c ****         stack_size = input_stack_size;
 3498              		.loc 1 3072 0
 3499 0040 7B6C     		ldr	r3, [r7, #68]
 3500 0042 7B62     		str	r3, [r7, #36]
3073:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
3074:../MQXLITE/kernel/task.c ****         if (stack_size <= (PSP_MINSTACKSIZE+sizeof(TD_STRUCT)))
 3501              		.loc 1 3074 0
 3502 0044 7A6A     		ldr	r2, [r7, #36]
 3503 0046 8423     		mov	r3, #132
 3504 0048 5B00     		lsl	r3, r3, #1
 3505 004a 9A42     		cmp	r2, r3
 3506 004c 04D8     		bhi	.L212
3075:../MQXLITE/kernel/task.c ****         {
3076:../MQXLITE/kernel/task.c ****             _task_set_error(MQX_INVALID_SIZE);
 3507              		.loc 1 3076 0
 3508 004e 0220     		mov	r0, #2
 3509 0050 FFF7FEFF 		bl	_task_set_error
3077:../MQXLITE/kernel/task.c ****             return(NULL);
 3510              		.loc 1 3077 0
 3511 0054 0023     		mov	r3, #0
 3512 0056 9CE0     		b	.L210
 3513              	.L212:
3078:../MQXLITE/kernel/task.c ****         } /* Endif */
3079:../MQXLITE/kernel/task.c **** #endif
3080:../MQXLITE/kernel/task.c ****         td_ptr = _task_alloc_td_internal(stack_size, &td_size, input_stack_ptr, template_ptr->TASK_
 3514              		.loc 1 3080 0
 3515 0058 796A     		ldr	r1, [r7, #36]
 3516 005a 3A1C     		mov	r2, r7
 3517 005c 1432     		add	r2, r2, #20
 3518 005e 3B6C     		ldr	r3, [r7, #64]
 3519 0060 081C     		mov	r0, r1
 3520 0062 111C     		mov	r1, r2
 3521 0064 1A1C     		mov	r2, r3
 3522 0066 0023     		mov	r3, #0
 3523 0068 FFF7FEFF 		bl	_task_alloc_td_internal
 3524 006c 031C     		mov	r3, r0
 3525 006e FB62     		str	r3, [r7, #44]
3081:../MQXLITE/kernel/task.c ****         stack_size -= td_size;
 3526              		.loc 1 3081 0
 3527 0070 7B69     		ldr	r3, [r7, #20]
 3528 0072 7A6A     		ldr	r2, [r7, #36]
 3529 0074 D31A     		sub	r3, r2, r3
 3530 0076 7B62     		str	r3, [r7, #36]
3082:../MQXLITE/kernel/task.c **** 
3083:../MQXLITE/kernel/task.c ****         if (dynamic)
 3531              		.loc 1 3083 0
 3532 0078 3B68     		ldr	r3, [r7]
 3533 007a 002B     		cmp	r3, #0
 3534 007c 21D0     		beq	.L213
3084:../MQXLITE/kernel/task.c ****         {
3085:../MQXLITE/kernel/task.c ****             stack_size -=  sizeof(TASK_TEMPLATE_STRUCT);
 3535              		.loc 1 3085 0
 3536 007e 7B6A     		ldr	r3, [r7, #36]
 3537 0080 1C3B     		sub	r3, r3, #28
 3538 0082 7B62     		str	r3, [r7, #36]
 3539 0084 1DE0     		b	.L213
 3540              	.L211:
3086:../MQXLITE/kernel/task.c ****         }
3087:../MQXLITE/kernel/task.c **** 
3088:../MQXLITE/kernel/task.c ****     }
3089:../MQXLITE/kernel/task.c ****     else
3090:../MQXLITE/kernel/task.c ****     {
3091:../MQXLITE/kernel/task.c ****         /* take stack size from template */
3092:../MQXLITE/kernel/task.c ****         stack_size = template_ptr->TASK_STACKSIZE;
 3541              		.loc 1 3092 0
 3542 0086 FB68     		ldr	r3, [r7, #12]
 3543 0088 9B68     		ldr	r3, [r3, #8]
 3544 008a 7B62     		str	r3, [r7, #36]
3093:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
3094:../MQXLITE/kernel/task.c ****         if ( stack_size <= PSP_MINSTACKSIZE  )
 3545              		.loc 1 3094 0
 3546 008c 7B6A     		ldr	r3, [r7, #36]
 3547 008e 982B     		cmp	r3, #152
 3548 0090 01D8     		bhi	.L214
3095:../MQXLITE/kernel/task.c ****         {
3096:../MQXLITE/kernel/task.c ****             stack_size = PSP_MINSTACKSIZE;
 3549              		.loc 1 3096 0
 3550 0092 9823     		mov	r3, #152
 3551 0094 7B62     		str	r3, [r7, #36]
 3552              	.L214:
3097:../MQXLITE/kernel/task.c ****         } /* Endif */
3098:../MQXLITE/kernel/task.c **** #endif
3099:../MQXLITE/kernel/task.c ****         /* Make the size a multiple of the memory alignment */
3100:../MQXLITE/kernel/task.c ****         _STACK_ALIGN_VAL_LARGER(stack_size);
 3553              		.loc 1 3100 0
 3554 0096 7B6A     		ldr	r3, [r7, #36]
 3555 0098 0F33     		add	r3, r3, #15
 3556 009a 0F22     		mov	r2, #15
 3557 009c 9343     		bic	r3, r2
 3558 009e 7B62     		str	r3, [r7, #36]
3101:../MQXLITE/kernel/task.c **** 
3102:../MQXLITE/kernel/task.c **** #if 0 /* we dont need this, because we using _mem_alloc_align function in _task_alloc_td_internal *
3103:../MQXLITE/kernel/task.c **** #if PSP_MEMORY_ALIGNMENT
3104:../MQXLITE/kernel/task.c ****         /* But we need to add size to allow for alignment of stack base */
3105:../MQXLITE/kernel/task.c ****         stack_size += PSP_STACK_ALIGNMENT + 1;
3106:../MQXLITE/kernel/task.c **** #endif
3107:../MQXLITE/kernel/task.c **** #endif
3108:../MQXLITE/kernel/task.c **** 
3109:../MQXLITE/kernel/task.c ****         /*
3110:../MQXLITE/kernel/task.c ****          * Allocate space for a task descriptor and stack.
3111:../MQXLITE/kernel/task.c ****          * If there is none available,
3112:../MQXLITE/kernel/task.c ****          * then indicate that the create failed.
3113:../MQXLITE/kernel/task.c ****          */
3114:../MQXLITE/kernel/task.c ****         /* function allocate task descriptor, stack and optionally increase stack block size by siz
3115:../MQXLITE/kernel/task.c ****         td_ptr = _task_alloc_td_internal(dynamic ? (stack_size +  sizeof(TASK_TEMPLATE_STRUCT)) : s
 3559              		.loc 1 3115 0
 3560 00a0 3B68     		ldr	r3, [r7]
 3561 00a2 002B     		cmp	r3, #0
 3562 00a4 02D0     		beq	.L215
 3563              		.loc 1 3115 0 is_stmt 0 discriminator 1
 3564 00a6 7B6A     		ldr	r3, [r7, #36]
 3565 00a8 1C33     		add	r3, r3, #28
 3566 00aa 00E0     		b	.L216
 3567              	.L215:
 3568              		.loc 1 3115 0 discriminator 2
 3569 00ac 7B6A     		ldr	r3, [r7, #36]
 3570              	.L216:
3116:../MQXLITE/kernel/task.c ****                                                  &td_size, NULL, template_ptr->TASK_ATTRIBUTES & MQ
 3571              		.loc 1 3116 0 is_stmt 1 discriminator 3
 3572 00ae 3A1C     		mov	r2, r7
 3573 00b0 1432     		add	r2, r2, #20
3115:../MQXLITE/kernel/task.c ****         td_ptr = _task_alloc_td_internal(dynamic ? (stack_size +  sizeof(TASK_TEMPLATE_STRUCT)) : s
 3574              		.loc 1 3115 0 discriminator 3
 3575 00b2 181C     		mov	r0, r3
 3576 00b4 111C     		mov	r1, r2
 3577 00b6 0022     		mov	r2, #0
 3578 00b8 0023     		mov	r3, #0
 3579 00ba FFF7FEFF 		bl	_task_alloc_td_internal
 3580 00be 031C     		mov	r3, r0
 3581 00c0 FB62     		str	r3, [r7, #44]
 3582              	.L213:
3117:../MQXLITE/kernel/task.c ****     }/* Endif */
3118:../MQXLITE/kernel/task.c **** 
3119:../MQXLITE/kernel/task.c **** 
3120:../MQXLITE/kernel/task.c **** #if MQX_CHECK_MEMORY_ALLOCATION_ERRORS
3121:../MQXLITE/kernel/task.c ****     if (td_ptr == NULL)
3122:../MQXLITE/kernel/task.c ****     {
3123:../MQXLITE/kernel/task.c ****         _task_set_error(MQX_OUT_OF_TASK_DESCRIPTORS);
3124:../MQXLITE/kernel/task.c ****         return (NULL);
3125:../MQXLITE/kernel/task.c ****     } /* Endif */
3126:../MQXLITE/kernel/task.c **** #endif
3127:../MQXLITE/kernel/task.c ****     td_ptr->STATE = BLOCKED;
 3583              		.loc 1 3127 0
 3584 00c2 FB6A     		ldr	r3, [r7, #44]
 3585 00c4 0322     		mov	r2, #3
 3586 00c6 9A60     		str	r2, [r3, #8]
3128:../MQXLITE/kernel/task.c **** 
3129:../MQXLITE/kernel/task.c ****     /* get begin of new stack */
3130:../MQXLITE/kernel/task.c ****     if (td_ptr->STACK_ALLOC_BLOCK)
 3587              		.loc 1 3130 0
 3588 00c8 FB6A     		ldr	r3, [r7, #44]
 3589 00ca DB6E     		ldr	r3, [r3, #108]
 3590 00cc 002B     		cmp	r3, #0
 3591 00ce 03D0     		beq	.L217
3131:../MQXLITE/kernel/task.c ****     {
3132:../MQXLITE/kernel/task.c ****         /* (stack has been allocated) */
3133:../MQXLITE/kernel/task.c ****         /* stack start in new allocated block */
3134:../MQXLITE/kernel/task.c ****         stack_ptr = td_ptr->STACK_ALLOC_BLOCK;
 3592              		.loc 1 3134 0
 3593 00d0 FB6A     		ldr	r3, [r7, #44]
 3594 00d2 DB6E     		ldr	r3, [r3, #108]
 3595 00d4 BB62     		str	r3, [r7, #40]
 3596 00d6 03E0     		b	.L218
 3597              	.L217:
3135:../MQXLITE/kernel/task.c ****     }
3136:../MQXLITE/kernel/task.c ****     else
3137:../MQXLITE/kernel/task.c ****     {
3138:../MQXLITE/kernel/task.c ****         /* (this will be executed if user provide input_stack_size) */
3139:../MQXLITE/kernel/task.c ****         /* stack start in provided block behind TD */
3140:../MQXLITE/kernel/task.c ****         stack_ptr = (char_ptr)td_ptr + td_size;
 3598              		.loc 1 3140 0
 3599 00d8 7B69     		ldr	r3, [r7, #20]
 3600 00da FA6A     		ldr	r2, [r7, #44]
 3601 00dc D318     		add	r3, r2, r3
 3602 00de BB62     		str	r3, [r7, #40]
 3603              	.L218:
3141:../MQXLITE/kernel/task.c ****     }
3142:../MQXLITE/kernel/task.c **** 
3143:../MQXLITE/kernel/task.c ****     if (dynamic)
 3604              		.loc 1 3143 0
 3605 00e0 3B68     		ldr	r3, [r7]
 3606 00e2 002B     		cmp	r3, #0
 3607 00e4 15D0     		beq	.L219
3144:../MQXLITE/kernel/task.c ****     {
3145:../MQXLITE/kernel/task.c ****         /* task is creating from temporary template, store template before stack (in stack allocate
3146:../MQXLITE/kernel/task.c ****         new_template_ptr = (pointer)stack_ptr;
 3608              		.loc 1 3146 0
 3609 00e6 BB6A     		ldr	r3, [r7, #40]
 3610 00e8 FB61     		str	r3, [r7, #28]
3147:../MQXLITE/kernel/task.c ****         stack_ptr +=  sizeof(TASK_TEMPLATE_STRUCT);
 3611              		.loc 1 3147 0
 3612 00ea BB6A     		ldr	r3, [r7, #40]
 3613 00ec 1C33     		add	r3, r3, #28
 3614 00ee BB62     		str	r3, [r7, #40]
3148:../MQXLITE/kernel/task.c ****         *new_template_ptr = *template_ptr;
 3615              		.loc 1 3148 0
 3616 00f0 FB69     		ldr	r3, [r7, #28]
 3617 00f2 FA68     		ldr	r2, [r7, #12]
 3618 00f4 13CA     		ldmia	r2!, {r0, r1, r4}
 3619 00f6 13C3     		stmia	r3!, {r0, r1, r4}
 3620 00f8 13CA     		ldmia	r2!, {r0, r1, r4}
 3621 00fa 13C3     		stmia	r3!, {r0, r1, r4}
 3622 00fc 1268     		ldr	r2, [r2]
 3623 00fe 1A60     		str	r2, [r3]
3149:../MQXLITE/kernel/task.c ****         template_ptr = new_template_ptr;
 3624              		.loc 1 3149 0
 3625 0100 FB69     		ldr	r3, [r7, #28]
 3626 0102 FB60     		str	r3, [r7, #12]
3150:../MQXLITE/kernel/task.c ****         template_ptr->TASK_TEMPLATE_INDEX |= SYSTEM_TASK_FLAG;
 3627              		.loc 1 3150 0
 3628 0104 FB68     		ldr	r3, [r7, #12]
 3629 0106 1B68     		ldr	r3, [r3]
 3630 0108 8022     		mov	r2, #128
 3631 010a 1206     		lsl	r2, r2, #24
 3632 010c 1A43     		orr	r2, r3
 3633 010e FB68     		ldr	r3, [r7, #12]
 3634 0110 1A60     		str	r2, [r3]
 3635              	.L219:
3151:../MQXLITE/kernel/task.c ****         /* stack_ptr is moved behind template */
3152:../MQXLITE/kernel/task.c ****     }
3153:../MQXLITE/kernel/task.c **** 
3154:../MQXLITE/kernel/task.c **** #if MQX_MONITOR_STACK
3155:../MQXLITE/kernel/task.c ****     /* fill stack with mark for TAD stack overflow functionality */
3156:../MQXLITE/kernel/task.c ****     _task_fill_stack_internal((_mqx_uint_ptr)stack_ptr, stack_size);
 3636              		.loc 1 3156 0
 3637 0112 BA6A     		ldr	r2, [r7, #40]
 3638 0114 7B6A     		ldr	r3, [r7, #36]
 3639 0116 101C     		mov	r0, r2
 3640 0118 191C     		mov	r1, r3
 3641 011a FFF7FEFF 		bl	_task_fill_stack_internal
3157:../MQXLITE/kernel/task.c **** #endif
3158:../MQXLITE/kernel/task.c **** 
3159:../MQXLITE/kernel/task.c ****     /*  Find the ready_q that the new task belongs to.  */
3160:../MQXLITE/kernel/task.c ****     /* The ready queues are stored as a array as follows:
3161:../MQXLITE/kernel/task.c ****      *     lowest priority - eg 9
3162:../MQXLITE/kernel/task.c ****      *                          8
3163:../MQXLITE/kernel/task.c ****      *                        ...
3164:../MQXLITE/kernel/task.c ****      *     highest priority     0
3165:../MQXLITE/kernel/task.c ****      * With the READY_Q_LIST pointer pointing to the highest priority queue
3166:../MQXLITE/kernel/task.c ****      */
3167:../MQXLITE/kernel/task.c ****     ready_q_ptr = kernel_data->READY_Q_LIST - template_ptr->TASK_PRIORITY;
 3642              		.loc 1 3167 0
 3643 011e 3B6A     		ldr	r3, [r7, #32]
 3644 0120 1A6A     		ldr	r2, [r3, #32]
 3645 0122 FB68     		ldr	r3, [r7, #12]
 3646 0124 DB68     		ldr	r3, [r3, #12]
 3647 0126 1B01     		lsl	r3, r3, #4
 3648 0128 5B42     		neg	r3, r3
 3649 012a D318     		add	r3, r2, r3
 3650 012c BB61     		str	r3, [r7, #24]
3168:../MQXLITE/kernel/task.c ****     td_ptr->MY_QUEUE = ready_q_ptr;
 3651              		.loc 1 3168 0
 3652 012e FB6A     		ldr	r3, [r7, #44]
 3653 0130 BA69     		ldr	r2, [r7, #24]
 3654 0132 DA61     		str	r2, [r3, #28]
3169:../MQXLITE/kernel/task.c **** #if MQX_HAS_DYNAMIC_PRIORITIES
3170:../MQXLITE/kernel/task.c ****     td_ptr->HOME_QUEUE  = ready_q_ptr;
 3655              		.loc 1 3170 0
 3656 0134 FB6A     		ldr	r3, [r7, #44]
 3657 0136 BA69     		ldr	r2, [r7, #24]
 3658 0138 1A62     		str	r2, [r3, #32]
3171:../MQXLITE/kernel/task.c **** #endif
3172:../MQXLITE/kernel/task.c ****     td_ptr->TASK_SR     = ready_q_ptr->ENABLE_SR;
 3659              		.loc 1 3172 0
 3660 013a BB69     		ldr	r3, [r7, #24]
 3661 013c 9A89     		ldrh	r2, [r3, #12]
 3662 013e FB6A     		ldr	r3, [r7, #44]
 3663 0140 9A84     		strh	r2, [r3, #36]
3173:../MQXLITE/kernel/task.c ****     td_ptr->FLAGS       = template_ptr->TASK_ATTRIBUTES;
 3664              		.loc 1 3173 0
 3665 0142 FB68     		ldr	r3, [r7, #12]
 3666 0144 5A69     		ldr	r2, [r3, #20]
 3667 0146 FB6A     		ldr	r3, [r7, #44]
 3668 0148 9A62     		str	r2, [r3, #40]
3174:../MQXLITE/kernel/task.c **** 
3175:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
3176:../MQXLITE/kernel/task.c ****     if (template_ptr->TASK_ATTRIBUTES & MQX_USER_TASK)
3177:../MQXLITE/kernel/task.c ****     {
3178:../MQXLITE/kernel/task.c ****         td_ptr->FLAGS |= TASK_USER_MODE;
3179:../MQXLITE/kernel/task.c ****     }
3180:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
3181:../MQXLITE/kernel/task.c **** 
3182:../MQXLITE/kernel/task.c ****     if (input_stack_ptr)
 3669              		.loc 1 3182 0
 3670 014a 3B6C     		ldr	r3, [r7, #64]
 3671 014c 002B     		cmp	r3, #0
 3672 014e 05D0     		beq	.L220
3183:../MQXLITE/kernel/task.c ****     {
3184:../MQXLITE/kernel/task.c ****         td_ptr->FLAGS |= TASK_STACK_PREALLOCATED;
 3673              		.loc 1 3184 0
 3674 0150 FB6A     		ldr	r3, [r7, #44]
 3675 0152 9B6A     		ldr	r3, [r3, #40]
 3676 0154 2022     		mov	r2, #32
 3677 0156 1A43     		orr	r2, r3
 3678 0158 FB6A     		ldr	r3, [r7, #44]
 3679 015a 9A62     		str	r2, [r3, #40]
 3680              	.L220:
3185:../MQXLITE/kernel/task.c ****     } /* Endif */
3186:../MQXLITE/kernel/task.c **** 
3187:../MQXLITE/kernel/task.c ****     /* create stack frame - initialize stack parameters in TD and stack itself (registers required 
3188:../MQXLITE/kernel/task.c ****     if (FALSE == _psp_build_stack_frame(td_ptr, stack_ptr, stack_size, template_ptr, (_mqx_uint)rea
 3681              		.loc 1 3188 0
 3682 015c BB69     		ldr	r3, [r7, #24]
 3683 015e 9B89     		ldrh	r3, [r3, #12]
 3684 0160 1C1C     		mov	r4, r3
 3685 0162 F86A     		ldr	r0, [r7, #44]
 3686 0164 B96A     		ldr	r1, [r7, #40]
 3687 0166 7A6A     		ldr	r2, [r7, #36]
 3688 0168 FB68     		ldr	r3, [r7, #12]
 3689 016a 0094     		str	r4, [sp]
 3690 016c 7C68     		ldr	r4, [r7, #4]
 3691 016e 0194     		str	r4, [sp, #4]
 3692 0170 FFF7FEFF 		bl	_psp_build_stack_frame
 3693 0174 031C     		mov	r3, r0
 3694 0176 01D1     		bne	.L221
3189:../MQXLITE/kernel/task.c ****     {
3190:../MQXLITE/kernel/task.c ****         /* build stack failed */
3191:../MQXLITE/kernel/task.c ****         return NULL;
 3695              		.loc 1 3191 0
 3696 0178 0023     		mov	r3, #0
 3697 017a 0AE0     		b	.L210
 3698              	.L221:
3192:../MQXLITE/kernel/task.c ****     }
3193:../MQXLITE/kernel/task.c **** 
3194:../MQXLITE/kernel/task.c **** 
3195:../MQXLITE/kernel/task.c ****     /* Initialize the task's task descriptor. */
3196:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TASK_TEMPLATE_PTR
3197:../MQXLITE/kernel/task.c ****     td_ptr->TASK_TEMPLATE_PTR = template_ptr;
 3699              		.loc 1 3197 0
 3700 017c FB6A     		ldr	r3, [r7, #44]
 3701 017e FA68     		ldr	r2, [r7, #12]
 3702 0180 9A65     		str	r2, [r3, #88]
3198:../MQXLITE/kernel/task.c **** #endif
3199:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_TEMPLATE_INDEX
3200:../MQXLITE/kernel/task.c ****     td_ptr->TEMPLATE_INDEX    = template_ptr->TASK_TEMPLATE_INDEX;
 3703              		.loc 1 3200 0
 3704 0182 FB68     		ldr	r3, [r7, #12]
 3705 0184 1A68     		ldr	r2, [r3]
 3706 0186 FB6A     		ldr	r3, [r7, #44]
 3707 0188 5A65     		str	r2, [r3, #84]
3201:../MQXLITE/kernel/task.c **** #endif
3202:../MQXLITE/kernel/task.c **** 
3203:../MQXLITE/kernel/task.c **** #if MQX_HAS_TIME_SLICE
3204:../MQXLITE/kernel/task.c ****     /* Use the provided default time slice */
3205:../MQXLITE/kernel/task.c ****     if (template_ptr->DEFAULT_TIME_SLICE)
3206:../MQXLITE/kernel/task.c ****     {
3207:../MQXLITE/kernel/task.c **** #if (MQX_DEFAULT_TIME_SLICE_IN_TICKS == 0)
3208:../MQXLITE/kernel/task.c ****         uint_32 ticks;
3209:../MQXLITE/kernel/task.c **** 
3210:../MQXLITE/kernel/task.c ****         ticks = ((template_ptr->DEFAULT_TIME_SLICE * 2 *
3211:../MQXLITE/kernel/task.c ****                         kernel_data->TICKS_PER_SECOND) / 1000) / 2  /* Rounding.. */;
3212:../MQXLITE/kernel/task.c ****         PSP_ADD_TICKS_TO_TICK_STRUCT(&td_ptr->TIME_SLICE,
3213:../MQXLITE/kernel/task.c ****             ticks, &td_ptr->TIME_SLICE);
3214:../MQXLITE/kernel/task.c **** #else
3215:../MQXLITE/kernel/task.c ****         PSP_ADD_TICKS_TO_TICK_STRUCT(&td_ptr->TIME_SLICE,
3216:../MQXLITE/kernel/task.c ****             template_ptr->DEFAULT_TIME_SLICE, &td_ptr->TIME_SLICE);
3217:../MQXLITE/kernel/task.c **** #endif
3218:../MQXLITE/kernel/task.c ****     }
3219:../MQXLITE/kernel/task.c ****     else
3220:../MQXLITE/kernel/task.c ****     {
3221:../MQXLITE/kernel/task.c ****         td_ptr->TIME_SLICE = kernel_data->SCHED_TIME_SLICE;
3222:../MQXLITE/kernel/task.c ****     } /* Endif */
3223:../MQXLITE/kernel/task.c ****     if (kernel_data->SCHED_POLICY == MQX_SCHED_RR)
3224:../MQXLITE/kernel/task.c ****     {
3225:../MQXLITE/kernel/task.c ****         td_ptr->FLAGS |= MQX_TIME_SLICE_TASK;
3226:../MQXLITE/kernel/task.c ****     } /* Endif */
3227:../MQXLITE/kernel/task.c **** #endif
3228:../MQXLITE/kernel/task.c **** 
3229:../MQXLITE/kernel/task.c **** #if MQX_USE_IO
3230:../MQXLITE/kernel/task.c ****     td_ptr->STDIN_STREAM  = kernel_data->PROCESSOR_STDIN;
3231:../MQXLITE/kernel/task.c ****     td_ptr->STDOUT_STREAM = kernel_data->PROCESSOR_STDOUT;
3232:../MQXLITE/kernel/task.c ****     td_ptr->STDERR_STREAM = kernel_data->PROCESSOR_STDERR;
3233:../MQXLITE/kernel/task.c **** #endif
3234:../MQXLITE/kernel/task.c **** 
3235:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_PARENT
3236:../MQXLITE/kernel/task.c ****     td_ptr->PARENT = creator_task_id;
 3708              		.loc 1 3236 0
 3709 018a FB6A     		ldr	r3, [r7, #44]
 3710 018c BA68     		ldr	r2, [r7, #8]
 3711 018e 1A65     		str	r2, [r3, #80]
3237:../MQXLITE/kernel/task.c **** #endif
3238:../MQXLITE/kernel/task.c **** 
3239:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
3240:../MQXLITE/kernel/task.c ****     /*
3241:../MQXLITE/kernel/task.c ****      * Move ownership of the td from the creating task, to the
3242:../MQXLITE/kernel/task.c ****      * newly created task.
3243:../MQXLITE/kernel/task.c ****      */
3244:../MQXLITE/kernel/task.c **** #if MQX_USE_LWMEM_ALLOCATOR==0
3245:../MQXLITE/kernel/task.c ****     block_ptr = GET_MEMBLOCK_PTR(td_ptr);
3246:../MQXLITE/kernel/task.c ****     kernel_data->ACTIVE_PTR->MEMORY_RESOURCE_LIST = block_ptr->NEXTBLOCK;
3247:../MQXLITE/kernel/task.c **** #endif
3248:../MQXLITE/kernel/task.c **** 
3249:../MQXLITE/kernel/task.c ****     if (input_stack_ptr == 0)
3250:../MQXLITE/kernel/task.c ****     {
3251:../MQXLITE/kernel/task.c ****         _mem_transfer_internal(td_ptr, td_ptr);
3252:../MQXLITE/kernel/task.c ****         _mem_transfer_internal(td_ptr->STACK_ALLOC_BLOCK, td_ptr);
3253:../MQXLITE/kernel/task.c ****     } /* Endif */
3254:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
3255:../MQXLITE/kernel/task.c **** 
3256:../MQXLITE/kernel/task.c ****     return (td_ptr);
 3712              		.loc 1 3256 0
 3713 0190 FB6A     		ldr	r3, [r7, #44]
 3714              	.L210:
3257:../MQXLITE/kernel/task.c **** 
3258:../MQXLITE/kernel/task.c **** } /* Endbody */
 3715              		.loc 1 3258 0
 3716 0192 181C     		mov	r0, r3
 3717 0194 BD46     		mov	sp, r7
 3718 0196 0DB0     		add	sp, sp, #52
 3719              		@ sp needed for prologue
 3720 0198 90BD     		pop	{r4, r7, pc}
 3721              	.L223:
 3722 019a C046     		.align	2
 3723              	.L222:
 3724 019c 00000000 		.word	_mqx_kernel_data
 3725              		.cfi_endproc
 3726              	.LFE37:
 3728              		.section	.text._task_fill_stack_internal,"ax",%progbits
 3729              		.align	2
 3730              		.global	_task_fill_stack_internal
 3731              		.code	16
 3732              		.thumb_func
 3734              	_task_fill_stack_internal:
 3735              	.LFB38:
3259:../MQXLITE/kernel/task.c **** 
3260:../MQXLITE/kernel/task.c **** #if MQX_MONITOR_STACK
3261:../MQXLITE/kernel/task.c **** /*!
3262:../MQXLITE/kernel/task.c ****  * \private
3263:../MQXLITE/kernel/task.c ****  *
3264:../MQXLITE/kernel/task.c ****  * \brief Initializes a stack to be filled with the MQX_MONITOR_STACK_VALUE: "stak".
3265:../MQXLITE/kernel/task.c ****  *
3266:../MQXLITE/kernel/task.c ****  * \param[in] addr_ptr Pointer to the start of the stack which is to be filled.
3267:../MQXLITE/kernel/task.c ****  * \param[in] size     The number of bytes to be filled.
3268:../MQXLITE/kernel/task.c ****  */
3269:../MQXLITE/kernel/task.c **** void _task_fill_stack_internal
3270:../MQXLITE/kernel/task.c **** (
3271:../MQXLITE/kernel/task.c ****     _mqx_uint_ptr addr_ptr,
3272:../MQXLITE/kernel/task.c ****     _mqx_uint     size
3273:../MQXLITE/kernel/task.c **** )
3274:../MQXLITE/kernel/task.c **** { /* Body */
 3736              		.loc 1 3274 0
 3737              		.cfi_startproc
 3738 0000 80B5     		push	{r7, lr}
 3739              	.LCFI109:
 3740              		.cfi_def_cfa_offset 8
 3741              		.cfi_offset 7, -8
 3742              		.cfi_offset 14, -4
 3743 0002 82B0     		sub	sp, sp, #8
 3744              	.LCFI110:
 3745              		.cfi_def_cfa_offset 16
 3746 0004 00AF     		add	r7, sp, #0
 3747              	.LCFI111:
 3748              		.cfi_def_cfa_register 7
 3749 0006 7860     		str	r0, [r7, #4]
 3750 0008 3960     		str	r1, [r7]
3275:../MQXLITE/kernel/task.c **** 
3276:../MQXLITE/kernel/task.c ****     size = (size/sizeof(_mqx_uint)) + 1;  /* Calculate # _mqx_uints */
 3751              		.loc 1 3276 0
 3752 000a 3B68     		ldr	r3, [r7]
 3753 000c 9B08     		lsr	r3, r3, #2
 3754 000e 0133     		add	r3, r3, #1
 3755 0010 3B60     		str	r3, [r7]
3277:../MQXLITE/kernel/task.c ****     while (--size)
 3756              		.loc 1 3277 0
 3757 0012 05E0     		b	.L225
 3758              	.L226:
3278:../MQXLITE/kernel/task.c ****     {
3279:../MQXLITE/kernel/task.c ****         *addr_ptr++ = MQX_STACK_MONITOR_VALUE;
 3759              		.loc 1 3279 0
 3760 0014 7B68     		ldr	r3, [r7, #4]
 3761 0016 074A     		ldr	r2, .L227
 3762 0018 1A60     		str	r2, [r3]
 3763 001a 7B68     		ldr	r3, [r7, #4]
 3764 001c 0433     		add	r3, r3, #4
 3765 001e 7B60     		str	r3, [r7, #4]
 3766              	.L225:
3277:../MQXLITE/kernel/task.c ****     while (--size)
 3767              		.loc 1 3277 0 discriminator 1
 3768 0020 3B68     		ldr	r3, [r7]
 3769 0022 013B     		sub	r3, r3, #1
 3770 0024 3B60     		str	r3, [r7]
 3771 0026 3B68     		ldr	r3, [r7]
 3772 0028 002B     		cmp	r3, #0
 3773 002a F3D1     		bne	.L226
3280:../MQXLITE/kernel/task.c ****     } /* Endwhile */
3281:../MQXLITE/kernel/task.c **** 
3282:../MQXLITE/kernel/task.c **** } /* Endbody */
 3774              		.loc 1 3282 0
 3775 002c BD46     		mov	sp, r7
 3776 002e 02B0     		add	sp, sp, #8
 3777              		@ sp needed for prologue
 3778 0030 80BD     		pop	{r7, pc}
 3779              	.L228:
 3780 0032 C046     		.align	2
 3781              	.L227:
 3782 0034 6B617473 		.word	1937006955
 3783              		.cfi_endproc
 3784              	.LFE38:
 3786              		.section	.text._task_ready_internal,"ax",%progbits
 3787              		.align	2
 3788              		.global	_task_ready_internal
 3789              		.code	16
 3790              		.thumb_func
 3792              	_task_ready_internal:
 3793              	.LFB39:
3283:../MQXLITE/kernel/task.c **** #endif
3284:../MQXLITE/kernel/task.c **** 
3285:../MQXLITE/kernel/task.c **** /*!
3286:../MQXLITE/kernel/task.c ****  * \private
3287:../MQXLITE/kernel/task.c ****  *
3288:../MQXLITE/kernel/task.c ****  * \brief Adds a task to the ready to run queue.
3289:../MQXLITE/kernel/task.c ****  *
3290:../MQXLITE/kernel/task.c ****  * This function MUST BE CALLED DISABLED.
3291:../MQXLITE/kernel/task.c ****  *
3292:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr Pointer to the task descriptor to add.
3293:../MQXLITE/kernel/task.c ****  *
3294:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
3295:../MQXLITE/kernel/task.c ****  */
3296:../MQXLITE/kernel/task.c **** void _task_ready_internal
3297:../MQXLITE/kernel/task.c **** (
3298:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr
3299:../MQXLITE/kernel/task.c **** )
3300:../MQXLITE/kernel/task.c **** { /* Body */
 3794              		.loc 1 3300 0
 3795              		.cfi_startproc
 3796 0000 B0B5     		push	{r4, r5, r7, lr}
 3797              	.LCFI112:
 3798              		.cfi_def_cfa_offset 16
 3799              		.cfi_offset 4, -16
 3800              		.cfi_offset 5, -12
 3801              		.cfi_offset 7, -8
 3802              		.cfi_offset 14, -4
 3803 0002 84B0     		sub	sp, sp, #16
 3804              	.LCFI113:
 3805              		.cfi_def_cfa_offset 32
 3806 0004 00AF     		add	r7, sp, #0
 3807              	.LCFI114:
 3808              		.cfi_def_cfa_register 7
 3809 0006 7860     		str	r0, [r7, #4]
3301:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR       kernel_data;
3302:../MQXLITE/kernel/task.c ****     register READY_Q_STRUCT_PTR  ready_q_ptr;
3303:../MQXLITE/kernel/task.c ****     register TD_STRUCT_PTR       old_tail_ptr;
3304:../MQXLITE/kernel/task.c **** 
3305:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3810              		.loc 1 3305 0
 3811 0008 0D4B     		ldr	r3, .L231
 3812 000a 1B68     		ldr	r3, [r3]
 3813 000c FB60     		str	r3, [r7, #12]
3306:../MQXLITE/kernel/task.c **** 
3307:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_ready, td_ptr);
3308:../MQXLITE/kernel/task.c **** 
3309:../MQXLITE/kernel/task.c ****     ready_q_ptr   = td_ptr->MY_QUEUE;
 3814              		.loc 1 3309 0
 3815 000e 7B68     		ldr	r3, [r7, #4]
 3816 0010 DC69     		ldr	r4, [r3, #28]
3310:../MQXLITE/kernel/task.c ****     old_tail_ptr  = ready_q_ptr->TAIL_READY_Q;
 3817              		.loc 1 3310 0
 3818 0012 6568     		ldr	r5, [r4, #4]
3311:../MQXLITE/kernel/task.c ****     /*
3312:../MQXLITE/kernel/task.c ****      * Ready queues are ALWAYS allocated with higher priority queues in higher
3313:../MQXLITE/kernel/task.c ****      * memory, thus we need to update the CURRENT_READY_Q field (which
3314:../MQXLITE/kernel/task.c ****      * always points to the highest priority ready queue with a task
3315:../MQXLITE/kernel/task.c ****      * on it.
3316:../MQXLITE/kernel/task.c ****      */
3317:../MQXLITE/kernel/task.c ****     if ( (uchar_ptr)ready_q_ptr > (uchar_ptr)(kernel_data->CURRENT_READY_Q) )
 3819              		.loc 1 3317 0
 3820 0014 FB68     		ldr	r3, [r7, #12]
 3821 0016 5B6A     		ldr	r3, [r3, #36]
 3822 0018 A342     		cmp	r3, r4
 3823 001a 01D2     		bcs	.L230
3318:../MQXLITE/kernel/task.c ****     {
3319:../MQXLITE/kernel/task.c ****         kernel_data->CURRENT_READY_Q = ready_q_ptr;
 3824              		.loc 1 3319 0
 3825 001c FB68     		ldr	r3, [r7, #12]
 3826 001e 5C62     		str	r4, [r3, #36]
 3827              	.L230:
3320:../MQXLITE/kernel/task.c ****     } /* Endif */
3321:../MQXLITE/kernel/task.c **** 
3322:../MQXLITE/kernel/task.c ****     td_ptr->STATE              = READY;
 3828              		.loc 1 3322 0
 3829 0020 7B68     		ldr	r3, [r7, #4]
 3830 0022 0222     		mov	r2, #2
 3831 0024 9A60     		str	r2, [r3, #8]
3323:../MQXLITE/kernel/task.c ****     td_ptr->TD_PREV            = old_tail_ptr;
 3832              		.loc 1 3323 0
 3833 0026 7B68     		ldr	r3, [r7, #4]
 3834 0028 5D60     		str	r5, [r3, #4]
3324:../MQXLITE/kernel/task.c ****     td_ptr->TD_NEXT            = old_tail_ptr->TD_NEXT;
 3835              		.loc 1 3324 0
 3836 002a 2A68     		ldr	r2, [r5]
 3837 002c 7B68     		ldr	r3, [r7, #4]
 3838 002e 1A60     		str	r2, [r3]
3325:../MQXLITE/kernel/task.c ****     old_tail_ptr->TD_NEXT      = td_ptr;
 3839              		.loc 1 3325 0
 3840 0030 7B68     		ldr	r3, [r7, #4]
 3841 0032 2B60     		str	r3, [r5]
3326:../MQXLITE/kernel/task.c ****     ready_q_ptr->TAIL_READY_Q  = td_ptr;
 3842              		.loc 1 3326 0
 3843 0034 7B68     		ldr	r3, [r7, #4]
 3844 0036 6360     		str	r3, [r4, #4]
3327:../MQXLITE/kernel/task.c ****     /* SPR P171-0020-01 add macro to zero tick structure */
3328:../MQXLITE/kernel/task.c **** #if MQX_HAS_TIME_SLICE
3329:../MQXLITE/kernel/task.c ****     MQX_ZERO_TICK_STRUCT(&td_ptr->CURRENT_TIME_SLICE);
3330:../MQXLITE/kernel/task.c **** #endif
3331:../MQXLITE/kernel/task.c ****     /* END SPR */
3332:../MQXLITE/kernel/task.c ****     _KLOGX1(KLOG_task_ready);
3333:../MQXLITE/kernel/task.c **** 
3334:../MQXLITE/kernel/task.c **** } /* Endbody */
 3845              		.loc 1 3334 0
 3846 0038 BD46     		mov	sp, r7
 3847 003a 04B0     		add	sp, sp, #16
 3848              		@ sp needed for prologue
 3849 003c B0BD     		pop	{r4, r5, r7, pc}
 3850              	.L232:
 3851 003e C046     		.align	2
 3852              	.L231:
 3853 0040 00000000 		.word	_mqx_kernel_data
 3854              		.cfi_endproc
 3855              	.LFE39:
 3857              		.section	.text._task_sync_priority_internal,"ax",%progbits
 3858              		.align	2
 3859              		.global	_task_sync_priority_internal
 3860              		.code	16
 3861              		.thumb_func
 3863              	_task_sync_priority_internal:
 3864              	.LFB40:
3335:../MQXLITE/kernel/task.c **** 
3336:../MQXLITE/kernel/task.c **** #if MQX_EXTRA_TASK_STACK_ENABLE
3337:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
3338:../MQXLITE/kernel/task.c **** /*!
3339:../MQXLITE/kernel/task.c ****  * \brief Reserves space to add to every stack.
3340:../MQXLITE/kernel/task.c ****  *
3341:../MQXLITE/kernel/task.c ****  * This function reserves 'size' bytes that will be added to the size of every
3342:../MQXLITE/kernel/task.c ****  * task's stack. It can be thought of as a way of allocating "task local storage"
3343:../MQXLITE/kernel/task.c ****  * or perhaps as a way of dynamically adding to the TD_STRUCT. Both "OS Changer"
3344:../MQXLITE/kernel/task.c ****  * and the MetaWare C/C++ runtime want additional per-task variables. However,
3345:../MQXLITE/kernel/task.c ****  * this is a general feature that can be used for many more purposes.
3346:../MQXLITE/kernel/task.c ****  *
3347:../MQXLITE/kernel/task.c ****  * \note
3348:../MQXLITE/kernel/task.c ****  * The space added to each task must be known before ANY tasks are created.
3349:../MQXLITE/kernel/task.c ****  *
3350:../MQXLITE/kernel/task.c ****  * \param[in] size Amount of space to reserve.
3351:../MQXLITE/kernel/task.c ****  *
3352:../MQXLITE/kernel/task.c ****  * \return Byte offset from reserved area base address.
3353:../MQXLITE/kernel/task.c ****  *
3354:../MQXLITE/kernel/task.c ****  * \see _task_get_reserved_base
3355:../MQXLITE/kernel/task.c ****  * \see _task_alloc_td_internal
3356:../MQXLITE/kernel/task.c ****  */
3357:../MQXLITE/kernel/task.c **** _mqx_uint _task_reserve_space
3358:../MQXLITE/kernel/task.c **** (
3359:../MQXLITE/kernel/task.c ****     _mqx_uint size
3360:../MQXLITE/kernel/task.c **** )
3361:../MQXLITE/kernel/task.c **** { /* Body */
3362:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR kernel_data;
3363:../MQXLITE/kernel/task.c ****     _mqx_uint              off, algn;
3364:../MQXLITE/kernel/task.c **** 
3365:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
3366:../MQXLITE/kernel/task.c **** 
3367:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
3368:../MQXLITE/kernel/task.c ****     /* Can only be called prior to creating any tasks! */
3369:../MQXLITE/kernel/task.c ****     if (_QUEUE_GET_SIZE(&kernel_data->TD_LIST) != 0)
3370:../MQXLITE/kernel/task.c ****     {
3371:../MQXLITE/kernel/task.c ****         _mqx_fatal_error(MQX_EINVAL);
3372:../MQXLITE/kernel/task.c ****     } /* Endif */
3373:../MQXLITE/kernel/task.c **** #endif
3374:../MQXLITE/kernel/task.c **** 
3375:../MQXLITE/kernel/task.c ****     if      (size > 7) algn = 7;
3376:../MQXLITE/kernel/task.c ****     else if (size > 3) algn = 3;
3377:../MQXLITE/kernel/task.c ****     else if (size > 1) algn = 1;
3378:../MQXLITE/kernel/task.c ****     else               algn = 0;
3379:../MQXLITE/kernel/task.c **** 
3380:../MQXLITE/kernel/task.c ****     if (algn > kernel_data->TOS_RESERVED_ALIGN_MASK)
3381:../MQXLITE/kernel/task.c ****     {
3382:../MQXLITE/kernel/task.c ****         kernel_data->TOS_RESERVED_ALIGN_MASK = algn;
3383:../MQXLITE/kernel/task.c ****     } /* Endif */
3384:../MQXLITE/kernel/task.c **** 
3385:../MQXLITE/kernel/task.c ****     off = (kernel_data->TOS_RESERVED_SIZE + algn) & ~algn;
3386:../MQXLITE/kernel/task.c ****     kernel_data->TOS_RESERVED_SIZE = off + size;
3387:../MQXLITE/kernel/task.c **** 
3388:../MQXLITE/kernel/task.c ****     return off;
3389:../MQXLITE/kernel/task.c **** 
3390:../MQXLITE/kernel/task.c **** } /* Endbody */
3391:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
3392:../MQXLITE/kernel/task.c **** #endif /* MQX_EXTRA_TASK_STACK_ENABLE */
3393:../MQXLITE/kernel/task.c **** 
3394:../MQXLITE/kernel/task.c **** /*!
3395:../MQXLITE/kernel/task.c ****  * \private
3396:../MQXLITE/kernel/task.c ****  *
3397:../MQXLITE/kernel/task.c ****  * \brief Changes task's priority level.
3398:../MQXLITE/kernel/task.c ****  *
3399:../MQXLITE/kernel/task.c ****  * This function is called when a quiescent task's priority level has changed, and
3400:../MQXLITE/kernel/task.c ****  * the hardware disable/enable bits may need to be patched to the correct level.
3401:../MQXLITE/kernel/task.c ****  *
3402:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr Task descriptor whose stack is to be modified.
3403:../MQXLITE/kernel/task.c ****  *
3404:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
3405:../MQXLITE/kernel/task.c ****  */
3406:../MQXLITE/kernel/task.c **** void _task_sync_priority_internal
3407:../MQXLITE/kernel/task.c **** (
3408:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr
3409:../MQXLITE/kernel/task.c **** )
3410:../MQXLITE/kernel/task.c **** { /* Body */
 3865              		.loc 1 3410 0
 3866              		.cfi_startproc
 3867 0000 80B5     		push	{r7, lr}
 3868              	.LCFI115:
 3869              		.cfi_def_cfa_offset 8
 3870              		.cfi_offset 7, -8
 3871              		.cfi_offset 14, -4
 3872 0002 84B0     		sub	sp, sp, #16
 3873              	.LCFI116:
 3874              		.cfi_def_cfa_offset 24
 3875 0004 00AF     		add	r7, sp, #0
 3876              	.LCFI117:
 3877              		.cfi_def_cfa_register 7
 3878 0006 7860     		str	r0, [r7, #4]
3411:../MQXLITE/kernel/task.c ****     pointer stack_ptr = td_ptr->STACK_PTR;
 3879              		.loc 1 3411 0
 3880 0008 7B68     		ldr	r3, [r7, #4]
 3881 000a 5B69     		ldr	r3, [r3, #20]
 3882 000c FB60     		str	r3, [r7, #12]
3412:../MQXLITE/kernel/task.c **** 
3413:../MQXLITE/kernel/task.c ****     _PSP_SET_SR_OF_BLOCKED_TASK(stack_ptr, td_ptr->MY_QUEUE->ENABLE_SR);
3414:../MQXLITE/kernel/task.c **** 
3415:../MQXLITE/kernel/task.c **** } /* Endbody */
 3883              		.loc 1 3415 0
 3884 000e BD46     		mov	sp, r7
 3885 0010 04B0     		add	sp, sp, #16
 3886              		@ sp needed for prologue
 3887 0012 80BD     		pop	{r7, pc}
 3888              		.cfi_endproc
 3889              	.LFE40:
 3891              		.section	.text._task_alloc_td_internal,"ax",%progbits
 3892              		.align	2
 3893              		.global	_task_alloc_td_internal
 3894              		.code	16
 3895              		.thumb_func
 3897              	_task_alloc_td_internal:
 3898              	.LFB41:
3416:../MQXLITE/kernel/task.c **** 
3417:../MQXLITE/kernel/task.c **** /* Start SPR P171-0016-01 */
3418:../MQXLITE/kernel/task.c **** 
3419:../MQXLITE/kernel/task.c **** /*!
3420:../MQXLITE/kernel/task.c ****  * \private
3421:../MQXLITE/kernel/task.c ****  *
3422:../MQXLITE/kernel/task.c ****  * \brief Gets a pointer to an initialized task descriptor.
3423:../MQXLITE/kernel/task.c ****  *
3424:../MQXLITE/kernel/task.c ****  * Note that the task descriptor is initialized to zero.
3425:../MQXLITE/kernel/task.c ****  *
3426:../MQXLITE/kernel/task.c ****  * \param[in]  stack_size      Size of the stack for the newly created task.
3427:../MQXLITE/kernel/task.c ****  * \param[out] overhead        Size of TD_STRUCT and other overhead.
3428:../MQXLITE/kernel/task.c ****  * \param[in]  input_stack_ptr If not NULL, the location of the stack is provided.
3429:../MQXLITE/kernel/task.c ****  * \param[in]  user            User mode functionality.
3430:../MQXLITE/kernel/task.c ****  *
3431:../MQXLITE/kernel/task.c ****  * \return Pointer to an initialized task descriptor.
3432:../MQXLITE/kernel/task.c ****  * \return NULL
3433:../MQXLITE/kernel/task.c ****  * \return 0 (Not enough resources to create a task.)
3434:../MQXLITE/kernel/task.c ****  *
3435:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
3436:../MQXLITE/kernel/task.c ****  */
3437:../MQXLITE/kernel/task.c **** 
3438:../MQXLITE/kernel/task.c **** TD_STRUCT_PTR _task_alloc_td_internal
3439:../MQXLITE/kernel/task.c **** (
3440:../MQXLITE/kernel/task.c ****     _mem_size     stack_size,
3441:../MQXLITE/kernel/task.c ****     _mem_size_ptr overhead,
3442:../MQXLITE/kernel/task.c ****     pointer    input_stack_ptr,
3443:../MQXLITE/kernel/task.c ****     _mqx_uint user
3444:../MQXLITE/kernel/task.c **** )
3445:../MQXLITE/kernel/task.c **** { /* Body */
 3899              		.loc 1 3445 0
 3900              		.cfi_startproc
 3901 0000 80B5     		push	{r7, lr}
 3902              	.LCFI118:
 3903              		.cfi_def_cfa_offset 8
 3904              		.cfi_offset 7, -8
 3905              		.cfi_offset 14, -4
 3906 0002 8EB0     		sub	sp, sp, #56
 3907              	.LCFI119:
 3908              		.cfi_def_cfa_offset 64
 3909 0004 00AF     		add	r7, sp, #0
 3910              	.LCFI120:
 3911              		.cfi_def_cfa_register 7
 3912 0006 F860     		str	r0, [r7, #12]
 3913 0008 B960     		str	r1, [r7, #8]
 3914 000a 7A60     		str	r2, [r7, #4]
 3915 000c 3B60     		str	r3, [r7]
3446:../MQXLITE/kernel/task.c ****     KERNEL_DATA_STRUCT_PTR      kernel_data;
3447:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               insert_td_ptr;
3448:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               next_td_ptr;
3449:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               new_td_ptr;
3450:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR               prev_td_ptr;
3451:../MQXLITE/kernel/task.c ****     QUEUE_ELEMENT_STRUCT_PTR    q_ptr;
3452:../MQXLITE/kernel/task.c ****     _mem_size                   extra = sizeof(TD_STRUCT);
 3916              		.loc 1 3452 0
 3917 000e 7023     		mov	r3, #112
 3918 0010 7B62     		str	r3, [r7, #36]
3453:../MQXLITE/kernel/task.c **** #if MQX_EXTRA_TASK_STACK_ENABLE
3454:../MQXLITE/kernel/task.c ****     _mem_size                tos, tos_offset = 0;
3455:../MQXLITE/kernel/task.c **** #endif
3456:../MQXLITE/kernel/task.c ****     uint_16                  task_num;
3457:../MQXLITE/kernel/task.c **** 
3458:../MQXLITE/kernel/task.c ****     _GET_KERNEL_DATA(kernel_data);
 3919              		.loc 1 3458 0
 3920 0012 454B     		ldr	r3, .L243
 3921 0014 1B68     		ldr	r3, [r3]
 3922 0016 3B62     		str	r3, [r7, #32]
3459:../MQXLITE/kernel/task.c **** 
3460:../MQXLITE/kernel/task.c **** #if MQX_CHECK_ERRORS
3461:../MQXLITE/kernel/task.c ****     if (_QUEUE_GET_SIZE(&kernel_data->TD_LIST) >= (MAX_UINT_16-1))
 3923              		.loc 1 3461 0
 3924 0018 3B6A     		ldr	r3, [r7, #32]
 3925 001a C833     		add	r3, r3, #200
 3926 001c 1A89     		ldrh	r2, [r3, #8]
 3927 001e 434B     		ldr	r3, .L243+4
 3928 0020 9A42     		cmp	r2, r3
 3929 0022 01D9     		bls	.L235
3462:../MQXLITE/kernel/task.c ****     {
3463:../MQXLITE/kernel/task.c ****         /* We already have maximum number of tasks in system */
3464:../MQXLITE/kernel/task.c ****         return NULL;
 3930              		.loc 1 3464 0
 3931 0024 0023     		mov	r3, #0
 3932 0026 7AE0     		b	.L236
 3933              	.L235:
3465:../MQXLITE/kernel/task.c ****     } /* Endif */
3466:../MQXLITE/kernel/task.c **** #endif
3467:../MQXLITE/kernel/task.c **** 
3468:../MQXLITE/kernel/task.c **** #if MQX_EXTRA_TASK_STACK_ENABLE
3469:../MQXLITE/kernel/task.c ****     tos = kernel_data->TOS_RESERVED_SIZE;
3470:../MQXLITE/kernel/task.c ****     if (tos != 0)
3471:../MQXLITE/kernel/task.c ****     {
3472:../MQXLITE/kernel/task.c ****         uint_32 align_mask = kernel_data->TOS_RESERVED_ALIGN_MASK;
3473:../MQXLITE/kernel/task.c ****         extra = (extra + align_mask) & ~align_mask;
3474:../MQXLITE/kernel/task.c ****         tos_offset = extra;
3475:../MQXLITE/kernel/task.c ****         /* must be word multiple */
3476:../MQXLITE/kernel/task.c ****         extra = (extra + tos + 3) & ~3;
3477:../MQXLITE/kernel/task.c ****     } /* Endif */
3478:../MQXLITE/kernel/task.c **** #endif
3479:../MQXLITE/kernel/task.c ****     *overhead = extra;
 3934              		.loc 1 3479 0
 3935 0028 BB68     		ldr	r3, [r7, #8]
 3936 002a 7A6A     		ldr	r2, [r7, #36]
 3937 002c 1A60     		str	r2, [r3]
3480:../MQXLITE/kernel/task.c **** 
3481:../MQXLITE/kernel/task.c **** 
3482:../MQXLITE/kernel/task.c ****     if (input_stack_ptr)
 3938              		.loc 1 3482 0
 3939 002e 7B68     		ldr	r3, [r7, #4]
 3940 0030 002B     		cmp	r3, #0
 3941 0032 07D0     		beq	.L237
3483:../MQXLITE/kernel/task.c ****     {
3484:../MQXLITE/kernel/task.c ****         new_td_ptr = (TD_STRUCT_PTR)input_stack_ptr;
 3942              		.loc 1 3484 0
 3943 0034 7B68     		ldr	r3, [r7, #4]
 3944 0036 7B63     		str	r3, [r7, #52]
3485:../MQXLITE/kernel/task.c ****         _mem_zero((pointer)new_td_ptr, extra);
 3945              		.loc 1 3485 0
 3946 0038 7A6B     		ldr	r2, [r7, #52]
 3947 003a 7B6A     		ldr	r3, [r7, #36]
 3948 003c 101C     		mov	r0, r2
 3949 003e 191C     		mov	r1, r3
 3950 0040 FFF7FEFF 		bl	_mem_zero
 3951              	.L237:
3486:../MQXLITE/kernel/task.c ****     }
3487:../MQXLITE/kernel/task.c **** #if !MQX_LITE_VERSION_NUMBER
3488:../MQXLITE/kernel/task.c ****     else
3489:../MQXLITE/kernel/task.c ****     {
3490:../MQXLITE/kernel/task.c ****         new_td_ptr = (TD_STRUCT_PTR)_mem_alloc_zero(extra);
3491:../MQXLITE/kernel/task.c **** 
3492:../MQXLITE/kernel/task.c ****         if (new_td_ptr)
3493:../MQXLITE/kernel/task.c ****         {
3494:../MQXLITE/kernel/task.c **** #if MQX_ENABLE_USER_MODE
3495:../MQXLITE/kernel/task.c ****             if (user)
3496:../MQXLITE/kernel/task.c ****             {
3497:../MQXLITE/kernel/task.c ****                 new_td_ptr->STACK_ALLOC_BLOCK = (TD_STRUCT_PTR)_mem_alloc_from(kernel_data->KD_USER
3498:../MQXLITE/kernel/task.c ****             }
3499:../MQXLITE/kernel/task.c ****             else
3500:../MQXLITE/kernel/task.c ****             {
3501:../MQXLITE/kernel/task.c ****                 new_td_ptr->STACK_ALLOC_BLOCK = (TD_STRUCT_PTR)_mem_alloc(stack_size);
3502:../MQXLITE/kernel/task.c ****             }
3503:../MQXLITE/kernel/task.c **** #else
3504:../MQXLITE/kernel/task.c ****             new_td_ptr->STACK_ALLOC_BLOCK = (TD_STRUCT_PTR)_mem_alloc(stack_size);
3505:../MQXLITE/kernel/task.c **** #endif /* MQX_ENABLE_USER_MODE */
3506:../MQXLITE/kernel/task.c ****         }
3507:../MQXLITE/kernel/task.c **** 
3508:../MQXLITE/kernel/task.c **** #if MQX_CHECK_MEMORY_ALLOCATION_ERRORS
3509:../MQXLITE/kernel/task.c ****         if ( new_td_ptr == NULL )
3510:../MQXLITE/kernel/task.c ****         {
3511:../MQXLITE/kernel/task.c ****             return ((TD_STRUCT_PTR)new_td_ptr);
3512:../MQXLITE/kernel/task.c ****         } /* Endif */
3513:../MQXLITE/kernel/task.c **** 
3514:../MQXLITE/kernel/task.c ****         if (new_td_ptr->STACK_ALLOC_BLOCK == NULL )
3515:../MQXLITE/kernel/task.c ****         {
3516:../MQXLITE/kernel/task.c ****             /* dealloc TD, because we do not have enough resources to create task */
3517:../MQXLITE/kernel/task.c ****             _mem_free(new_td_ptr);
3518:../MQXLITE/kernel/task.c ****             return 0;
3519:../MQXLITE/kernel/task.c ****         }
3520:../MQXLITE/kernel/task.c **** 
3521:../MQXLITE/kernel/task.c ****         _mem_set_type(new_td_ptr, MEM_TYPE_TD);
3522:../MQXLITE/kernel/task.c ****         _mem_set_type(new_td_ptr->STACK_ALLOC_BLOCK, MEM_TYPE_TASK_STACK);
3523:../MQXLITE/kernel/task.c **** #endif
3524:../MQXLITE/kernel/task.c ****     } /* Endif */
3525:../MQXLITE/kernel/task.c **** #endif /* MQX_LITE_VERSION_NUMBER */
3526:../MQXLITE/kernel/task.c **** 
3527:../MQXLITE/kernel/task.c **** 
3528:../MQXLITE/kernel/task.c **** #if MQX_EXTRA_TASK_STACK_ENABLE
3529:../MQXLITE/kernel/task.c ****     if (tos != 0)
3530:../MQXLITE/kernel/task.c ****     {
3531:../MQXLITE/kernel/task.c ****         new_td_ptr->TOS_RESERVED = ((uchar_ptr) new_td_ptr) + tos_offset;
3532:../MQXLITE/kernel/task.c ****     } /* Endif */
3533:../MQXLITE/kernel/task.c **** #endif
3534:../MQXLITE/kernel/task.c **** 
3535:../MQXLITE/kernel/task.c ****     /* Add new task to list */
3536:../MQXLITE/kernel/task.c ****     task_num = kernel_data->TASK_NUMBER;
 3952              		.loc 1 3536 0
 3953 0044 3A6A     		ldr	r2, [r7, #32]
 3954 0046 D423     		mov	r3, #212
 3955 0048 D258     		ldr	r2, [r2, r3]
 3956 004a 3B1C     		mov	r3, r7
 3957 004c 2A33     		add	r3, r3, #42
 3958 004e 1A80     		strh	r2, [r3]
3537:../MQXLITE/kernel/task.c ****     insert_td_ptr = kernel_data->INSERT_TD_PTR;
 3959              		.loc 1 3537 0
 3960 0050 3A6A     		ldr	r2, [r7, #32]
 3961 0052 D823     		mov	r3, #216
 3962 0054 D358     		ldr	r3, [r2, r3]
 3963 0056 FB61     		str	r3, [r7, #28]
3538:../MQXLITE/kernel/task.c ****     new_td_ptr->TASK_ID = BUILD_TASKID(kernel_data->INIT.PROCESSOR_NUMBER, task_num);
 3964              		.loc 1 3538 0
 3965 0058 3A6A     		ldr	r2, [r7, #32]
 3966 005a A823     		mov	r3, #168
 3967 005c 5B00     		lsl	r3, r3, #1
 3968 005e D358     		ldr	r3, [r2, r3]
 3969 0060 1A04     		lsl	r2, r3, #16
 3970 0062 3B1C     		mov	r3, r7
 3971 0064 2A33     		add	r3, r3, #42
 3972 0066 1B88     		ldrh	r3, [r3]
 3973 0068 1A43     		orr	r2, r3
 3974 006a 7B6B     		ldr	r3, [r7, #52]
 3975 006c DA60     		str	r2, [r3, #12]
3539:../MQXLITE/kernel/task.c **** 
3540:../MQXLITE/kernel/task.c ****     if (!insert_td_ptr)
 3976              		.loc 1 3540 0
 3977 006e FB69     		ldr	r3, [r7, #28]
 3978 0070 002B     		cmp	r3, #0
 3979 0072 03D1     		bne	.L238
3541:../MQXLITE/kernel/task.c ****     {
3542:../MQXLITE/kernel/task.c ****         q_ptr = (QUEUE_ELEMENT_STRUCT_PTR)((pointer)&kernel_data->TD_LIST);
 3980              		.loc 1 3542 0
 3981 0074 3B6A     		ldr	r3, [r7, #32]
 3982 0076 C833     		add	r3, r3, #200
 3983 0078 FB62     		str	r3, [r7, #44]
 3984 007a 02E0     		b	.L239
 3985              	.L238:
3543:../MQXLITE/kernel/task.c ****     }
3544:../MQXLITE/kernel/task.c ****     else
3545:../MQXLITE/kernel/task.c ****     {
3546:../MQXLITE/kernel/task.c ****         q_ptr = &insert_td_ptr->TD_LIST_INFO;
 3986              		.loc 1 3546 0
 3987 007c FB69     		ldr	r3, [r7, #28]
 3988 007e 5C33     		add	r3, r3, #92
 3989 0080 FB62     		str	r3, [r7, #44]
 3990              	.L239:
 3991              	.LBB19:
3547:../MQXLITE/kernel/task.c ****     } /* Endif */
3548:../MQXLITE/kernel/task.c **** 
3549:../MQXLITE/kernel/task.c ****     _QUEUE_INSERT(&kernel_data->TD_LIST, q_ptr, &new_td_ptr->TD_LIST_INFO);
 3992              		.loc 1 3549 0
 3993 0082 FB6A     		ldr	r3, [r7, #44]
 3994 0084 1B68     		ldr	r3, [r3]
 3995 0086 BB61     		str	r3, [r7, #24]
 3996 0088 7B6B     		ldr	r3, [r7, #52]
 3997 008a 5C33     		add	r3, r3, #92
 3998 008c BA69     		ldr	r2, [r7, #24]
 3999 008e 1A60     		str	r2, [r3]
 4000 0090 7B6B     		ldr	r3, [r7, #52]
 4001 0092 1A1C     		mov	r2, r3
 4002 0094 5C32     		add	r2, r2, #92
 4003 0096 FB6A     		ldr	r3, [r7, #44]
 4004 0098 1A60     		str	r2, [r3]
 4005 009a 7B6B     		ldr	r3, [r7, #52]
 4006 009c 5C33     		add	r3, r3, #92
 4007 009e FA6A     		ldr	r2, [r7, #44]
 4008 00a0 5A60     		str	r2, [r3, #4]
 4009 00a2 7B6B     		ldr	r3, [r7, #52]
 4010 00a4 1A1C     		mov	r2, r3
 4011 00a6 5C32     		add	r2, r2, #92
 4012 00a8 BB69     		ldr	r3, [r7, #24]
 4013 00aa 5A60     		str	r2, [r3, #4]
 4014              	.LBE19:
 4015 00ac 3B6A     		ldr	r3, [r7, #32]
 4016 00ae C833     		add	r3, r3, #200
 4017 00b0 1A89     		ldrh	r2, [r3, #8]
 4018 00b2 0132     		add	r2, r2, #1
 4019 00b4 92B2     		uxth	r2, r2
 4020 00b6 1A81     		strh	r2, [r3, #8]
3550:../MQXLITE/kernel/task.c **** 
3551:../MQXLITE/kernel/task.c ****     /*
3552:../MQXLITE/kernel/task.c ****      * New task may not have been inserted at the end of the list. Search for a
3553:../MQXLITE/kernel/task.c ****      * spot to insert the next td and also calculate its task number
3554:../MQXLITE/kernel/task.c ****      */
3555:../MQXLITE/kernel/task.c ****     prev_td_ptr = new_td_ptr;
 4021              		.loc 1 3555 0
 4022 00b8 7B6B     		ldr	r3, [r7, #52]
 4023 00ba 3B63     		str	r3, [r7, #48]
 4024              	.L242:
3556:../MQXLITE/kernel/task.c ****     do
3557:../MQXLITE/kernel/task.c ****     {
3558:../MQXLITE/kernel/task.c ****         insert_td_ptr = prev_td_ptr;
 4025              		.loc 1 3558 0
 4026 00bc 3B6B     		ldr	r3, [r7, #48]
 4027 00be FB61     		str	r3, [r7, #28]
3559:../MQXLITE/kernel/task.c ****         next_td_ptr   = (TD_STRUCT_PTR)((uchar_ptr)insert_td_ptr->TD_LIST_INFO.NEXT - FIELD_OFFSET(
 4028              		.loc 1 3559 0
 4029 00c0 FB69     		ldr	r3, [r7, #28]
 4030 00c2 DB6D     		ldr	r3, [r3, #92]
 4031 00c4 5C3B     		sub	r3, r3, #92
 4032 00c6 7B61     		str	r3, [r7, #20]
3560:../MQXLITE/kernel/task.c ****         prev_td_ptr   = next_td_ptr;
 4033              		.loc 1 3560 0
 4034 00c8 7B69     		ldr	r3, [r7, #20]
 4035 00ca 3B63     		str	r3, [r7, #48]
3561:../MQXLITE/kernel/task.c ****         INC_TASK_NUMBER(task_num);
 4036              		.loc 1 3561 0
 4037 00cc 3B1C     		mov	r3, r7
 4038 00ce 2A33     		add	r3, r3, #42
 4039 00d0 3A1C     		mov	r2, r7
 4040 00d2 2A32     		add	r2, r2, #42
 4041 00d4 1288     		ldrh	r2, [r2]
 4042 00d6 0132     		add	r2, r2, #1
 4043 00d8 1A80     		strh	r2, [r3]
 4044 00da 3B1C     		mov	r3, r7
 4045 00dc 2A33     		add	r3, r3, #42
 4046 00de 1B88     		ldrh	r3, [r3]
 4047 00e0 002B     		cmp	r3, #0
 4048 00e2 03D1     		bne	.L240
 4049              		.loc 1 3561 0 is_stmt 0 discriminator 1
 4050 00e4 3B1C     		mov	r3, r7
 4051 00e6 2A33     		add	r3, r3, #42
 4052 00e8 0122     		mov	r2, #1
 4053 00ea 1A80     		strh	r2, [r3]
 4054              	.L240:
3562:../MQXLITE/kernel/task.c ****     } while( ((pointer)next_td_ptr != ((pointer)&kernel_data->TD_LIST)) &&
 4055              		.loc 1 3562 0 is_stmt 1
 4056 00ec 3B6A     		ldr	r3, [r7, #32]
 4057 00ee 1A1C     		mov	r2, r3
 4058 00f0 C832     		add	r2, r2, #200
3563:../MQXLITE/kernel/task.c ****                     (TASK_NUMBER_FROM_TASKID(next_td_ptr->TASK_ID) == task_num) );
 4059              		.loc 1 3563 0
 4060 00f2 7B69     		ldr	r3, [r7, #20]
 4061 00f4 9A42     		cmp	r2, r3
 4062 00f6 07D0     		beq	.L241
 4063              		.loc 1 3563 0 is_stmt 0 discriminator 1
 4064 00f8 7B69     		ldr	r3, [r7, #20]
 4065 00fa DB68     		ldr	r3, [r3, #12]
 4066 00fc 9BB2     		uxth	r3, r3
3562:../MQXLITE/kernel/task.c ****     } while( ((pointer)next_td_ptr != ((pointer)&kernel_data->TD_LIST)) &&
 4067              		.loc 1 3562 0 is_stmt 1 discriminator 1
 4068 00fe 3A1C     		mov	r2, r7
 4069 0100 2A32     		add	r2, r2, #42
 4070 0102 1288     		ldrh	r2, [r2]
 4071 0104 9A42     		cmp	r2, r3
 4072 0106 D9D0     		beq	.L242
 4073              	.L241:
3564:../MQXLITE/kernel/task.c **** 
3565:../MQXLITE/kernel/task.c ****     kernel_data->INSERT_TD_PTR = insert_td_ptr;
 4074              		.loc 1 3565 0
 4075 0108 3A6A     		ldr	r2, [r7, #32]
 4076 010a D823     		mov	r3, #216
 4077 010c F969     		ldr	r1, [r7, #28]
 4078 010e D150     		str	r1, [r2, r3]
3566:../MQXLITE/kernel/task.c ****     kernel_data->TASK_NUMBER   = task_num;
 4079              		.loc 1 3566 0
 4080 0110 3B1C     		mov	r3, r7
 4081 0112 2A33     		add	r3, r3, #42
 4082 0114 1988     		ldrh	r1, [r3]
 4083 0116 3A6A     		ldr	r2, [r7, #32]
 4084 0118 D423     		mov	r3, #212
 4085 011a D150     		str	r1, [r2, r3]
3567:../MQXLITE/kernel/task.c **** 
3568:../MQXLITE/kernel/task.c ****     return ((TD_STRUCT_PTR)new_td_ptr);
 4086              		.loc 1 3568 0
 4087 011c 7B6B     		ldr	r3, [r7, #52]
 4088              	.L236:
3569:../MQXLITE/kernel/task.c **** 
3570:../MQXLITE/kernel/task.c **** } /* Endbody */
 4089              		.loc 1 3570 0
 4090 011e 181C     		mov	r0, r3
 4091 0120 BD46     		mov	sp, r7
 4092 0122 0EB0     		add	sp, sp, #56
 4093              		@ sp needed for prologue
 4094 0124 80BD     		pop	{r7, pc}
 4095              	.L244:
 4096 0126 C046     		.align	2
 4097              	.L243:
 4098 0128 00000000 		.word	_mqx_kernel_data
 4099 012c FDFF0000 		.word	65533
 4100              		.cfi_endproc
 4101              	.LFE41:
 4103              		.section	.text._task_set_error_td_internal,"ax",%progbits
 4104              		.align	2
 4105              		.global	_task_set_error_td_internal
 4106              		.code	16
 4107              		.thumb_func
 4109              	_task_set_error_td_internal:
 4110              	.LFB42:
3571:../MQXLITE/kernel/task.c **** 
3572:../MQXLITE/kernel/task.c **** /* End SPR P171-0016-01 */
3573:../MQXLITE/kernel/task.c **** 
3574:../MQXLITE/kernel/task.c **** /*!
3575:../MQXLITE/kernel/task.c ****  * \private
3576:../MQXLITE/kernel/task.c ****  *
3577:../MQXLITE/kernel/task.c ****  * \brief Sets the task error code of the specified task.
3578:../MQXLITE/kernel/task.c ****  *
3579:../MQXLITE/kernel/task.c ****  * If the task error code does not equal MQX_OK, then the value is not changed.
3580:../MQXLITE/kernel/task.c ****  * However, the value of the task error code may be reset to MQX_OK by setting the
3581:../MQXLITE/kernel/task.c ****  * task error code to MQX_OK.  The old value of the task error code is returned.
3582:../MQXLITE/kernel/task.c ****  *
3583:../MQXLITE/kernel/task.c ****  * \param[in] td_ptr         Pointer to the task descriptor whose error is to be set.
3584:../MQXLITE/kernel/task.c ****  * \param[in] new_error_code The new error code.
3585:../MQXLITE/kernel/task.c ****  *
3586:../MQXLITE/kernel/task.c ****  * \return MQX_OK
3587:../MQXLITE/kernel/task.c ****  * \return Old task error code.
3588:../MQXLITE/kernel/task.c ****  *
3589:../MQXLITE/kernel/task.c ****  * \see TD_STRUCT
3590:../MQXLITE/kernel/task.c ****  */
3591:../MQXLITE/kernel/task.c **** _mqx_uint _task_set_error_td_internal
3592:../MQXLITE/kernel/task.c **** (
3593:../MQXLITE/kernel/task.c ****     TD_STRUCT_PTR td_ptr,
3594:../MQXLITE/kernel/task.c ****     _mqx_uint new_error_code
3595:../MQXLITE/kernel/task.c **** )
3596:../MQXLITE/kernel/task.c **** { /* Body */
 4111              		.loc 1 3596 0
 4112              		.cfi_startproc
 4113 0000 80B5     		push	{r7, lr}
 4114              	.LCFI121:
 4115              		.cfi_def_cfa_offset 8
 4116              		.cfi_offset 7, -8
 4117              		.cfi_offset 14, -4
 4118 0002 84B0     		sub	sp, sp, #16
 4119              	.LCFI122:
 4120              		.cfi_def_cfa_offset 24
 4121 0004 00AF     		add	r7, sp, #0
 4122              	.LCFI123:
 4123              		.cfi_def_cfa_register 7
 4124 0006 7860     		str	r0, [r7, #4]
 4125 0008 3960     		str	r1, [r7]
3597:../MQXLITE/kernel/task.c **** #if MQX_TD_HAS_ERROR_CODE
3598:../MQXLITE/kernel/task.c ****     _KLOGM(KERNEL_DATA_STRUCT_PTR  kernel_data;)
3599:../MQXLITE/kernel/task.c ****     _mqx_uint                      old_error_code;
3600:../MQXLITE/kernel/task.c **** 
3601:../MQXLITE/kernel/task.c ****     _KLOGM(_GET_KERNEL_DATA(kernel_data);)
3602:../MQXLITE/kernel/task.c **** 
3603:../MQXLITE/kernel/task.c ****     _KLOGE2(KLOG_task_set_error, new_error_code);
3604:../MQXLITE/kernel/task.c **** 
3605:../MQXLITE/kernel/task.c ****     /* get the old value */
3606:../MQXLITE/kernel/task.c ****     old_error_code = td_ptr->TASK_ERROR_CODE;
 4126              		.loc 1 3606 0
 4127 000a 7B68     		ldr	r3, [r7, #4]
 4128 000c DB6C     		ldr	r3, [r3, #76]
 4129 000e FB60     		str	r3, [r7, #12]
3607:../MQXLITE/kernel/task.c ****     if (( new_error_code == MQX_OK ) || ( old_error_code == MQX_OK ))
 4130              		.loc 1 3607 0
 4131 0010 3B68     		ldr	r3, [r7]
 4132 0012 002B     		cmp	r3, #0
 4133 0014 02D0     		beq	.L246
 4134              		.loc 1 3607 0 is_stmt 0 discriminator 1
 4135 0016 FB68     		ldr	r3, [r7, #12]
 4136 0018 002B     		cmp	r3, #0
 4137 001a 02D1     		bne	.L247
 4138              	.L246:
3608:../MQXLITE/kernel/task.c ****     {
3609:../MQXLITE/kernel/task.c ****         td_ptr->TASK_ERROR_CODE = new_error_code;
 4139              		.loc 1 3609 0 is_stmt 1
 4140 001c 7B68     		ldr	r3, [r7, #4]
 4141 001e 3A68     		ldr	r2, [r7]
 4142 0020 DA64     		str	r2, [r3, #76]
 4143              	.L247:
3610:../MQXLITE/kernel/task.c ****     } /* Endif */
3611:../MQXLITE/kernel/task.c **** 
3612:../MQXLITE/kernel/task.c ****     _KLOGX2(KLOG_task_set_error, old_error_code);
3613:../MQXLITE/kernel/task.c ****     return( old_error_code );
 4144              		.loc 1 3613 0
 4145 0022 FB68     		ldr	r3, [r7, #12]
3614:../MQXLITE/kernel/task.c **** #else
3615:../MQXLITE/kernel/task.c ****     return MQX_OK;
3616:../MQXLITE/kernel/task.c **** #endif
3617:../MQXLITE/kernel/task.c **** 
3618:../MQXLITE/kernel/task.c **** } /* Endbody */
 4146              		.loc 1 3618 0
 4147 0024 181C     		mov	r0, r3
 4148 0026 BD46     		mov	sp, r7
 4149 0028 04B0     		add	sp, sp, #16
 4150              		@ sp needed for prologue
 4151 002a 80BD     		pop	{r7, pc}
 4152              		.cfi_endproc
 4153              	.LFE42:
 4155              		.text
 4156              	.Letext0:
 4157              		.file 2 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/psp/cortex_m/psptypes.
 4158              		.file 3 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/include/mqxlite.h"
 4159              		.file 4 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/include/queue.h"
 4160              		.file 5 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/include/lwsem.h"
 4161              		.file 6 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/psp/cortex_m/cortex.h"
 4162              		.file 7 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/MQXLITE/include/mqxlite_prv.h"
 4163              		.file 8 "C:/Users/LARM/workspace/MQX-Lite + SPI + Motor + Ultrassom/Generated_Code/IO_Map.h"
DEFINED SYMBOLS
                            *ABS*:00000000 task.c
                            *COM*:00000004 _tad_task_at_flag
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:19     .text._task_abort_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:24     .text._task_abort_internal:00000000 _task_abort_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2996   .text._task_get_td:00000000 _task_get_td
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3393   .text._task_exit_function_internal:00000000 _task_exit_function_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2016   .text._task_ready:00000000 _task_ready
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:270    .text._task_abort_internal:0000017c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:278    .text._task_abort:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:283    .text._task_abort:00000000 _task_abort
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:315    .text._task_create_at:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:320    .text._task_create_at:00000000 _task_create_at
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3151   .text._task_set_error:00000000 _task_set_error
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3229   .text._task_build_internal:00000000 _task_build_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3792   .text._task_ready_internal:00000000 _task_ready_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:470    .text._task_create_at:000000c4 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:476    .text._task_destroy_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:481    .text._task_destroy_internal:00000000 _task_destroy_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:882    .text._task_destroy_internal:00000278 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:888    .text._task_destroy:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:893    .text._task_destroy:00000000 _task_destroy
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:925    .text._task_get_exception_handler:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:930    .text._task_get_exception_handler:00000000 _task_get_exception_handler
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:980    .text._task_set_exception_handler:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:985    .text._task_set_exception_handler:00000000 _task_set_exception_handler
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1040   .text._task_get_exit_handler:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1045   .text._task_get_exit_handler:00000000 _task_get_exit_handler
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1095   .text._task_set_exit_handler:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1100   .text._task_set_exit_handler:00000000 _task_set_exit_handler
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1155   .text._task_get_id_from_name:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1160   .text._task_get_id_from_name:00000000 _task_get_id_from_name
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1256   .text._task_get_id_from_name:00000080 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1261   .text._task_get_template_ptr:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1266   .text._task_get_template_ptr:00000000 _task_get_template_ptr
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1310   .text._task_get_template_index:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1315   .text._task_get_template_index:00000000 _task_get_template_index
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1397   .text._task_get_template_index:00000068 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1402   .text._task_get_id_from_td:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1407   .text._task_get_id_from_td:00000000 _task_get_id_from_td
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1445   .text._task_get_index_from_id:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1450   .text._task_get_index_from_id:00000000 _task_get_index_from_id
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1495   .text._task_get_parameter:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1500   .text._task_get_parameter:00000000 _task_get_parameter
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1586   .text._task_get_parameter_internal:00000000 _task_get_parameter_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1534   .text._task_get_parameter:00000020 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1539   .text._task_get_parameter_for:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1544   .text._task_get_parameter_for:00000000 _task_get_parameter_for
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1581   .text._task_get_parameter_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1621   .text._task_set_parameter:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1626   .text._task_set_parameter:00000000 _task_set_parameter
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1741   .text._task_set_parameter_internal:00000000 _task_set_parameter_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1666   .text._task_set_parameter:0000002c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1671   .text._task_set_parameter_for:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1676   .text._task_set_parameter_for:00000000 _task_set_parameter_for
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1731   .text._task_set_parameter_for:00000040 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1736   .text._task_set_parameter_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1784   .text._task_get_priority:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1789   .text._task_get_priority:00000000 _task_get_priority
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1840   .text._task_set_priority:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:1845   .text._task_set_priority:00000000 _task_set_priority
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2005   .text._task_set_priority:000000f0 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2011   .text._task_ready:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2136   .text._task_ready:00000094 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2141   .text._task_restart_func:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2145   .text._task_restart_func:00000000 _task_restart_func
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2609   .text._task_restart_func:000002c8 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2615   .text._task_restart:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2620   .text._task_restart:00000000 _task_restart
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2662   .text._task_stop_preemption:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2667   .text._task_stop_preemption:00000000 _task_stop_preemption
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2709   .text._task_stop_preemption:0000002c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2714   .text._task_start_preemption:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2719   .text._task_start_preemption:00000000 _task_start_preemption
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2762   .text._task_start_preemption:0000002c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2768   .text._task_check_stack:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2773   .text._task_check_stack:00000000 _task_check_stack
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2818   .text._task_check_stack:00000028 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2823   .text._task_get_creator:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2828   .text._task_get_creator:00000000 _task_get_creator
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2855   .text._task_get_creator:00000014 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2860   .text._task_get_error:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2865   .text._task_get_error:00000000 _task_get_error
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2902   .text._task_get_error:00000020 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2907   .text._task_get_error_ptr:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2912   .text._task_get_error_ptr:00000000 _task_get_error_ptr
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2949   .text._task_get_error_ptr:00000020 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2954   .text._task_get_id:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2959   .text._task_get_id:00000000 _task_get_id
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2986   .text._task_get_id:00000014 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:2991   .text._task_get_td:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3141   .text._task_get_td:000000b4 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3146   .text._task_set_error:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3219   .text._task_set_error:00000044 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3224   .text._task_build_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3447   .text._task_init_internal:00000000 _task_init_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3358   .text._task_build_internal:000000ac $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3363   .text._task_exiting_function_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3368   .text._task_exiting_function_internal:00000000 _task_exiting_function_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3388   .text._task_exit_function_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3437   .text._task_exit_function_internal:0000002c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3442   .text._task_init_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3897   .text._task_alloc_td_internal:00000000 _task_alloc_td_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3734   .text._task_fill_stack_internal:00000000 _task_fill_stack_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3724   .text._task_init_internal:0000019c $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3729   .text._task_fill_stack_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3782   .text._task_fill_stack_internal:00000034 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3787   .text._task_ready_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3853   .text._task_ready_internal:00000040 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3858   .text._task_sync_priority_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3863   .text._task_sync_priority_internal:00000000 _task_sync_priority_internal
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:3892   .text._task_alloc_td_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:4098   .text._task_alloc_td_internal:00000128 $d
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:4104   .text._task_set_error_td_internal:00000000 $t
C:\Users\LARM\AppData\Local\Temp\ccz1AIvA.s:4109   .text._task_set_error_td_internal:00000000 _task_set_error_td_internal
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
__get_PSP
_int_disable
_int_enable
_mqx_kernel_data
_sched_check_scheduler_internal
_lwsem_wait
_lwsem_post
_psp_destroy_stack_frame
_sched_run_internal
strncmp
_psp_get_stack_start
_sched_set_priority_internal
_sched_insert_priorityq_internal
_psp_build_stack_frame
_sched_execute_scheduler_internal
_mem_zero
